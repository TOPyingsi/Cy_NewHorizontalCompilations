System.register("chunks:///_virtual/50_XGTS",["./XGTS_AccessoriesPanel.ts","./XGTS_ArrowGuide.ts","./XGTS_BackpackInventory.ts","./XGTS_ChestRigInventory.ts","./XGTS_CommonItem.ts","./XGTS_ContainerInventory.ts","./XGTS_ExitPanel.ts","./XGTS_FloatingText.ts","./XGTS_GameItemUI.ts","./XGTS_GameOverPanel.ts","./XGTS_GamePanel.ts","./XGTS_GamePanel_Double.ts","./XGTS_GridCell.ts","./XGTS_HPBar.ts","./XGTS_Inventory.ts","./XGTS_InventoryPanel.ts","./XGTS_InventoryPanel_Double.ts","./XGTS_InventoryPanel_Left.ts","./XGTS_InventoryPanel_Right.ts","./XGTS_Item.ts","./XGTS_ItemInfoPanel.ts","./XGTS_Joystick.ts","./XGTS_Joystick_Double.ts","./XGTS_OutputItem.ts","./XGTS_OutputPanel.ts","./XGTS_PlayerInventory.ts","./XGTS_RewardPanel.ts","./XGTS_SafeBoxInventory.ts","./XGTS_SafeBoxPanel.ts","./XGTS_SelectMapPanel.ts","./XGTS_SelectMode.ts","./XGTS_SelectSafeBoxPanel.ts","./XGTS_SellInventory.ts","./XGTS_SellPanel.ts","./XGTS_ShopPanel.ts","./XGTS_SingleInventory.ts","./XGTS_SkinItem.ts","./XGTS_SkinShopPanel.ts","./XGTS_TutorialPanel.ts","./XGTS_UIManager.ts","./XGTS_UpgradePanel.ts","./XGTS_WeaponContent.ts","./XGTS_WorkbenchPanel.ts","./XGTS_AniFinishRecycle.ts","./XGTS_AudioManager.ts","./XGTS_Bullet.ts","./XGTS_CameraController.ts","./XGTS_CharacterController.ts","./XGTS_CharacterEnemy.ts","./XGTS_CharacterEnemyRocketSoldier.ts","./XGTS_CharacterFengYi.ts","./XGTS_CharacterFengYi_Double.ts","./XGTS_CharacterLS.ts","./XGTS_CharacterSYD.ts","./XGTS_CharacterStickman.ts","./XGTS_Constant.ts","./XGTS_Data.ts","./XGTS_DataManager.ts","./XGTS_Evacuation.ts","./XGTS_Evacuations.ts","./XGTS_GameInit.ts","./XGTS_GameManager.ts","./XGTS_GunFire.ts","./XGTS_InteractItem.ts","./XGTS_InventoryGrid.ts","./XGTS_ItemNameTitle.ts","./XGTS_LootManager.ts","./XGTS_LvManager.ts","./XGTS_Missile.ts","./XGTS_PlayerData.ts","./XGTS_PoolManager.ts","./XGTS_Showcase.ts","./XGTS_Showcases.ts","./XGTS_SortingChildren.ts","./XGTS_Supplies.ts"],(function(){return{setters:[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){}}}));

System.register("chunks:///_virtual/XGTS_AccessoriesPanel.ts",["cc","./NodeUtil.ts","./PanelBase.ts","./XGTS_Data.ts","./XGTS_UIManager.ts","./XGTS_Constant.ts","./BundleManager.ts","./GameManager.ts","./XGTS_GameManager.ts","./XGTS_AudioManager.ts","./ProjectEventManager.ts","./EventManager.ts","./XGTS_GridCell.ts","./Tools.ts","./XGTS_DataManager.ts"],(function(e){var t,a,s,n,o,c,i,r,h,l,d,A,p,y,D,g,_,m,u,I,T;return{setters:[function(e){t=e.cclegacy,a=e.Sprite,s=e.Label,n=e.UITransform,o=e._decorator},function(e){c=e.default},function(e){i=e.PanelBase},function(e){r=e.XGTS_ItemType},function(e){h=e.XGTS_UIManager},function(e){l=e.XGTS_Constant},function(e){d=e.BundleManager},function(e){A=e.GameManager},function(e){p=e.XGTS_GameManager},function(e){y=e.XGTS_AudioManager,D=e.XGTS_Audio},function(e){g=e.ProjectEventManager,_=e.ProjectEvent},function(e){m=e.EventManager},function(e){u=e.GridCellState},function(e){I=e.Tools},function(e){T=e.XGTS_DataManager}],execute:function(){var C;t._RF.push({},"703518y13hMA6UdSaTbfwkB","XGTS_AccessoriesPanel",void 0);const{ccclass:S,property:P}=o;e("default",S("XGTS_AccessoriesPanel")(C=class extends i{constructor(...e){super(...e),this.Panel=null,this.Icon=null,this.Accessor_0=null,this.Accessor_1=null,this.Accessor_2=null,this.InventoryNd=null,this.Desc0Label=null,this.Desc1Label=null,this.Desc2Label=null,this.data=null,this.callback=null,this.targetInventory=null}onLoad(){this.Panel=c.GetNode("Panel",this.node),this.Icon=c.GetComponent("Icon",this.node,a),this.Desc0Label=c.GetComponent("Desc0Label",this.node,s),this.Desc1Label=c.GetComponent("Desc1Label",this.node,s),this.Desc2Label=c.GetComponent("Desc2Label",this.node,s),this.InventoryNd=c.GetNode("InventoryNd",this.node),this.Accessor_0=c.GetComponent("Accessor_0",this.node,n),this.Accessor_1=c.GetComponent("Accessor_1",this.node,n),this.Accessor_2=c.GetComponent("Accessor_2",this.node,n)}Reset(){this.Icon.spriteFrame=null,this.Desc0Label.string=""}Show(e,t){h.Instance.HidePanel(l.Panel.InventoryPanel),this.data=e,super.Show(this.Panel),this.targetInventory&&this.targetInventory.node.destroy();let a=t&&t(this.InventoryNd);this.targetInventory=a,this.Reset(),d.LoadSpriteFrame(A.GameData.DefaultBundle,`Res/Items/${e.ImageId}`).then((e=>{this.Icon.spriteFrame=e,p.SetImagePreferScale(this.Icon,500,200)})),this.RefreshAccessoriesInfo(),g.emit(_.页面转换,A.GameData.gameName)}OnDragStart(e){this.targetInventory.OnDragStart(e)}OnDragging(e,t){this.targetInventory.OnDragging(e,t),this.DragAccessory(e,t)}OnDragEnd(e,t){this.targetInventory.OnDragEnd(e,t),this.EquipAccessory(e,t)}OnButtonClick(e){y.Instance.PlaySFX(D.ButtonClick);let t=0;p.IsDoubleMode&&(t=1);let a=T.PlayerDatas[t];switch(e.target.name){case"CloseButton":h.Instance.HidePanel(l.Panel.AccessoriesPanel);break;case"Accessor_0":this.data.WeaponData.Accessory_0&&(a.AddItemToInventory(I.Clone(this.data.WeaponData.Accessory_0)),this.data.WeaponData.Accessory_0=null,this.RefreshAccessoriesInfo());break;case"Accessor_1":this.data.WeaponData.Accessory_1&&(a.AddItemToInventory(I.Clone(this.data.WeaponData.Accessory_1)),this.data.WeaponData.Accessory_1=null,this.RefreshAccessoriesInfo());break;case"Accessor_2":this.data.WeaponData.Accessory_2&&(a.AddItemToInventory(I.Clone(this.data.WeaponData.Accessory_2)),this.data.WeaponData.Accessory_2=null,this.RefreshAccessoriesInfo())}}DragAccessory(e,t){this.Accessor_0.getBoundingBoxToWorld().contains(t)?this.SetPutTipState(this.Accessor_0.node.getChildByName("PutTip").getComponent(a),e.data.Type==r.Accessory?u.CanPut:u.CanntPut):this.ClearPutTipState(this.Accessor_0.node.getChildByName("PutTip").getComponent(a)),this.Accessor_1.getBoundingBoxToWorld().contains(t)?this.SetPutTipState(this.Accessor_1.node.getChildByName("PutTip").getComponent(a),e.data.Type==r.Accessory?u.CanPut:u.CanntPut):this.ClearPutTipState(this.Accessor_1.node.getChildByName("PutTip").getComponent(a)),this.Accessor_2.getBoundingBoxToWorld().contains(t)?this.SetPutTipState(this.Accessor_2.node.getChildByName("PutTip").getComponent(a),e.data.Type==r.Accessory?u.CanPut:u.CanntPut):this.ClearPutTipState(this.Accessor_2.node.getChildByName("PutTip").getComponent(a))}EquipAccessory(e,t){const s=I.Clone(e.data);let n=T.PlayerDatas[p.itemPlayerNum],o=0;p.IsDoubleMode&&(o=1),this.Accessor_0.getBoundingBoxToWorld().contains(t)&&s.Type==r.Accessory&&(this.data.WeaponData.Accessory_0&&(n.AddItemToInventory(I.Clone(this.data.WeaponData.Accessory_0)),this.data.WeaponData.Accessory_0=null),T.PlayerDatas[o].RemoveItemFromInventory(e.data),this.data.WeaponData.Accessory_0=s),this.ClearPutTipState(this.Accessor_0.node.getChildByName("PutTip").getComponent(a)),this.Accessor_1.getBoundingBoxToWorld().contains(t)&&e.data.Type==r.Accessory&&(this.data.WeaponData.Accessory_1&&n.AddItemToInventory(this.data.WeaponData.Accessory_1),T.PlayerDatas[o].RemoveItemFromInventory(e.data),this.data.WeaponData.Accessory_1=s),this.ClearPutTipState(this.Accessor_1.node.getChildByName("PutTip").getComponent(a)),this.Accessor_2.getBoundingBoxToWorld().contains(t)&&e.data.Type==r.Accessory&&(this.data.WeaponData.Accessory_2&&n.AddItemToInventory(this.data.WeaponData.Accessory_2),T.PlayerDatas[o].RemoveItemFromInventory(e.data),this.data.WeaponData.Accessory_2=s),this.ClearPutTipState(this.Accessor_2.node.getChildByName("PutTip").getComponent(a)),this.RefreshAccessoriesInfo()}RefreshAccessoriesInfo(){if(!this.data)return;let e=this.Accessor_0.node.getChildByName("ItemLabel").getComponent(s),t=this.Accessor_0.node.getChildByName("Icon").getComponent(a);e.string="芯片配件",t.spriteFrame=null,this.Desc0Label.string="",this.data.WeaponData.Accessory_0&&(e.string=this.data.WeaponData.Accessory_0.Name,this.Desc0Label.string=`${this.data.WeaponData.Accessory_0.Name}\n\n增加后坐力：${this.data.WeaponData.Accessory_0.AccessoryData.RecoilUp}\n减少后坐力：${this.data.WeaponData.Accessory_0.AccessoryData.RecoilDown}\n增加换弹速度：${this.data.WeaponData.Accessory_0.AccessoryData.ReloadingSpeedUp}\n减少换弹速度：${this.data.WeaponData.Accessory_0.AccessoryData.ReloadingSpeedDown}\n视野倍数：${this.data.WeaponData.Accessory_0.AccessoryData.Magnificationlens}`,d.LoadSpriteFrame(A.GameData.DefaultBundle,`Res/Items/${this.data.WeaponData.Accessory_0.ImageId}`).then((e=>{t.spriteFrame=e,p.SetImagePreferScale(t,130,130)})));let n=this.Accessor_1.node.getChildByName("ItemLabel").getComponent(s),o=this.Accessor_1.node.getChildByName("Icon").getComponent(a);n.string="芯片配件",o.spriteFrame=null,this.Desc1Label.string="",this.data.WeaponData.Accessory_1&&(n.string=this.data.WeaponData.Accessory_1.Name,this.Desc1Label.string=`${this.data.WeaponData.Accessory_1.Name}\n\n增加后坐力：${this.data.WeaponData.Accessory_1.AccessoryData.RecoilUp}\n减少后坐力：${this.data.WeaponData.Accessory_1.AccessoryData.RecoilDown}\n增加换弹速度：${this.data.WeaponData.Accessory_1.AccessoryData.ReloadingSpeedUp}\n减少换弹速度：${this.data.WeaponData.Accessory_1.AccessoryData.ReloadingSpeedDown}\n视野倍数：${this.data.WeaponData.Accessory_1.AccessoryData.Magnificationlens}`,d.LoadSpriteFrame(A.GameData.DefaultBundle,`Res/Items/${this.data.WeaponData.Accessory_1.ImageId}`).then((e=>{o.spriteFrame=e,p.SetImagePreferScale(o,130,130)})));let c=this.Accessor_2.node.getChildByName("ItemLabel").getComponent(s),i=this.Accessor_2.node.getChildByName("Icon").getComponent(a);c.string="芯片配件",i.spriteFrame=null,this.Desc2Label.string="",this.data.WeaponData.Accessory_2&&(c.string=this.data.WeaponData.Accessory_2.Name,this.Desc2Label.string=`${this.data.WeaponData.Accessory_2.Name}\n\n增加后坐力：${this.data.WeaponData.Accessory_2.AccessoryData.RecoilUp}\n减少后坐力：${this.data.WeaponData.Accessory_2.AccessoryData.RecoilDown}\n增加换弹速度：${this.data.WeaponData.Accessory_2.AccessoryData.ReloadingSpeedUp}\n减少换弹速度：${this.data.WeaponData.Accessory_2.AccessoryData.ReloadingSpeedDown}\n视野倍数：${this.data.WeaponData.Accessory_2.AccessoryData.Magnificationlens}`,d.LoadSpriteFrame(A.GameData.DefaultBundle,`Res/Items/${this.data.WeaponData.Accessory_2.ImageId}`).then((e=>{i.spriteFrame=e,p.SetImagePreferScale(i,130,130)})))}SetPutTipState(e,t){e.color=I.GetColorFromHex(t)}ClearPutTipState(e){e.color=I.GetColorFromHex(u.None)}onEnable(){m.on(l.Event.ON_ITEM_DRAGSTART,this.OnDragStart,this),m.on(l.Event.ON_ITEM_DRAGGING,this.OnDragging,this),m.on(l.Event.ON_ITEM_DRAGEND,this.OnDragEnd,this)}onDisable(){m.off(l.Event.ON_ITEM_DRAGSTART,this.OnDragStart,this),m.off(l.Event.ON_ITEM_DRAGGING,this.OnDragging,this),m.off(l.Event.ON_ITEM_DRAGEND,this.OnDragEnd,this)}})||C);t._RF.pop()}}}));

System.register("chunks:///_virtual/XGTS_AniFinishRecycle.ts",["cc","./XGTS_PoolManager.ts"],(function(n){var t,e,i,s,c;return{setters:[function(n){t=n.cclegacy,e=n.Component,i=n.Animation,s=n._decorator},function(n){c=n.XGTS_PoolManager}],execute:function(){var o;t._RF.push({},"41e63ff0-ddb0-4179-9187-473cb9bd3e1g","XGTS_AniFinishRecycle",void 0);const{ccclass:a,property:r}=s;n("default",a("XGTS_AniFinishRecycle")(o=class extends e{constructor(...n){super(...n),this.ani=null}onEnable(){this.ani=this.node.getComponent(i),this.ani.on(i.EventType.FINISHED,this.Put,this),this.ani.play()}onDisable(){var n;null==(n=this.ani)||n.off(i.EventType.FINISHED,this.Put,this)}Put(){c.Instance.Put(this.node)}})||o);t._RF.pop()}}}));

System.register("chunks:///_virtual/XGTS_ArrowGuide.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EventManager.ts","./NodeUtil.ts","./XGTS_Constant.ts"],(function(t){var e,i,n,o,r,s,a,u,l,c,h,d,p;return{setters:[function(t){e=t.applyDecoratedDescriptor,i=t.initializerDefineProperty},function(t){n=t.cclegacy,o=t.v3,r=t._decorator,s=t.Component,a=t.tween,u=t.Vec3,l=t.Tween,c=t.math},function(t){h=t.EventManager},function(t){d=t.default},function(t){p=t.XGTS_Constant}],execute:function(){var T,g,f,A,_,w,I;n._RF.push({},"33ae9ei0TtKIriZHmPGUQY9","XGTS_ArrowGuide",void 0);const{ccclass:v,property:y}=r,G=o();t("XGTS_ArrowGuide",(T=v("XGTS_ArrowGuide"),g=y({type:Number}),f=y({type:Number}),T((w=e((_=class extends s{constructor(...t){super(...t),this.Arrow=null,i(this,"floatHeight",w,this),i(this,"duration",I,this),this.target=null}onLoad(){this.Arrow=d.GetNode("Arrow",this.node),G.set(this.node.position.clone()),this.HIDE_TUTORIAL(),h.on(p.Event.SHOW_TUTORIAL,this.SHOW_TUTORIAL,this),h.on(p.Event.HIDE_TUTORIAL,this.HIDE_TUTORIAL,this)}SHOW_TUTORIAL(t){t&&(this.node.active=!0,this.target=t,a(this.Arrow).repeatForever(a().to(this.duration,{position:new u(G.x+this.floatHeight,G.y,G.z)},{easing:"sineInOut"}).to(this.duration,{position:G},{easing:"sineInOut"})).start())}HIDE_TUTORIAL(){this.node.active=!1,l.stopAllByTarget(this.Arrow)}update(t){if(!this.target)return;let e=this.target.worldPosition.clone().subtract(this.node.worldPosition.clone()).normalize(),i=c.toDegree(Math.atan2(e.y,e.x));this.node.angle=i}}).prototype,"floatHeight",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 20}}),I=e(_.prototype,"duration",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.5}}),A=_))||A));n._RF.pop()}}}));

System.register("chunks:///_virtual/XGTS_AudioManager.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var o,i,t,s,n,r,u;return{setters:[function(e){o=e.applyDecoratedDescriptor,i=e.initializerDefineProperty},function(e){t=e.cclegacy,s=e.AudioClip,n=e._decorator,r=e.Component,u=e.AudioSource}],execute:function(){var l,c,a,p,S,h;t._RF.push({},"9b15cJ9RZ1FX6Hi2tnvAEgI","XGTS_AudioManager",void 0);const{ccclass:d,property:f}=n;e("XGTS_Audio",function(e){return e.BG="BG",e.ButtonClick="ButtonClick",e.Equip="Equip",e.Fire="Fire",e.GetMoney="GetMoney",e.Reload="Reload",e.Unequip="Unequip",e.MissileExplosion="MissileExplosion",e.MissileFire="MissileFire",e.SafeBoxBG="SafeBoxBG",e.SafeBoxT="SafeBoxT",e.SafeBoxF="SafeBoxF",e["红"]="红",e["紫"]="紫",e["蓝"]="蓝",e["难过"]="难过",e["一般"]="一般",e["开心"]="开心",e["游戏内BGM"]="游戏内BGM",e}({})),e("XGTS_AudioManager",(l=d("XGTS_AudioManager"),c=f([s]),l(((h=class e extends r{constructor(...e){super(...e),this.bgmSource=null,this.sfxSource=null,i(this,"clips",S,this)}onLoad(){e.Instance=this,this.bgmSource=this.node.addComponent(u),this.sfxSource=this.node.addComponent(u),this.bgmSource.playOnAwake=!1,this.sfxSource.playOnAwake=!1,this.bgmSource.loop=!0,this.sfxSource.loop=!1}PlayBGM(e){let o=this.clips.find((o=>o.name==e));o?(this.bgmSource.clip=o,this.scheduleOnce((()=>{this.bgmSource.play()}))):console.error(`没有这个音效：${e}`)}PlaySFX(e,o=1){let i=this.clips.find((o=>o.name==e));i?this.sfxSource.playOneShot(i,o):console.error(`没有这个音效：${e}`)}StopBGM(){this.bgmSource.stop()}SetBGMVolume(e){this.bgmSource.volume=e}SetSFXVolume(e){this.sfxSource.volume=e}}).Instance=null,S=o((p=h).prototype,"clips",[c],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),a=p))||a));t._RF.pop()}}}));

System.register("chunks:///_virtual/XGTS_BackpackInventory.ts",["cc","./NodeUtil.ts","./XGTS_InventoryGrid.ts","./XGTS_DataManager.ts","./XGTS_Constant.ts","./XGTS_Data.ts","./XGTS_GridCell.ts","./XGTS_PoolManager.ts","./Tools.ts","./XGTS_Inventory.ts","./BundleManager.ts","./GameManager.ts","./XGTS_GameManager.ts","./XGTS_UIManager.ts","./UIManager.ts","./EventManager.ts","./XGTS_AudioManager.ts"],(function(a){var t,e,n,i,s,r,l,o,c,u,p,h,m,y,D,k,S,I,T,d,P,g;return{setters:[function(a){t=a.cclegacy,e=a.UITransform,n=a.Label,i=a.Sprite,s=a._decorator},function(a){r=a.default},function(a){l=a.XGTS_InventoryGrid},function(a){o=a.XGTS_DataManager},function(a){c=a.XGTS_Constant},function(a){u=a.XGTS_ItemType},function(a){p=a.GridCellState},function(a){h=a.XGTS_PoolManager},function(a){m=a.Tools},function(a){y=a.default},function(a){D=a.BundleManager},function(a){k=a.GameManager},function(a){S=a.XGTS_GameManager},function(a){I=a.XGTS_UIManager},function(a){T=a.UIManager},function(a){d=a.EventManager},function(a){P=a.XGTS_AudioManager,g=a.XGTS_Audio}],execute:function(){var G;t._RF.push({},"7a2c0xdEEVGh7+kCjnPYjss","XGTS_BackpackInventory",void 0);const{ccclass:B,property:C}=s;a("default",B("XGTS_BackpackInventory")(G=class extends y{constructor(...a){super(...a),this.Item=null,this.ItemLabel=null,this.Icon=null,this.PutTip=null,this.ndTrans=null,this.inBox=!1,this.playerNum=0}onLoad(){this.Item=r.GetComponent("Item",this.node,e),this.ItemLabel=r.GetComponent("ItemLabel",this.node,n),this.ItemContent=r.GetNode("ItemContent",this.node),this.ItemContentTrans=this.ItemContent.getComponent(e),this.Icon=r.GetComponent("Icon",this.node,i),this.PutTip=r.GetComponent("PutTip",this.node,i),this.ndTrans=this.node.getComponent(e)}InitPlayerNum(a){this.playerNum=a}Refresh(){let a=o.PlayerDatas[this.playerNum].BackpackData;if(a){let t=a.EquipData.CarryingSpace.width,e=a.EquipData.CarryingSpace.height,n=o.PlayerDatas[this.playerNum].BackpackGrid;n.width!==t||n.height!==e?l.ResizeGrid(n,t,e):l.ClearGrid(n),this.ItemContentTrans.setContentSize(t*c.itemSize,e*c.itemSize),this.ndTrans.setContentSize(170+t*c.itemSize+20,150+e*c.itemSize),this.ItemLabel.string=a.Name,D.LoadSpriteFrame(k.GameData.DefaultBundle,`Res/Items/${a.ImageId}`).then((a=>{this.Icon.spriteFrame=a,S.SetImagePreferScale(this.Icon,130,130)})),super.Init(a.EquipData.ItemData,o.PlayerDatas[this.playerNum].BackpackGrid)}else this.ClearItems(),this.Icon.spriteFrame=null,this.ItemContentTrans.setContentSize(0,0),this.ndTrans.setContentSize(170,250),this.ItemLabel.string="背包"}EquipBackpack(a){o.PlayerDatas[this.playerNum].EquipBackpack(a),this.Refresh()}CanEquipBackpack(a,t){if(this.Item.getBoundingBoxToWorld().contains(t)){this.inBox=!0;let t=a.Type==u.Backpack&&null==o.PlayerDatas[this.playerNum].BackpackData;return this.SetPutTipState(t?p.CanPut:p.CanntPut),t}return this.inBox&&(this.ClearPutTipState(),this.inBox=!1),!1}SetPutTipState(a){this.PutTip.color=m.GetColorFromHex(a)}ClearPutTipState(){this.PutTip.color=m.GetColorFromHex(p.None)}OnDragStart(a){o.PlayerDatas[this.playerNum].BackpackData&&super.OnDragStart(a)}OnDragging(a,t){this.CanEquipBackpack(a.data,t),o.PlayerDatas[this.playerNum].BackpackData&&super.OnDragging(a,t)}OnDragEnd(a,t){if(this.CanEquipBackpack(a.data,t))return this.ClearPutTipState(),a.RemoveItemFromAndResetLastInventory(),this.EquipBackpack(a.data),h.Instance.Put(a.node),o.SaveData(),void S.Instance.HideTipCells();this.ClearPutTipState(),o.PlayerDatas[this.playerNum].BackpackData&&super.OnDragEnd(a,t)}OnButtonClick(a){switch(P.Instance.PlaySFX(g.ButtonClick),a.target.name){case"Item":if(!o.PlayerDatas[this.playerNum].BackpackData)return;I.Instance.ShowPanel(c.Panel.ItemInfoPanel,[o.PlayerDatas[this.playerNum].BackpackData,!0,a=>{if("Sell"==a&&(o.PlayerDatas[this.playerNum].BackpackData&&0==o.PlayerDatas[this.playerNum].BackpackData.EquipData.ItemData.length?(T.ShowTip(`出售成功，获得${o.PlayerDatas[this.playerNum].BackpackData.Price.toLocaleString()}`),P.Instance.PlaySFX(g.GetMoney),o.PlayerDatas[this.playerNum].Money+=o.PlayerDatas[this.playerNum].BackpackData.Price,o.PlayerDatas[this.playerNum].BackpackData=null,this.Refresh()):o.PlayerDatas[this.playerNum].BackpackData.EquipData.ItemData.length>0&&T.ShowTip("出售失败，背包中还有物品")),"Takeoff"==a)if(o.PlayerDatas[this.playerNum].BackpackData&&0==o.PlayerDatas[this.playerNum].BackpackData.EquipData.ItemData.length){let a=0;S.IsDoubleMode&&(a=1),o.PlayerDatas[a].AddItemToInventory(o.PlayerDatas[this.playerNum].BackpackData)?(d.Scene.emit(c.Event.REFRESH_INVENTORY_ITEMS),P.Instance.PlaySFX(g.Unequip),o.PlayerDatas[this.playerNum].BackpackData=null):T.ShowTip("放入失败"),this.Refresh()}else o.PlayerDatas[this.playerNum].BackpackData.EquipData.ItemData.length>0&&T.ShowTip("放入失败，背包中还有物品")}])}}})||G);t._RF.pop()}}}));

System.register("chunks:///_virtual/XGTS_Bullet.ts",["cc","./XGTS_Constant.ts","./XGTS_PoolManager.ts"],(function(t){var i,e,n,o,s,a,l,r,d,c,g,h,u;return{setters:[function(t){i=t.cclegacy,e=t.Component,n=t.RigidBody2D,o=t.v3,s=t.v2,a=t.BoxCollider2D,l=t.Contact2DType,r=t.Vec2,d=t.find,c=t.misc,g=t._decorator},function(t){h=t.XGTS_Constant},function(t){u=t.XGTS_PoolManager}],execute:function(){var p;i._RF.push({},"201c1UdRpNNsqSCkIG2EcHd","XGTS_Bullet",void 0);const{ccclass:y,property:C}=g;t("default",y("XGTS_Bullet")(p=class extends e{constructor(...t){super(...t),this.rigidbody=null,this.target=null,this.weapon=null,this.ammo=null,this.playerData=null}onLoad(){this.rigidbody=this.node.getComponent(n)}Init(t,i,e,n){this.target=t,this.weapon=i,this.ammo=e,this.playerData=n;let r=o(this.node.right.clone().multiplyScalar(500));this.rigidbody.applyForceToCenter(s(r.x,r.y),!0),this.node.getComponent(a).on(l.BEGIN_CONTACT,this.onBeginContact,this)}InitBlank(t,i){this.rigidbody.linearVelocity=r.ZERO,this.rigidbody.angularVelocity=0,this.target=t,this.rigidbody.applyLinearImpulseToCenter(i,!0),this.rigidbody.applyTorque(.5,!0)}onBeginContact(t,i,e){if(i.group==h.Group.Obstacle){const t=e.getWorldManifold();let i=u.Instance.Get(h.Prefab.Explosion,d("Canvas"));i.setWorldPosition(o(t.points[0].x,t.points[0].y)),i.angle=c.radiansToDegrees(s(0,1).signAngle(t.normal.negative()))-90,this.scheduleOnce((()=>{u.Instance.Put(this.node)}))}}update(t){this.target&&this.target.node?(this.target.isDie||r.distance(this.node.getWorldPosition(),this.target.node.getWorldPosition())>3500)&&(this.rigidbody.linearVelocity=r.ZERO,u.Instance.Put(this.node)):(this.rigidbody.linearVelocity=r.ZERO,u.Instance.Put(this.node))}})||p);i._RF.pop()}}}));

System.register("chunks:///_virtual/XGTS_CameraController.ts",["cc","./TweenUtil.ts","./EventManager.ts","./Tools.ts","./XGTS_Constant.ts","./XGTS_LvManager.ts","./XGTS_GameManager.ts"],(function(t){var e,i,s,o,a,n,r,h,l,c,d,m,p,g,y,u;return{setters:[function(t){e=t.cclegacy,i=t.v3,s=t._decorator,o=t.Component,a=t.Camera,n=t.view,r=t.Tween,h=t.tween,l=t.Vec3,c=t.Vec2},function(t){d=t.EasingType},function(t){m=t.EventManager},function(t){p=t.Tools},function(t){g=t.XGTS_Constant},function(t){y=t.XGTS_LvManager},function(t){u=t.XGTS_GameManager}],execute:function(){var M,x;e._RF.push({},"a4524NUihZDNKeezWxC3kG6","XGTS_CameraController",void 0);const{ccclass:P,property:T}=s,C=i(),S=i(),f=i(),v=i();t("default",P("XGTS_CameraController")(((x=class t extends o{constructor(...t){super(...t),this.camera=null,this.stopFollow=!1,this.target=null,this.player1=null,this.player2=null,this.baseOrthoHeight=540,this.maxOrthoHeight=850,this.maxDistanceHight=1200,this.maxDistanceWidth=2800,this.screenRatio=16/9}onLoad(){t.Instance=this,this.camera=this.node.getComponent(a),this.node.setWorldPosition(y.Instance.playerPosition.worldPosition);const e=n.getVisibleSize();this.screenRatio=e.width/e.height;const i=this.maxOrthoHeight/this.camera.orthoHeight,s=Math.floor(e.height*i),o=Math.floor(e.width*i);this.maxDistanceHight=s-200,this.maxDistanceWidth=o-200,m.on(g.Event.RESET_CAMERA,this.resetCamera,this)}onDestroy(){m.off(g.Event.RESET_CAMERA,this.resetCamera,this)}resetCamera(){this.target=null,this.player1=null,this.player2=null}Move(t){this.stopFollow=!0,this.node.getPosition(v),v.add(t.negative().multiplyScalar(5)),v.set(i(p.Clamp(v.x,-y.Instance.MapSize.x/2,y.Instance.MapSize.x/2),p.Clamp(v.y,-y.Instance.MapSize.y/2,y.Instance.MapSize.y/2))),this.node.setPosition(i(v.x,v.y,1e3))}ZoomIn(){r.stopAllByTarget(this.camera),h(this.camera).to(.2,{orthoHeight:540},{easing:d.quadIn}).start()}ZoomOut(t=600,e=null){r.stopAllByTarget(this.camera),h(this.camera).to(.2,{orthoHeight:t},{easing:d.quadIn}).start(),h(this.camera.node).to(.3,{position:i(this.camera.node.position.x,this.camera.node.position.y+1,this.camera.node.position.z)}).call((()=>{e&&e()})).start()}setDoublePlayer(t,e){this.player1=t,this.player2=e}checkPlayerMovementRestriction(t,e){const i=t>=this.maxDistanceWidth,s=e>=this.maxDistanceHight;m.Scene.emit(g.Event.RESTRICT_PLAYER_MOVEMENT,{restrictX:i,restrictY:s,midPoint:this.node.worldPosition})}update(t){if(!this.stopFollow)if(u.IsDoubleMode)if(this.player1&&this.player2){this.player1.getWorldPosition(C),this.player2.getWorldPosition(S);const t=i((C.x+S.x)/2,(C.y+S.y)/2,1e3),e=Math.abs(C.x-S.x),s=Math.abs(C.y-S.y),o=s/.8,a=e/.8/this.screenRatio,n=Math.max(a,o,this.baseOrthoHeight),r=Math.min(n,this.maxOrthoHeight);this.camera.orthoHeight=r,l.lerp(f,this.node.worldPosition,t,.15),this.node.setWorldPosition(f),this.checkPlayerMovementRestriction(e,s)}else{if(!this.player1&&!this.player2)return;(this.player1||this.player2).getWorldPosition(C),l.lerp(f,this.node.worldPosition,i(C.x,C.y,1e3),.1),this.node.setWorldPosition(f),this.checkPlayerMovementRestriction(0,0)}else{if(!this.target)return;this.node.getWorldPosition(C),this.target.getWorldPosition(S),c.lerp(f,C,S,.3),this.node.setWorldPosition(i(f.x,f.y,1e3))}}}).Instance=null,M=x))||M);e._RF.pop()}}}));

System.register("chunks:///_virtual/XGTS_CharacterController.ts",["cc","./NodeUtil.ts","./XGTS_GameManager.ts","./EventManager.ts","./XGTS_Constant.ts","./XGTS_PoolManager.ts","./Tools.ts","./XGTS_Bullet.ts","./XGTS_Data.ts","./XGTS_LvManager.ts","./XGTS_FloatingText.ts","./XGTS_DataManager.ts"],(function(e){var t,n,i,a,s,o,l,r,h,p,c,d,m,u,g,S,M,f,C,k,I,A,T;return{setters:[function(e){t=e.cclegacy,n=e.v3,i=e.Component,a=e.v2,s=e.RigidBody2D,o=e.CircleCollider2D,l=e.sp,r=e.UITransform,h=e.Vec2,p=e.math,c=e.Color,d=e._decorator},function(e){m=e.default},function(e){u=e.XGTS_GameManager},function(e){g=e.EventManager},function(e){S=e.XGTS_Constant},function(e){M=e.XGTS_PoolManager},function(e){f=e.Tools},function(e){C=e.default},function(e){k=e.XGTS_ItemType},function(e){I=e.XGTS_LvManager},function(e){A=e.XGTS_FloatingText},function(e){T=e.XGTS_DataManager}],execute:function(){var G;t._RF.push({},"87080LXpwtGpL7PEH9YxxIW","XGTS_CharacterController",void 0);const{ccclass:D,property:y}=d,_=n();let v=e("PlayerAniState",function(e){return e.None="None",e.Idle="待机",e.Hit="受击",e.Shoot="开枪",e.Dead="死亡",e.Move="移动",e.Attack="近战",e.Reload="换弹",e.Roll="翻滚",e.LS_Idle="leisi/Standby",e.LS_Shoot="leisi/sj",e.LS_Move="leisi/walk-loop",e.LS_Attack="leisi/zhouji",e}({}));e("default",D("XGTS_CharacterController")(G=class extends i{constructor(...e){super(...e),this.MaxHP=600,this.rigidbody=null,this.collider=null,this.character=null,this.spine=null,this.spineTrans=null,this.gunBone=null,this.hpBar=null,this.isPlayer=!1,this.isFire=!1,this.maxSpeed=20,this.speed=20,this.dir=a(),this.fireDir=a(),this.aniMap=new Map,this.weapon=null,this.reloadCallback=null,this.useMelee=!1,this.results=null,this.isEnemy=!1,this.isDie=!1,this._hp=0}get HP(){return this._hp}set HP(e){var t;e<=0&&(e=0,this.Die()),this._hp=f.Clamp(e,0,this.MaxHP),null==(t=this.hpBar)||t.Set(this._hp/this.MaxHP)}onLoad(){this.rigidbody=this.node.getComponent(s),this.collider=this.node.getComponent(o),this.character=m.GetNode("Character",this.node),this.spine=m.GetComponent("Spine",this.node,l.Skeleton),this.spineTrans=this.spine.node.getComponent(r),this.gunBone=this.spine.findBone("rotation"),this.SetAniMix(v.Idle,v.Move),this.SetAniMix(v.Hit,v.Shoot)}SetAniMix(e,t){var n,i;null==(n=this.spine)||n.setMix(e,t,.2),null==(i=this.spine)||i.setMix(t,e,.2)}SetGun(e){if(this.weapon=e,e){this.useMelee=!1;let t=e.Name;f.IsEmptyStr(T.GetGunUseSkin(e.Name))||(t=`${T.GetGunUseSkin(e.Name)}`),this.spine.setAttachment("gun",t)}}SetMeelee(){this.useMelee=!0,this.spine.setAttachment("gun","刀")}SetEquipment(e="",t="",n=""){console.log("装备：","头盔="+e,"护甲="+t,"背包="+n),this.spine.setAttachment("tk",e),this.spine.setAttachment("hj",t),this.spine.setAttachment("bb",n)}Reload(e=null){this.reloadCallback=e,this.PlayAni(1,v.Reload,!1)}SetDir(e,t,i){this.dir.set(e,t),this.isFire||(this.character.scale=n(e<0?-1:1,1)),this.speed=i*this.maxSpeed,this.PlayAni(0,v.Move)}StopMove(){this.speed=0,this.dir.set(h.ZERO),this.rigidbody.enabled&&(this.rigidbody.linearVelocity=a(this.dir.x,this.dir.y)),this.PlayAni(0,v.Idle)}SetGunDir(e){if(u.IsGameOver)return;this.fireDir.set(e),this.character.scale=n(e.x<0?-1:1,1);const t=this.character.scale.x<0?-1:1,i=e.x*t;let a=180*Math.atan2(e.y,i)/Math.PI;this.gunBone.rotation=a}SetSkin(e){this.spine.setSkin(e)}Fire(){u.IsGameOver||(this.isFire=!0,this.schedule(this.StartFire,.1))}StartFire(){if(u.IsGameOver)return;if(this.useMelee&&this.PlayAni(1,v.Attack),!this.weapon)return;if(!this.weapon.WeaponData.Ammo||this.weapon.WeaponData.Ammo.Count<=0)return void this.StopAni(1);this.useMelee||this.PlayAni(1,v.Shoot);this.weapon.WeaponData.Ammo.Count-=1,g.Scene.emit(S.Event.REFRESH_WEAON_CONTENT);const e=this.spine.findBone(this.weapon.Name);for(let t=0;t<1;t++){let t=M.Instance.Get(S.Prefab.Bullet,I.Instance.Layer_Effects);t.setWorldPosition(this.spineTrans.convertToWorldSpaceAR(_.set(e.worldX,e.worldY,0))),t.angle=this.character.scale.x<0?180-this.gunBone.rotation:this.gunBone.rotation,t.getComponent(C).Init(this,this.weapon,this.weapon.WeaponData.Ammo,null)}let t=M.Instance.Get(S.Prefab.BulletBlank,I.Instance.Layer_Effects);this.spineTrans.convertToWorldSpaceAR(_.set(e.worldX,e.worldY,0),_),t.setWorldPosition(_),t.getComponent(C).InitBlank(this,a(-5*this.character.scale.x,f.GetRandom(5,8)).multiplyScalar(.2))}Die(){}StopFire(){this.isFire=!1,this.unschedule(this.StartFire),this.StopAni(1)}PlayAni(e,t,n=!0,i=1){if(u.IsGameOver)return;if(this.aniMap.has(e)||this.aniMap.set(e,null),this.aniMap.get(e)&&this.aniMap.get(e).animation.name==t&&this.aniMap.get(e).timeScale==i)return;const a=this.spine.setAnimation(e,t,n);a?(a.timeScale=i,this.aniMap.set(e,a)):console.error(`${this.node.name} 上没有 ${t} 状态`)}StopAni(e){var t;this.aniMap.set(e,null),null==(t=this.spine)||t.clearTrack(e)}TakeDamage(e,t){if(u.IsGameOver)return;let i=e.WeaponData.Damage/2,a=M.Instance.Get(S.Prefab.FloatingText,this.node);a.setWorldPosition(n(this.node.worldPosition.x+20*p.random(),this.node.worldPosition.y+100+20*p.random(),0)),a.getComponent(A).Show(`-${i}`,"#FF0000","#AC0000",.3),this.node.getComponentInChildren(l.Skeleton)&&(console.log("变色"),this.node.getComponentInChildren(l.Skeleton).color=c.RED,this.scheduleOnce((()=>{this.node.getComponentInChildren(l.Skeleton).color=c.WHITE}),.12)),this.HP-=i}MeleeAttack(){}TakeMeleeDamage(e){let t=M.Instance.Get(S.Prefab.FloatingText,this.node);t.setWorldPosition(n(this.node.worldPosition.x+20*p.random(),this.node.worldPosition.y+100+20*p.random(),0)),t.getComponent(A).Show(`-${e}`,"#FF0000","#AC0000",.3),this.node.getComponentInChildren(l.Skeleton)&&(console.log("变色"),this.node.getComponentInChildren(l.Skeleton).color=c.RED,this.scheduleOnce((()=>{this.node.getComponentInChildren(l.Skeleton).color=c.WHITE}),.12)),this.HP-=e}update(e){this.rigidbody.enabled&&(this.rigidbody.linearVelocity=a(this.dir.x*this.speed,this.dir.y*this.speed))}AddSpineListener(){this.spine.setStartListener((e=>{e.animation&&e.animation.name})),this.spine.setInterruptListener((e=>{var t=e.animation?e.animation.name:"";console.log("[track %s][animation %s] interrupt.",e.trackIndex,t)})),this.spine.setEndListener((e=>{var t=e.animation?e.animation.name:"";console.log("[track %s][animation %s] end.",e.trackIndex,t)})),this.spine.setDisposeListener((e=>{var t=e.animation?e.animation.name:"";console.log("[track %s][animation %s] will be disposed.",e.trackIndex,t)})),this.spine.setCompleteListener((e=>{e.animation&&e.animation.name,Math.floor(e.trackTime/e.animationEnd)})),this.spine.setEventListener(((e,t)=>{e.animation&&e.animation.name;t.data.name,"Replenish"==t.data.name&&(this.reloadCallback&&this.reloadCallback(),this.reloadCallback=null),"jj1"==t.data.name&&this.MeleeAttack(),"jj2"==t.data.name&&this.MeleeAttack()}))}CheckSpine(){for(let e=0;e<T.ItemDataMap.get(k.Weapon).length;e++){let t=T.ItemDataMap.get(k.Weapon)[e];this.spine.getAttachment("gun",t.Name)||console.error(`找不到枪皮肤 Name: ${t.Name}`),this.spine.findBone(t.Name)||console.error(`找不到枪口骨骼 Name: ${t.Name}`)}for(let e=0;e<T.ItemDataMap.get(k.Helmet).length;e++){this.spine.getAttachment("tk",T.ItemDataMap.get(k.Helmet)[e].Name)||console.error(T.ItemDataMap.get(k.Helmet)[e].Name)}for(let e=0;e<T.ItemDataMap.get(k.BodyArmor).length;e++){this.spine.getAttachment("hj",T.ItemDataMap.get(k.BodyArmor)[e].Name)||console.error(T.ItemDataMap.get(k.BodyArmor)[e].Name)}for(let e=0;e<T.ItemDataMap.get(k.Backpack).length;e++){this.spine.getAttachment("bb",T.ItemDataMap.get(k.Backpack)[e].Name)||console.error(T.ItemDataMap.get(k.Backpack)[e].Name)}}DebugSlot(){var e,t,n,i;this.spine.debugSlots=!(null!=(e=this.spine)&&e.debugSlots),this.spine.debugBones=!(null!=(t=this.spine)&&t.debugBones),this.spine.debugMesh=!(null!=(n=this.spine)&&n.debugMesh),this.spine.useTint=!(null!=(i=this.spine)&&i.useTint)}})||G);t._RF.pop()}}}));

System.register("chunks:///_virtual/XGTS_CharacterEnemy.ts",["cc","./XGTS_CharacterController.ts","./XGTS_Constant.ts","./XGTS_DataManager.ts","./XGTS_GameManager.ts","./XGTS_Data.ts","./XGTS_PoolManager.ts","./XGTS_Bullet.ts","./Tools.ts","./XGTS_HPBar.ts","./XGTS_LvManager.ts","./XGTS_Supplies.ts","./XGTS_AudioManager.ts"],(function(t){var e,n,i,o,s,a,r,l,h,d,c,u,p,m,g,T,S,f,G,y,C,P,D,v,_,w;return{setters:[function(t){e=t.cclegacy,n=t.v3,i=t.Contact2DType,o=t.Vec2,s=t.Vec3,a=t.PhysicsSystem2D,r=t.ERaycast2DType,l=t.RigidBody2D,h=t.v2,d=t.math,c=t.misc,u=t._decorator},function(t){p=t.default,m=t.PlayerAniState},function(t){g=t.XGTS_Constant},function(t){T=t.XGTS_DataManager},function(t){S=t.XGTS_GameManager},function(t){f=t.XGTS_ItemType},function(t){G=t.XGTS_PoolManager},function(t){y=t.default},function(t){C=t.Tools},function(t){P=t.default},function(t){D=t.XGTS_LvManager},function(t){v=t.default},function(t){_=t.XGTS_AudioManager,w=t.XGTS_Audio}],execute:function(){var I;e._RF.push({},"8dbd8rd7WhA+Y3U8svOwB4Z","XGTS_CharacterEnemy",void 0);const{ccclass:X,property:A}=u,B=n(),M=n();t("default",X("XGTS_CharacterEnemy")(I=class extends p{constructor(...t){super(...t),this.results=null,this.needMove=!1,this.lostTargetTime=3,this.lostTargetTimer=0,this.isEnemy=!0}onLoad(){super.onLoad(),this.speed=10,this.MaxHP=100,this.HP=100,this.isDie=!1,this.collider.on(i.BEGIN_CONTACT,this.onBeginContact,this),this.collider.on(i.END_CONTACT,this.onEndContact,this);let t=G.Instance.Get(g.Prefab.HPBar,this.node);this.hpBar=t.getComponent(P),this.hpBar.Init(),this.AddSpineListener()}start(){this.RefreshEquip()}RefreshEquip(){this.weapon=T.ItemDataMap.get(f.Weapon).find((t=>"野牛"==t.Name));let t=T.GetItemDataByType(f.Ammo,51314);this.weapon.WeaponData.Ammo=t,this.weapon.WeaponData.Ammo.Count=this.weapon.WeaponData.Clip,this.SetGun(this.weapon)}SetDir(t,e,n){super.SetDir(t,e,n)}SetGunDir(t){super.SetGunDir(t)}StopMove(){super.StopMove()}Die(){this.StopFire(),this.isDie||(this.isDie=!0,this.PlayAni(0,m.Dead,!1),D.Instance.matchData.KilledPE++)}InitDeadBox(){this.scheduleOnce((()=>{this.node.active=!1}));let t=G.Instance.Get(g.Prefab.Supplies,D.Instance.Layer_Supplies);t.setWorldPosition(this.node.getWorldPosition()),t.getComponent(v).InitCharacterCase(!1)}update(t){var e;if(S.IsGameOver)return;if(this.isDie)return void(this.rigidbody.linearVelocity=o.ZERO);const n=S.IsDoubleMode?S.Instance.playerNodes.filter((t=>t.active&&t.getComponent(p).HP>0)):[null==(e=S.Instance.player)?void 0:e.node].filter(Boolean);if(0===n.length)return;let i=1/0,d=null;for(const t of n){const e=t.worldPosition,n=s.distance(this.node.worldPosition,e),o=a.instance.raycast(this.node.worldPosition,e,r.Closest);o&&o.length>0&&o[0].collider.node.getComponent(l).group===g.Group.Player&&n<i&&(i=n,d=t)}if(!d)return this.StopFire(),void(this.needMove=!1);if(d.getWorldPosition().clone().subtract(this.node.getWorldPosition().clone()).length()>3e3||this.lostTargetTimer>this.lostTargetTime)return this.StopFire(),void(this.lostTargetTimer=0);if(this.results=a.instance.raycast(this.node.worldPosition,d.worldPosition,r.Closest),this.results&&this.results.length>=1&&this.results[0].collider.node.getComponent(l).group==g.Group.Player){const t=this.results[0].collider.node;this.lostTargetTimer=0,B.set(t.getWorldPosition().clone().subtract(this.node.getWorldPosition().clone())),M.set(B),B.normalize(),this.dir.set(B.x,B.y),M.length()<900?(M.length()<500&&(this.needMove=!1),this.SetGunDir(h(B.x,B.y)),this.Fire()):this.needMove=!0}else this.lostTargetTimer+=t;this.needMove?(this.PlayAni(0,m.Move),super.update(t)):(this.PlayAni(0,m.Idle),this.rigidbody.linearVelocity=o.ZERO)}Fire(){if(!this.isFire){if(S.IsGameOver)return;this.isFire=!0,this.schedule(this.StartFire,.1)}}StartFire(){if(S.IsGameOver)return;if(!this.weapon)return;if(this.weapon.WeaponData.Ammo.Count<=0)return void this.Reload((()=>{this.scheduleOnce((()=>{this.weapon.WeaponData.Ammo.Count=this.weapon.WeaponData.Clip}),2*(d.random()+.3))}));_.Instance.PlaySFX(w.Fire,.3),this.PlayAni(1,m.Shoot);this.weapon.WeaponData.Ammo.Count-=1;const t=this.spine.findBone(this.weapon.Name);for(let e=0;e<1;e++){let e=G.Instance.Get(g.Prefab.Bullet,this.node);e.setWorldPosition(this.spineTrans.convertToWorldSpaceAR(B.set(t.worldX,t.worldY,0))),e.angle=this.character.scale.x<0?180-this.gunBone.rotation:this.gunBone.rotation,e.getComponent(y).Init(this,this.weapon,C.Clone(this.weapon.WeaponData.Ammo),null)}let e=G.Instance.Get(g.Prefab.BulletBlank,this.node);this.spineTrans.convertToWorldSpaceAR(B.set(t.worldX,t.worldY,0),B),e.setWorldPosition(B),e.getComponent(y).InitBlank(this,h(-5*this.character.scale.x,C.GetRandom(5,8)).multiplyScalar(.2))}StopFire(){this.isFire=!1,this.unschedule(this.StartFire),this.StopAni(1)}AddSpineListener(){this.spine.setEventListener(((t,e)=>{"Replenish"==e.data.name&&(this.reloadCallback&&this.reloadCallback(),this.reloadCallback=null),"die"==e.data.name&&this.InitDeadBox()}))}onBeginContact(t,e,i){if("Bullet"==e.node.name){let t=e.node.getComponent(y);if(t.weapon==this.weapon)return;const o=i.getWorldManifold();let s=G.Instance.Get(g.Prefab.Explosion,D.Instance.Game);s.setWorldPosition(n(o.points[0].x,o.points[0].y)),s.angle=c.radiansToDegrees(h(0,1).signAngle(o.normal.negative()))-90,t&&t.weapon&&(this.TakeDamage(t.weapon,t.ammo),this.scheduleOnce((()=>{G.Instance.Put(e.node)})))}}onEndContact(t,e,n){}onDestroy(){}})||I);e._RF.pop()}}}));

System.register("chunks:///_virtual/XGTS_CharacterEnemyRocketSoldier.ts",["cc","./XGTS_CharacterController.ts","./XGTS_Constant.ts","./XGTS_GameManager.ts","./XGTS_PoolManager.ts","./XGTS_Bullet.ts","./XGTS_HPBar.ts","./XGTS_LvManager.ts","./XGTS_Supplies.ts","./XGTS_Missile.ts","./XGTS_AudioManager.ts"],(function(e){var t,i,n,s,o,r,a,l,h,d,c,u,p,f,S,g,G,C,P,y,m,T,v;return{setters:[function(e){t=e.cclegacy,i=e.v3,n=e.Contact2DType,s=e.Vec2,o=e.Vec3,r=e.PhysicsSystem2D,a=e.ERaycast2DType,l=e.RigidBody2D,h=e.v2,d=e.misc,c=e._decorator},function(e){u=e.default,p=e.PlayerAniState},function(e){f=e.XGTS_Constant},function(e){S=e.XGTS_GameManager},function(e){g=e.XGTS_PoolManager},function(e){G=e.default},function(e){C=e.default},function(e){P=e.XGTS_LvManager},function(e){y=e.default},function(e){m=e.default},function(e){T=e.XGTS_AudioManager,v=e.XGTS_Audio}],execute:function(){var _;t._RF.push({},"6a45c05NR5A/rFXbEJCWzoN","XGTS_CharacterEnemyRocketSoldier",void 0);const{ccclass:D,property:I}=c,M=i(),X=i();e("default",D("XGTS_CharacterEnemyRocketSoldier")(_=class extends u{constructor(...e){super(...e),this.results=null,this.needMove=!1,this.fireBone=null,this.isEnemy=!0,this.fireCooldown=0,this.cooldown=1.5}onLoad(){super.onLoad(),this.speed=10,this.MaxHP=100,this.HP=100,this.isDie=!1,this.collider.on(n.BEGIN_CONTACT,this.onBeginContact,this),this.collider.on(n.END_CONTACT,this.onEndContact,this);let e=g.Instance.Get(f.Prefab.HPBar,this.node);this.hpBar=e.getComponent(C),this.hpBar.Init(),this.fireBone=this.spine.findBone("fire"),this.AddSpineListener()}start(){this.RefreshEquip()}RefreshEquip(){}SetDir(e,t,i){super.SetDir(e,t,i)}SetGunDir(e){super.SetGunDir(e)}StopMove(){super.StopMove()}Die(){this.isDie||(this.isDie=!0,this.PlayAni(0,p.Dead,!1),P.Instance.matchData.KilledPE++)}InitDeadBox(){this.scheduleOnce((()=>{this.node.active=!1}));let e=g.Instance.Get(f.Prefab.Supplies,P.Instance.Layer_Supplies);e.setWorldPosition(this.node.getWorldPosition()),e.getComponent(y).InitCharacterCase(!1)}update(e){var t;if(S.IsGameOver)return;if(this.isDie)return void(this.rigidbody.linearVelocity=s.ZERO);const i=S.IsDoubleMode?S.Instance.playerNodes.filter((e=>e.active&&e.getComponent(u).HP>0)):[null==(t=S.Instance.player)?void 0:t.node].filter(Boolean);if(0===i.length)return;let n=1/0,d=null;for(const e of i){const t=e.worldPosition,i=o.distance(this.node.worldPosition,t),s=r.instance.raycast(this.node.worldPosition,t,a.Closest);s&&s.length>0&&s[0].collider.node.getComponent(l).group===f.Group.Player&&i<n&&(n=i,d=e)}if(!d)return this.StopFire(),void(this.needMove=!1);if(d.getWorldPosition().clone().subtract(this.node.getWorldPosition().clone()).length()>3e3)this.StopFire();else{if(this.results=r.instance.raycast(this.node.worldPosition,d.worldPosition,a.Closest),this.results&&this.results.length>=1&&this.results[0].collider.node.getComponent(l).group==f.Group.Player){const e=this.results[0].collider.node;M.set(e.getWorldPosition().clone().subtract(this.node.getWorldPosition().clone())),X.set(M),M.normalize(),this.dir.set(M.x,M.y),X.length()<900?(X.length()<500&&(this.needMove=!1),this.SetGunDir(h(M.x,M.y)),this.Fire()):this.needMove=!0}this.needMove?(this.PlayAni(0,p.Move),super.update(e)):(this.PlayAni(0,p.Idle),this.rigidbody.linearVelocity=s.ZERO)}}Fire(){if(!this.isFire){if(S.IsGameOver)return;this.isFire=!0,this.schedule(this.StartFire,.1)}}StartFire(){if(!S.IsGameOver&&(this.fireCooldown+=.1,this.fireCooldown>=this.cooldown)){this.PlayAni(1,p.Shoot,!1),T.Instance.PlaySFX(v.MissileFire),this.scheduleOnce((()=>{this.StopAni(1)}),.5);let e=g.Instance.Get(f.Prefab.Missile,P.Instance.Game);e.setWorldPosition(this.spineTrans.convertToWorldSpaceAR(M.set(this.fireBone.worldX,this.fireBone.worldY,0))),e.angle=this.character.scale.x<0?180-this.gunBone.rotation:this.gunBone.rotation,e.getComponent(m).Init(this),this.fireCooldown=0}}StopFire(){this.isFire=!1,this.unschedule(this.StartFire),this.StopAni(1)}AddSpineListener(){this.spine.setEventListener(((e,t)=>{"Replenish"==t.data.name&&(this.reloadCallback&&this.reloadCallback(),this.reloadCallback=null),"die"==t.data.name&&this.InitDeadBox()}))}onBeginContact(e,t,n){if("Bullet"==t.node.name){const e=n.getWorldManifold();let s=g.Instance.Get(f.Prefab.Explosion,P.Instance.Game);s.setWorldPosition(i(e.points[0].x,e.points[0].y)),s.angle=d.radiansToDegrees(h(0,1).signAngle(e.normal.negative()))-90;let o=t.node.getComponent(G);o&&o.weapon&&(this.TakeDamage(o.weapon,o.ammo),this.scheduleOnce((()=>{g.Instance.Put(t.node)})))}}onEndContact(e,t,i){}onDestroy(){}})||_);t._RF.pop()}}}));

System.register("chunks:///_virtual/XGTS_CharacterFengYi_Double.ts",["cc","./XGTS_CharacterController.ts","./EventManager.ts","./XGTS_Constant.ts","./XGTS_DataManager.ts","./XGTS_Data.ts","./NodeUtil.ts","./XGTS_Bullet.ts","./XGTS_PoolManager.ts","./XGTS_LvManager.ts","./XGTS_GameManager.ts","./XGTS_FloatingText.ts","./Tools.ts","./XGTS_UIManager.ts","./XGTS_AudioManager.ts","./XGTS_HPBar.ts","./XGTS_CameraController.ts"],(function(e){var t,i,s,a,n,o,r,h,l,c,m,p,u,d,y,g,S,P,D,_,E,f,T,M,v,N,I,G,A,C,F,R;return{setters:[function(e){t=e.cclegacy,i=e.v3,s=e.Collider2D,a=e.RigidBody2D,n=e.Contact2DType,o=e.ProgressBar,r=e.PhysicsSystem2D,h=e.ERaycast2DType,l=e.math,c=e.v2,m=e.Vec3,p=e.Vec2,u=e.misc,d=e._decorator},function(e){y=e.default,g=e.PlayerAniState},function(e){S=e.EventManager},function(e){P=e.XGTS_Constant},function(e){D=e.XGTS_DataManager},function(e){_=e.XGTS_AmmoData},function(e){E=e.default},function(e){f=e.default},function(e){T=e.XGTS_PoolManager},function(e){M=e.XGTS_LvManager},function(e){v=e.XGTS_GameManager},function(e){N=e.XGTS_FloatingText},function(e){I=e.Tools},function(e){G=e.XGTS_UIManager},function(e){A=e.XGTS_AudioManager,C=e.XGTS_Audio},function(e){F=e.default},function(e){R=e.default}],execute:function(){var w;t._RF.push({},"c1311duuFxJWapc97MtQ1r3","XGTS_CharacterFengYi_Double",void 0);const{ccclass:W,property:X}=d,x=i();e("default",W("XGTS_CharacterFengYi_Double")(w=class extends y{constructor(...e){super(...e),this.currentMagazine=30,this.maxMagazine=30,this.reloading=!1,this.magazineProgress=null,this.MaxHP=900,this.playerNum=0,this.Arrow=null,this.guideTarget=null,this.restrictX=!1,this.restrictY=!1,this.cameraMidPoint=i(),this.autoAttack=!0,this.attackRange=1e3,this.enemyCheckInterval=.5,this.meleeCheckDistance=200,this.currentTarget=null,this.enemyCheckTimer=0,this.nearestEnemyDistance=1/0,this.dirX=void 0,this.dirY=void 0,this.dirRate=void 0,this.isStopMove=!1,this.isEnemy=!1,this.enemies=[],this._enemyIndex=0,this.enemiesPerFrame=5,this._isSearching=!1,this.nearestEnemy=null,this.currentTargetDistance=0}get HP(){return this._hp}set HP(e){var t;e<=0&&("训练场"==M.Instance.MapName?e=1:(e=0,this.Die())),this._hp=I.Clamp(e,0,this.MaxHP),null==(t=this.hpBar)||t.Set(this._hp/this.MaxHP)}Die(){let e;this.StopFire(),this.StopMove(),this.PlayAni(0,g.Dead,!1),this.isDie=!0,this.UnrigistEvent(),1==this.playerNum?R.Instance.player1=null:R.Instance.player2=null,2==v.Instance.playerNodes.length?(e=v.Instance.playerNodes[this.playerNum-1],v.Instance.playerNodes.splice(this.playerNum-1,1)):(e=v.Instance.playerNodes[0],v.Instance.playerNodes.splice(0,1)),e.getComponents(s).forEach((e=>{e.destroy()})),e.getComponent(a).destroy();let t=null;2==v.Instance.players.length?(t=v.Instance.players[this.playerNum-1],v.Instance.players.splice(this.playerNum-1,1)):(t=v.Instance.players[0],v.Instance.players.splice(0,1)),0==v.Instance.playerNodes.length&&(v.IsGameOver=!0),this.scheduleOnce((()=>{D.PlayerDatas[this.playerNum].ClearBackpack(),0==v.Instance.playerNodes.length&&G.Instance.ShowPanel(P.Panel.GameOverPanel,[!1,M.Instance.matchData]),t&&t.destroy()}),2)}onLoad(){super.onLoad(),this.collider.on(n.BEGIN_CONTACT,this.onBeginContact,this),this.collider.on(n.END_CONTACT,this.onEndContact,this),this.Arrow=E.GetNode("Arrow",this.node),this.playerNum=parseInt(this.node.name.split("_")[1]),this.AddSpineListener(),this.RigistEvent(),this.hpBar=this.node.getChildByName("blood").getComponent(F),this.HP=900,this.magazineProgress=E.GetNode("bullet",this.node).getComponent(o),this.magazineProgress.progress=1}start(){this.spine.setSkin("dog"),this.RefreshEquip()}RefreshEquip(){let e="",t="",i="";D.PlayerDatas[this.playerNum].Weapon_Helmet&&(e=D.PlayerDatas[this.playerNum].Weapon_Helmet.Name),D.PlayerDatas[this.playerNum].Weapon_BodyArmor&&(t=D.PlayerDatas[this.playerNum].Weapon_BodyArmor.Name),D.PlayerDatas[this.playerNum].BackpackData&&(i=D.PlayerDatas[this.playerNum].BackpackData.Name);let s=this.weapon;if(s||(D.PlayerDatas[this.playerNum].Weapon_Primary?s=D.PlayerDatas[this.playerNum].Weapon_Primary:D.PlayerDatas[this.playerNum].Weapon_Secondary?s=D.PlayerDatas[this.playerNum].Weapon_Secondary:D.PlayerDatas[this.playerNum].Weapon_Pistol&&(s=D.PlayerDatas[this.playerNum].Weapon_Pistol)),s){this.SetGun(s);let e=D.PlayerDatas[this.playerNum].GetFirstAmmoType(),t=D.PlayerDatas[this.playerNum].GetAmmoByType(e,this.weapon.WeaponData.Clip);this.weapon.WeaponData.Ammo=t}else this.SetMeelee();this.SetEquipment(e,t,i)}SetDir(e,t,i){if(this.dirX=e,this.dirY=t,this.dirRate=i,this.isStopMove=!1,!v.IsGameOver){if(this.restrictX){const t=this.node.worldPosition;(e>0&&t.x>this.cameraMidPoint.x||e<0&&t.x<this.cameraMidPoint.x)&&(e=0)}if(this.restrictY){const e=this.node.worldPosition;(t>0&&e.y>this.cameraMidPoint.y||t<0&&e.y<this.cameraMidPoint.y)&&(t=0)}super.SetDir(e,t,i)}}SetGunDir(e){v.IsGameOver||super.SetGunDir(e)}StopMove(){this.isStopMove=!0,super.StopMove()}update(e){v.IsGameOver||this.isDie||(super.update(e),this.autoAttack&&(this.checkEnemies(e),this.handleAutoAttack()))}Fire(){v.IsGameOver||(this.isFire=!0,this.schedule(this.StartFire,.1))}MeleeAttack(){console.log("近战攻击");let e=this.node.getWorldPosition().clone(),t=e.clone().add(i(this.fireDir.normalize().multiplyScalar(180).x,this.fireDir.normalize().multiplyScalar(180).y));this.results=r.instance.raycast(e,t,h.Closest),this.results&&this.results.length>=1&&this.results[0].collider.group==P.Group.Enemy&&this.results[0].collider.node.getComponent(y).TakeMeleeDamage(10)}Reload(e){this.reloadCallback=e,A.Instance.PlaySFX(C.Reload),this.PlayAni(1,g.Reload,!1)}StartFire(){if(v.IsGameOver||this.reloading)return;if(this.useMelee)return void this.PlayAni(1,g.Attack);if(!this.weapon)return;if(this.weapon.WeaponData.Ammo.Count<=0)return void this.Reload((()=>{this.scheduleOnce((()=>{this.weapon.WeaponData.Ammo.Count=this.weapon.WeaponData.Clip}),2*(l.random()+.3))}));if(!this.weapon.WeaponData.Ammo)return void this.StopAni(1);this.useMelee||(A.Instance.PlaySFX(C.Fire),this.PlayAni(1,g.Shoot));this.weapon.WeaponData.Ammo.Count-=1,this.UpdateMagazineProgress();const e=this.spine.findBone(this.weapon.Name);for(let t=0;t<1;t++){let t=T.Instance.Get(P.Prefab.Bullet,M.Instance.Layer_Effects);t.setWorldPosition(this.spineTrans.convertToWorldSpaceAR(x.set(e.worldX,e.worldY,0))),t.angle=this.character.scale.x<0?180-this.gunBone.rotation:this.gunBone.rotation,t.getComponent(f).Init(this,this.weapon,this.weapon.WeaponData.Ammo,null)}let t=T.Instance.Get(P.Prefab.BulletBlank,M.Instance.Layer_Effects);this.spineTrans.convertToWorldSpaceAR(x.set(e.worldX,e.worldY,0),x),t.setWorldPosition(x),t.getComponent(f).InitBlank(this,c(-5*this.character.scale.x,I.GetRandom(5,8)).multiplyScalar(.2))}UpdateMagazineProgress(){this.magazineProgress&&(this.magazineProgress.progress=this.weapon.WeaponData.Ammo.Count/this.weapon.WeaponData.Clip)}StopFire(){super.StopFire(),this.gunBone.rotation=0,this.useMelee&&(this.fireDir=this.character.scale.x>0?c(1,0):c(-1,0)),this.currentMagazine<=0&&this.Reload()}TakeDamage(e,t){if(v.IsGameOver)return;let s=e.WeaponData.Damage/4;const a=(e,s,a)=>{let n=Math.floor(a*(1-_.GetDamage(t.AmmoData,s))/2);e.Durability-=n,e.Durability=u.clampf(e.Durability,0,99999);let o=T.Instance.Get(P.Prefab.FloatingText,M.Instance.Game);return o.setWorldPosition(i(this.node.worldPosition.x+20*l.random(),this.node.worldPosition.y+100+20*l.random(),0)),o.getComponent(N).Show(`护甲 -${n}`,"#FFAD00","#AC0000",.3),S.Scene.emit(P.Event.REFRESH_WEAON_CONTENT),a*_.GetDamage(t.AmmoData,s)};let n=!1;if(D.PlayerDatas[this.playerNum].Weapon_Helmet&&l.random()<.5){n=!0;let e=D.PlayerDatas[this.playerNum].Weapon_Helmet.Quality;D.PlayerDatas[this.playerNum].Weapon_Helmet.EquipData.Durability>0&&(s=a(D.PlayerDatas[this.playerNum].Weapon_Helmet.EquipData,e,s))}if(D.PlayerDatas[this.playerNum].Weapon_BodyArmor&&!n&&l.random()<.5){let e=D.PlayerDatas[this.playerNum].Weapon_BodyArmor.Quality;D.PlayerDatas[this.playerNum].Weapon_BodyArmor.EquipData.Durability>0&&(s=a(D.PlayerDatas[this.playerNum].Weapon_BodyArmor.EquipData,e,s))}let o=T.Instance.Get(P.Prefab.FloatingText,this.node);o.setWorldPosition(i(this.node.worldPosition.x+20*l.random(),this.node.worldPosition.y+100+20*l.random(),0)),o.getComponent(N).Show(`-${s}`,"#FF0000","#AC0000",.3),this.HP-=s}HandleMovementRestriction(e){const{restrictX:t,restrictY:i,midPoint:s}=e;if(!this.isStopMove){let e=this.restrictX,a=this.restrictY;this.restrictX=t,this.restrictY=i,this.cameraMidPoint=s,e===t&&a===i||this.SetDir(this.dirX,this.dirY,this.dirRate)}}checkEnemies(e){this.autoAttack&&!v.IsGameOver&&this.findNearestEnemy()}findNearestEnemy(){const e=this.node.worldPosition;let t;this._isSearching?t=this._enemyIndex:(this.enemies=M.Instance.Game.getComponentsInChildren(y).filter((e=>e.isEnemy&&e.node.active)),t=0,this._isSearching=!0,this.nearestEnemyDistance=1/0);const i=Math.min(t+this.enemiesPerFrame,this.enemies.length);for(let s=t;s<i;s++){const t=this.enemies[s];if(t.isDie)continue;const i=t.node.worldPosition;if(Math.abs(e.x-i.x)>this.attackRange)continue;const a=r.instance.raycast(e,i,h.Closest);if(a&&a.length>0&&a[0].collider.group!==P.Group.Enemy)continue;const n=m.distance(e,t.node.worldPosition);(this.useMelee?n<=this.meleeCheckDistance:n<=this.attackRange)&&n<this.nearestEnemyDistance&&(this.nearestEnemyDistance=n,this.nearestEnemy=t.node)}i>=this.enemies.length?(this._enemyIndex=0,this._isSearching=!1,this.currentTarget=this.nearestEnemy,this.currentTargetDistance=this.nearestEnemyDistance):this._enemyIndex=i}handleAutoAttack(){if(!this.autoAttack||v.IsGameOver||!this.currentTarget)return void this.StopFire();if(!this.currentTarget.active||this.currentTarget.getComponent(y).isDie)return this.currentTarget=null,void this.StopFire();const e=new p(this.currentTarget.worldPosition.x-this.node.worldPosition.x,this.currentTarget.worldPosition.y-this.node.worldPosition.y).normalize();this.SetGunDir(e),this.useMelee?this.currentTargetDistance<=this.meleeCheckDistance?(this.schedule(this.MeleeAttack,.6),this.Fire()):(this.unschedule(this.MeleeAttack),this.StopFire()):this.currentTargetDistance<=this.attackRange?this.isFire||this.Fire():this.StopFire()}onBeginContact(e,t,s){if(t.node.name,t.node.name,"Bullet"==t.node.name){let e=t.node.getComponent(f);if(e.weapon==this.weapon)return;const a=s.getWorldManifold();let n=T.Instance.Get(P.Prefab.Explosion,M.Instance.Game);n.setWorldPosition(i(a.points[0].x,a.points[0].y)),n.angle=u.radiansToDegrees(c(0,1).signAngle(a.normal.negative()))-90,e&&e.weapon&&(this.TakeDamage(e.weapon,e.ammo),this.scheduleOnce((()=>{T.Instance.Put(t.node)})))}if("Missile"==t.node.name){const e=s.getWorldManifold();A.Instance.PlaySFX(C.MissileExplosion),T.Instance.Get(P.Prefab.MissileExplosion,M.Instance.Game).setWorldPosition(i(e.points[0].x,e.points[0].y)),this.scheduleOnce((()=>{T.Instance.Put(t.node)}));let a=T.Instance.Get(P.Prefab.FloatingText,this.node);a.setWorldPosition(i(this.node.worldPosition.x+20*l.random(),this.node.worldPosition.y+100+20*l.random(),0)),a.getComponent(N).Show("-30","#FF0000","#AC0000",.3),this.HP-=30}t.node.name}onEndContact(e,t,i){t.node.name,t.node.name,t.node.name}onDisable(){this.UnrigistEvent()}onDestroy(){}RigistEvent(){S.Scene.on(P.Event.MOVEMENT+"_"+this.playerNum,this.SetDir,this),S.Scene.on(P.Event.MOVEMENT_STOP+"_"+this.playerNum,this.StopMove,this),S.Scene.on(P.Event.SET_ATTACK_DIR,this.SetGunDir,this),S.Scene.on(P.Event.FIRE_START,this.Fire,this),S.Scene.on(P.Event.FIRE_STOP,this.StopFire,this),S.Scene.on(P.Event.REFRESH_EUIP+"_"+this.playerNum,this.RefreshEquip,this),S.Scene.on(P.Event.RESTRICT_PLAYER_MOVEMENT,this.HandleMovementRestriction,this)}UnrigistEvent(){S.Scene.off(P.Event.MOVEMENT+"_"+this.playerNum,this.SetDir,this),S.Scene.off(P.Event.MOVEMENT_STOP+"_"+this.playerNum,this.StopMove,this),S.Scene.off(P.Event.SET_ATTACK_DIR,this.SetGunDir,this),S.Scene.off(P.Event.FIRE_START,this.Fire,this),S.Scene.off(P.Event.FIRE_STOP,this.StopFire,this),S.Scene.off(P.Event.REFRESH_EUIP+"_"+this.playerNum,this.RefreshEquip,this),S.Scene.off(P.Event.RESTRICT_PLAYER_MOVEMENT,this.HandleMovementRestriction,this)}})||w);t._RF.pop()}}}));

System.register("chunks:///_virtual/XGTS_CharacterFengYi.ts",["cc","./XGTS_CharacterController.ts","./EventManager.ts","./XGTS_Constant.ts","./XGTS_DataManager.ts","./XGTS_Data.ts","./NodeUtil.ts","./XGTS_Bullet.ts","./XGTS_PoolManager.ts","./XGTS_GamePanel.ts","./XGTS_LvManager.ts","./XGTS_GameManager.ts","./XGTS_FloatingText.ts","./Tools.ts","./XGTS_UIManager.ts","./XGTS_AudioManager.ts","./UIManager.ts"],(function(e){var t,a,n,o,i,s,r,l,h,c,p,d,u,S,m,P,D,f,y,T,_,E,g,G,v,A,I;return{setters:[function(e){t=e.cclegacy,a=e.v3,n=e.Contact2DType,o=e.PhysicsSystem2D,i=e.ERaycast2DType,s=e.v2,r=e.math,l=e.misc,h=e._decorator},function(e){c=e.default,p=e.PlayerAniState},function(e){d=e.EventManager},function(e){u=e.XGTS_Constant},function(e){S=e.XGTS_DataManager},function(e){m=e.XGTS_AmmoData},function(e){P=e.default},function(e){D=e.default},function(e){f=e.XGTS_PoolManager},function(e){y=e.default},function(e){T=e.XGTS_LvManager},function(e){_=e.XGTS_GameManager},function(e){E=e.XGTS_FloatingText},function(e){g=e.Tools},function(e){G=e.XGTS_UIManager},function(e){v=e.XGTS_AudioManager,A=e.XGTS_Audio},function(e){I=e.UIManager}],execute:function(){var M;t._RF.push({},"eba64U4vj9Jx4CUtGDB771p","XGTS_CharacterFengYi",void 0);const{ccclass:F,property:C}=h,W=a();e("default",F("XGTS_CharacterFengYi")(M=class extends c{constructor(...e){super(...e),this.Arrow=null,this.guideTarget=null,this.isEnemy=!1}get HP(){return this._hp}set HP(e){var t;e<=0&&("训练场"==T.Instance.MapName?e=1:(e=0,this.Die())),this._hp=g.Clamp(e,0,this.MaxHP),null==(t=this.hpBar)||t.Set(this._hp/this.MaxHP)}Die(){_.IsGameOver=!0,this.isDie=!0,this.StopFire(),this.StopMove(),this.PlayAni(0,p.Dead,!1),this.scheduleOnce((()=>{S.PlayerDatas[0].ClearBackpack(),G.Instance.ShowPanel(u.Panel.GameOverPanel,[!1,T.Instance.matchData])}),2)}onLoad(){super.onLoad(),this.collider.on(n.BEGIN_CONTACT,this.onBeginContact,this),this.collider.on(n.END_CONTACT,this.onEndContact,this),this.Arrow=P.GetNode("Arrow",this.node),this.AddSpineListener(),this.RigistEvent(),this.HP=600}start(){this.spine.setSkin("dog"),this.hpBar=y.Instance.HPBar,this.RefreshEquip()}RefreshEquip(){let e="",t="",a="";S.PlayerDatas[0].Weapon_Helmet&&(e=S.PlayerDatas[0].Weapon_Helmet.Name),S.PlayerDatas[0].Weapon_BodyArmor&&(t=S.PlayerDatas[0].Weapon_BodyArmor.Name),S.PlayerDatas[0].BackpackData&&(a=S.PlayerDatas[0].BackpackData.Name);let n=this.weapon;n||(S.PlayerDatas[0].Weapon_Primary?n=S.PlayerDatas[0].Weapon_Primary:S.PlayerDatas[0].Weapon_Secondary?n=S.PlayerDatas[0].Weapon_Secondary:S.PlayerDatas[0].Weapon_Pistol&&(n=S.PlayerDatas[0].Weapon_Pistol)),n?this.SetGun(n):this.SetMeelee(),this.SetEquipment(e,t,a)}SetDir(e,t,a){_.IsGameOver||super.SetDir(e,t,a)}SetGunDir(e){_.IsGameOver||super.SetGunDir(e)}StopMove(){super.StopMove()}update(e){_.IsGameOver||super.update(e)}Fire(){_.IsGameOver||(this.isFire=!0,this.schedule(this.StartFire,.1))}MeleeAttack(){console.log("近战攻击");let e=this.node.getWorldPosition().clone(),t=e.clone().add(a(this.fireDir.normalize().multiplyScalar(180).x,this.fireDir.normalize().multiplyScalar(180).y));this.results=o.instance.raycast(e,t,i.Closest),this.results&&this.results.length>=1&&this.results[0].collider.group==u.Group.Enemy&&this.results[0].collider.node.getComponent(c).TakeMeleeDamage(10)}Reload(e){this.reloadCallback=e,v.Instance.PlaySFX(A.Reload),this.PlayAni(1,p.Reload,!1)}StartFire(){if(_.IsGameOver)return;if(this.useMelee)return void this.PlayAni(1,p.Attack);if(!this.weapon)return;if(!this.weapon.WeaponData.Ammo)return void this.StopAni(1);if(this.weapon.WeaponData.Ammo.Count<=0)return this.StopFire(),void I.ShowTip("没有子弹");this.useMelee||(v.Instance.PlaySFX(A.Fire),this.PlayAni(1,p.Shoot));this.weapon.WeaponData.Ammo.Count-=1,d.Scene.emit(u.Event.REFRESH_WEAON_CONTENT);const e=this.spine.findBone(this.weapon.Name);for(let t=0;t<1;t++){let t=f.Instance.Get(u.Prefab.Bullet,T.Instance.Layer_Effects);t.setWorldPosition(this.spineTrans.convertToWorldSpaceAR(W.set(e.worldX,e.worldY,0))),t.angle=this.character.scale.x<0?180-this.gunBone.rotation:this.gunBone.rotation,t.getComponent(D).Init(this,this.weapon,this.weapon.WeaponData.Ammo,null)}let t=f.Instance.Get(u.Prefab.BulletBlank,T.Instance.Layer_Effects);this.spineTrans.convertToWorldSpaceAR(W.set(e.worldX,e.worldY,0),W),t.setWorldPosition(W),t.getComponent(D).InitBlank(this,s(-5*this.character.scale.x,g.GetRandom(5,8)).multiplyScalar(.2))}StopFire(){super.StopFire()}TakeDamage(e,t){if(_.IsGameOver)return;let n=e.WeaponData.Damage/4;const o=(e,n,o)=>{let i=Math.floor(o*(1-m.GetDamage(t.AmmoData,n))/2);e.Durability-=i,e.Durability=l.clampf(e.Durability,0,99999);let s=f.Instance.Get(u.Prefab.FloatingText,T.Instance.Game);return s.setWorldPosition(a(this.node.worldPosition.x+20*r.random(),this.node.worldPosition.y+100+20*r.random(),0)),s.getComponent(E).Show(`护甲 -${i}`,"#FFAD00","#AC0000",.3),d.Scene.emit(u.Event.REFRESH_WEAON_CONTENT),o*m.GetDamage(t.AmmoData,n)};let i=!1;if(S.PlayerDatas[0].Weapon_Helmet&&r.random()<.5){i=!0;let e=S.PlayerDatas[0].Weapon_Helmet.Quality;S.PlayerDatas[0].Weapon_Helmet.EquipData.Durability>0&&(n=o(S.PlayerDatas[0].Weapon_Helmet.EquipData,e,n))}if(S.PlayerDatas[0].Weapon_BodyArmor&&!i&&r.random()<.5){let e=S.PlayerDatas[0].Weapon_BodyArmor.Quality;S.PlayerDatas[0].Weapon_BodyArmor.EquipData.Durability>0&&(n=o(S.PlayerDatas[0].Weapon_BodyArmor.EquipData,e,n))}let s=f.Instance.Get(u.Prefab.FloatingText,this.node);s.setWorldPosition(a(this.node.worldPosition.x+20*r.random(),this.node.worldPosition.y+100+20*r.random(),0)),s.getComponent(E).Show(`-${n}`,"#FF0000","#AC0000",.3),this.HP-=n}onBeginContact(e,t,n){if(t.node.name,t.node.name,"Bullet"==t.node.name){let e=t.node.getComponent(D);if(e.weapon==_.Instance.player.weapon)return;const o=n.getWorldManifold();let i=f.Instance.Get(u.Prefab.Explosion,T.Instance.Game);i.setWorldPosition(a(o.points[0].x,o.points[0].y)),i.angle=l.radiansToDegrees(s(0,1).signAngle(o.normal.negative()))-90,e&&e.weapon&&(this.TakeDamage(e.weapon,e.ammo),this.scheduleOnce((()=>{f.Instance.Put(t.node)})))}if("Missile"==t.node.name){const e=n.getWorldManifold();v.Instance.PlaySFX(A.MissileExplosion),f.Instance.Get(u.Prefab.MissileExplosion,T.Instance.Game).setWorldPosition(a(e.points[0].x,e.points[0].y)),this.scheduleOnce((()=>{f.Instance.Put(t.node)}));let o=f.Instance.Get(u.Prefab.FloatingText,this.node);o.setWorldPosition(a(this.node.worldPosition.x+20*r.random(),this.node.worldPosition.y+100+20*r.random(),0)),o.getComponent(E).Show("-30","#FF0000","#AC0000",.3),this.HP-=30}t.node.name}onEndContact(e,t,a){t.node.name,t.node.name,t.node.name}onDisable(){this.UnrigistEvent()}onDestroy(){}RigistEvent(){d.Scene.on(u.Event.MOVEMENT,this.SetDir,this),d.Scene.on(u.Event.MOVEMENT_STOP,this.StopMove,this),d.Scene.on(u.Event.SET_ATTACK_DIR,this.SetGunDir,this),d.Scene.on(u.Event.FIRE_START,this.Fire,this),d.Scene.on(u.Event.FIRE_STOP,this.StopFire,this),d.Scene.on(u.Event.REFRESH_EUIP,this.RefreshEquip,this)}UnrigistEvent(){d.Scene.off(u.Event.MOVEMENT,this.SetDir,this),d.Scene.off(u.Event.MOVEMENT_STOP,this.StopMove,this),d.Scene.off(u.Event.SET_ATTACK_DIR,this.SetGunDir,this),d.Scene.off(u.Event.FIRE_START,this.Fire,this),d.Scene.off(u.Event.FIRE_STOP,this.StopFire,this),d.Scene.off(u.Event.REFRESH_EUIP,this.RefreshEquip,this)}})||M);t._RF.pop()}}}));

System.register("chunks:///_virtual/XGTS_CharacterLS.ts",["cc","./XGTS_CharacterController.ts","./XGTS_Constant.ts","./XGTS_DataManager.ts","./XGTS_GameManager.ts","./XGTS_Data.ts","./XGTS_PoolManager.ts","./XGTS_Bullet.ts","./Tools.ts","./XGTS_HPBar.ts","./XGTS_LvManager.ts","./XGTS_Supplies.ts","./XGTS_AudioManager.ts"],(function(t){var e,i,n,s,o,a,r,l,h,c,d,u,p,g,m,S,T,G,f,y,D,P,_,C,I;return{setters:[function(t){e=t.cclegacy,i=t.v3,n=t.Contact2DType,s=t.Vec2,o=t.PhysicsSystem2D,a=t.ERaycast2DType,r=t.RigidBody2D,l=t.v2,h=t.math,c=t.misc,d=t._decorator},function(t){u=t.default,p=t.PlayerAniState},function(t){g=t.XGTS_Constant},function(t){m=t.XGTS_DataManager},function(t){S=t.XGTS_GameManager},function(t){T=t.XGTS_ItemType},function(t){G=t.XGTS_PoolManager},function(t){f=t.default},function(t){y=t.Tools},function(t){D=t.default},function(t){P=t.XGTS_LvManager},function(t){_=t.default},function(t){C=t.XGTS_AudioManager,I=t.XGTS_Audio}],execute:function(){var X;e._RF.push({},"e83a2XILiBIX4ivypHfNg4t","XGTS_CharacterLS",void 0);const{ccclass:v,property:B}=d,W=i(),A=i();t("default",v("XGTS_CharacterLS")(X=class extends u{constructor(...t){super(...t),this.needMove=!1,this.lostTargetTime=3,this.lostTargetTimer=0,this.isEnemy=!0,this.ani=p.LS_Idle}onLoad(){super.onLoad(),this.speed=12,this.MaxHP=100,this.HP=100,this.isDie=!1,this.collider.on(n.BEGIN_CONTACT,this.onBeginContact,this),this.collider.on(n.END_CONTACT,this.onEndContact,this);let t=G.Instance.Get(g.Prefab.HPBar,this.node);t.setPosition(0,170),this.hpBar=t.getComponent(D),this.hpBar.Init()}start(){this.RefreshEquip()}RefreshEquip(){let t=m.ItemDataMap.get(T.Weapon).find((t=>"S12K"==t.Name)),e=m.GetItemDataByType(T.Ammo,50851);e||console.error("找不到子弹数据 ID：51102"),t.WeaponData.Ammo=e,t.WeaponData.Ammo.Count=t.WeaponData.Clip,this.SetGun(t)}SetDir(t,e,i){super.SetDir(t,e,i)}SetGunDir(t){super.SetGunDir(t)}Die(){this.isDie||(this.isDie=!0,this.InitDeadBox(),P.Instance.matchData.KilledPE++)}InitDeadBox(){this.scheduleOnce((()=>{this.node.active=!1}));let t=G.Instance.Get(g.Prefab.Supplies,P.Instance.Game);t.setWorldPosition(this.node.getWorldPosition()),t.getComponent(_).InitCharacterCase(!0)}update(t){if(!S.IsGameOver&&S.Instance.player)if(this.isDie)this.rigidbody.linearVelocity=s.ZERO;else{if(S.Instance.player.node.getWorldPosition().clone().subtract(this.node.getWorldPosition().clone()).length()>3e3||this.lostTargetTimer>this.lostTargetTime)return this.StopFire(),this.needMove=!1,void(this.lostTargetTimer=0);if(this.results=o.instance.raycast(this.node.worldPosition,S.Instance.player.node.worldPosition,a.Closest),this.results&&this.results.length>=1&&this.results[0].collider.node.getComponent(r).group==g.Group.Player){const t=this.results[0].collider.node;this.lostTargetTimer=0,W.set(t.getWorldPosition().clone().subtract(this.node.getWorldPosition().clone())),A.set(W),W.normalize(),this.dir.set(W.x,W.y),this.needMove=!0,A.length()<300?(this.needMove=!1,this.Fire()):A.length()<900&&(this.ani=p.LS_Move,this.Fire()),this.SetGunDir(l(W.x,W.y))}else this.lostTargetTimer+=t;this.needMove?(this.PlayAni(0,this.ani),super.update(t)):(this.PlayAni(0,p.LS_Idle),this.rigidbody.linearVelocity=s.ZERO)}}Fire(){if(!this.isFire){if(S.IsGameOver)return;this.isFire=!0,this.schedule(this.StartFire,1)}}StartFire(){if(S.IsGameOver)return;if(!this.weapon)return;if(this.weapon.WeaponData.Ammo.Count<=0)return void this.Reload((()=>{this.scheduleOnce((()=>{this.weapon.WeaponData.Ammo.Count=this.weapon.WeaponData.Clip}),2*(h.random()+.3))}));console.error("射击"),this.PlayAni(1,p.LS_Shoot),C.Instance.PlaySFX(I.Fire,.3);const t=this.spine.findBone(this.weapon.Name);for(let e=0;e<5;e++){let e=G.Instance.Get(g.Prefab.Bullet,this.node);e.setWorldPosition(this.spineTrans.convertToWorldSpaceAR(W.set(t.worldX,t.worldY,0)));let i=y.GetRandom(-10,10);e.angle=this.character.scale.x<0?180-this.gunBone.rotation+i:this.gunBone.rotation+i,e.getComponent(f).Init(this,this.weapon,y.Clone(this.weapon.WeaponData.Ammo),null)}let e=G.Instance.Get(g.Prefab.BulletBlank,this.node);this.spineTrans.convertToWorldSpaceAR(W.set(t.worldX,t.worldY,0),W),e.setWorldPosition(W),e.getComponent(f).InitBlank(this,l(-5*this.character.scale.x,y.GetRandom(5,8)).multiplyScalar(.2))}StopFire(){this.isFire=!1,this.unschedule(this.StartFire),this.StopAni(1)}onBeginContact(t,e,n){if("Bullet"==e.node.name){const t=n.getWorldManifold();let s=G.Instance.Get(g.Prefab.Explosion,P.Instance.Game);s.setWorldPosition(i(t.points[0].x,t.points[0].y)),s.angle=c.radiansToDegrees(l(0,1).signAngle(t.normal.negative()))-90;let o=e.node.getComponent(f);if(o.target.rigidbody.group==g.Group.Enemy)return;o&&o.weapon&&(this.TakeDamage(o.weapon,o.ammo),this.scheduleOnce((()=>{G.Instance.Put(e.node)})))}}onEndContact(t,e,i){}onDestroy(){}})||X);e._RF.pop()}}}));

System.register("chunks:///_virtual/XGTS_CharacterStickman.ts",["cc","./XGTS_CharacterController.ts","./XGTS_Constant.ts","./XGTS_DataManager.ts","./XGTS_GameManager.ts","./XGTS_Data.ts","./XGTS_PoolManager.ts","./XGTS_Bullet.ts","./Tools.ts","./XGTS_HPBar.ts","./XGTS_LvManager.ts","./XGTS_Supplies.ts"],(function(t){var e,n,i,o,s,a,r,l,h,c,d,u,p,m,g,S,f,G,C,D,P,T,y,v;return{setters:[function(t){e=t.cclegacy,n=t.v3,i=t.Contact2DType,o=t.Vec2,s=t.Vec3,a=t.PhysicsSystem2D,r=t.ERaycast2DType,l=t.RigidBody2D,h=t.v2,c=t.math,d=t.misc,u=t._decorator},function(t){p=t.default,m=t.PlayerAniState},function(t){g=t.XGTS_Constant},function(t){S=t.XGTS_DataManager},function(t){f=t.XGTS_GameManager},function(t){G=t.XGTS_ItemType},function(t){C=t.XGTS_PoolManager},function(t){D=t.default},function(t){P=t.Tools},function(t){T=t.default},function(t){y=t.XGTS_LvManager},function(t){v=t.default}],execute:function(){var I;e._RF.push({},"47e83M9kBBILZsqnw2Ijnx/","XGTS_CharacterStickman",void 0);const{ccclass:_,property:B}=u,M=n(),W=n();t("default",_("XGTS_CharacterStickman")(I=class extends p{constructor(...t){super(...t),this.results=null,this.needMove=!1,this.isEnemy=!0}onLoad(){super.onLoad(),this.speed=10,this.MaxHP=100,this.HP=100,this.isDie=!1,this.collider.on(i.BEGIN_CONTACT,this.onBeginContact,this),this.collider.on(i.END_CONTACT,this.onEndContact,this);let t=C.Instance.Get(g.Prefab.HPBar,this.node);this.hpBar=t.getComponent(T),this.hpBar.Init(),this.AddSpineListener()}start(){this.RefreshEquip()}RefreshEquip(){let t=S.ItemDataMap.get(G.Weapon).find((t=>"野牛"==t.Name)),e=S.ItemDataMap.get(G.Ammo).find((t=>51602==t.ID));t.WeaponData.Ammo=e,t.WeaponData.Ammo.Count=t.WeaponData.Clip,this.SetGun(t)}SetDir(t,e,n){super.SetDir(t,e,n)}SetGunDir(t){super.SetGunDir(t)}StopMove(){super.StopMove()}Die(){this.isDie||(this.isDie=!0,this.PlayAni(0,m.Dead,!1),y.Instance.matchData.KilledPE++)}InitDeadBox(){this.scheduleOnce((()=>{this.node.active=!1}));let t=C.Instance.Get(g.Prefab.Supplies,y.Instance.Game);t.setWorldPosition(this.node.getWorldPosition()),t.getComponent(v).InitCharacterCase(!1)}update(t){var e;if(f.IsGameOver)return;if(this.isDie)return void(this.rigidbody.linearVelocity=o.ZERO);const n=f.IsDoubleMode?f.Instance.playerNodes.filter((t=>t.active&&t.getComponent(p).HP>0)):[null==(e=f.Instance.player)?void 0:e.node].filter(Boolean);if(0===n.length)return;let i=1/0,c=null;for(const t of n){const e=t.worldPosition,n=s.distance(this.node.worldPosition,e),o=a.instance.raycast(this.node.worldPosition,e,r.Closest);o&&o.length>0&&o[0].collider.node.getComponent(l).group===g.Group.Player&&n<i&&(i=n,c=t)}if(!c)return this.StopFire(),void(this.needMove=!1);if(c.getWorldPosition().clone().subtract(this.node.getWorldPosition().clone()).length()>3e3)this.StopFire();else{if(this.results=a.instance.raycast(this.node.worldPosition,c.worldPosition,r.Closest),this.results&&this.results.length>=1&&this.results[0].collider.node.getComponent(l).group==g.Group.Player){const t=this.results[0].collider.node;M.set(t.getWorldPosition().clone().subtract(this.node.getWorldPosition().clone())),W.set(M),M.normalize(),this.dir.set(M.x,M.y),W.length()<900?(W.length()<500&&(this.needMove=!1),this.SetGunDir(h(M.x,M.y)),this.Fire()):this.needMove=!0}this.needMove?(this.PlayAni(0,m.Move),super.update(t)):(this.PlayAni(0,m.Idle),this.rigidbody.linearVelocity=o.ZERO)}}Fire(){if(!this.isFire){if(f.IsGameOver)return;this.isFire=!0,this.schedule(this.StartFire,.1)}}StartFire(){if(f.IsGameOver)return;if(!this.weapon)return;if(this.weapon.WeaponData.Ammo.Count<=0)return void this.Reload((()=>{this.scheduleOnce((()=>{this.weapon.WeaponData.Ammo.Count=this.weapon.WeaponData.Clip}),2*(c.random()+.3))}));this.PlayAni(1,m.Shoot);this.weapon.WeaponData.Ammo.Count-=1;const t=this.spine.findBone(this.weapon.Name);for(let e=0;e<1;e++){let e=C.Instance.Get(g.Prefab.Bullet,this.node);e.setWorldPosition(this.spineTrans.convertToWorldSpaceAR(M.set(t.worldX,t.worldY,0))),e.angle=this.character.scale.x<0?180-this.gunBone.rotation:this.gunBone.rotation,e.getComponent(D).Init(this,this.weapon,P.Clone(this.weapon.WeaponData.Ammo),null)}let e=C.Instance.Get(g.Prefab.BulletBlank,this.node);this.spineTrans.convertToWorldSpaceAR(M.set(t.worldX,t.worldY,0),M),e.setWorldPosition(M),e.getComponent(D).InitBlank(this,h(-5*this.character.scale.x,P.GetRandom(5,8)).multiplyScalar(.2))}StopFire(){this.isFire=!1,this.unschedule(this.StartFire),this.StopAni(1)}AddSpineListener(){this.spine.setEventListener(((t,e)=>{"Replenish"==e.data.name&&(this.reloadCallback&&this.reloadCallback(),this.reloadCallback=null),"die"==e.data.name&&this.InitDeadBox()}))}onBeginContact(t,e,i){if("Bullet"==e.node.name){const t=i.getWorldManifold();let o=C.Instance.Get(g.Prefab.Explosion,y.Instance.Game);o.setWorldPosition(n(t.points[0].x,t.points[0].y)),o.angle=d.radiansToDegrees(h(0,1).signAngle(t.normal.negative()))-90;let s=e.node.getComponent(D);s&&s.weapon&&(this.TakeDamage(s.weapon,s.ammo),this.scheduleOnce((()=>{C.Instance.Put(e.node)})))}}onEndContact(t,e,n){}onDestroy(){}})||I);e._RF.pop()}}}));

System.register("chunks:///_virtual/XGTS_CharacterSYD.ts",["cc","./XGTS_CharacterController.ts","./XGTS_Constant.ts","./XGTS_DataManager.ts","./XGTS_GameManager.ts","./XGTS_Data.ts","./XGTS_PoolManager.ts","./XGTS_Bullet.ts","./Tools.ts","./XGTS_HPBar.ts","./XGTS_LvManager.ts","./XGTS_Supplies.ts","./XGTS_AudioManager.ts"],(function(t){var e,i,n,o,s,a,r,l,h,d,c,u,p,g,m,S,T,f,G,D,C,P,y,v,I,M;return{setters:[function(t){e=t.cclegacy,i=t.v3,n=t.Contact2DType,o=t.Vec2,s=t.Vec3,a=t.PhysicsSystem2D,r=t.ERaycast2DType,l=t.RigidBody2D,h=t.v2,d=t.math,c=t.misc,u=t._decorator},function(t){p=t.default,g=t.PlayerAniState},function(t){m=t.XGTS_Constant},function(t){S=t.XGTS_DataManager},function(t){T=t.XGTS_GameManager},function(t){f=t.XGTS_ItemType},function(t){G=t.XGTS_PoolManager},function(t){D=t.default},function(t){C=t.Tools},function(t){P=t.default},function(t){y=t.XGTS_LvManager},function(t){v=t.default},function(t){I=t.XGTS_AudioManager,M=t.XGTS_Audio}],execute:function(){var _;e._RF.push({},"e8e694zF1RDxaPg24ecTJkV","XGTS_CharacterSYD",void 0);const{ccclass:A,property:X}=u,B=i(),W=i();t("default",A("XGTS_CharacterSYD")(_=class extends p{constructor(...t){super(...t),this.needMove=!1,this.lostTargetTime=3,this.lostTargetTimer=0,this.isEnemy=!0,this.ani=g.Idle}onLoad(){super.onLoad(),this.speed=12,this.MaxHP=100,this.HP=100,this.isDie=!1,this.collider.on(n.BEGIN_CONTACT,this.onBeginContact,this),this.collider.on(n.END_CONTACT,this.onEndContact,this);let t=G.Instance.Get(m.Prefab.HPBar,this.node);this.hpBar=t.getComponent(P),this.hpBar.Init(),this.SetAniMix(g.Idle,g.Move),this.SetAniMix(g.Move,g.Roll),this.SetAniMix(g.Idle,g.Roll),this.SetAniMix(g.Hit,g.Shoot),this.AddSpineListener()}start(){this.RefreshEquip()}RefreshEquip(){let t=S.ItemDataMap.get(f.Weapon).find((t=>"M249"==t.Name)),e=S.GetItemDataByType(f.Ammo,50851);e||console.error("找不到子弹数据 ID：51102"),t.WeaponData.Ammo=e,t.WeaponData.Ammo.Count=t.WeaponData.Clip,this.SetGun(t)}SetDir(t,e,i){super.SetDir(t,e,i)}SetGunDir(t){super.SetGunDir(t)}Die(){this.isDie||(this.isDie=!0,this.PlayAni(0,g.Dead,!1),y.Instance.matchData.KilledPE++)}InitDeadBox(){this.scheduleOnce((()=>{this.node.active=!1}));let t=G.Instance.Get(m.Prefab.Supplies,y.Instance.Game);t.setWorldPosition(this.node.getWorldPosition()),t.getComponent(v).InitCharacterCase(!0)}update(t){var e;if(T.IsGameOver)return;if(this.isDie)return void(this.rigidbody.linearVelocity=o.ZERO);const i=T.IsDoubleMode?T.Instance.playerNodes.filter((t=>t.active&&t.getComponent(p).HP>0)):[null==(e=T.Instance.player)?void 0:e.node].filter(Boolean);if(0===i.length)return;let n=1/0,d=null;for(const t of i){const e=t.worldPosition,i=s.distance(this.node.worldPosition,e),o=a.instance.raycast(this.node.worldPosition,e,r.Closest);o&&o.length>0&&o[0].collider.node.getComponent(l).group===m.Group.Player&&i<n&&(n=i,d=t)}if(!d)return this.StopFire(),void(this.needMove=!1);if(d.getWorldPosition().clone().subtract(this.node.getWorldPosition().clone()).length()>3e3||this.lostTargetTimer>this.lostTargetTime)return this.StopFire(),this.needMove=!1,void(this.lostTargetTimer=0);if(this.results=a.instance.raycast(this.node.worldPosition,d.worldPosition,r.Closest),this.results&&this.results.length>=1&&this.results[0].collider.node.getComponent(l).group==m.Group.Player){const t=this.results[0].collider.node;this.lostTargetTimer=0,B.set(t.getWorldPosition().clone().subtract(this.node.getWorldPosition().clone())),W.set(B),B.normalize(),this.dir.set(B.x,B.y),this.needMove=!0,W.length()<300?(this.needMove=!1,this.Fire()):W.length()<600?(this.ani=g.Roll,this.StopFire()):W.length()<900&&(this.ani=g.Move,this.Fire()),this.SetGunDir(h(B.x,B.y))}else this.lostTargetTimer+=t;this.needMove?(this.PlayAni(0,this.ani),super.update(t)):(this.PlayAni(0,g.Idle),this.rigidbody.linearVelocity=o.ZERO)}Fire(){if(!this.isFire){if(T.IsGameOver)return;this.isFire=!0,this.schedule(this.StartFire,.1)}}StartFire(){if(T.IsGameOver)return;if(!this.weapon)return;if(this.weapon.WeaponData.Ammo.Count<=0)return void this.Reload((()=>{this.scheduleOnce((()=>{this.weapon.WeaponData.Ammo.Count=this.weapon.WeaponData.Clip}),2*(d.random()+.3))}));this.PlayAni(1,g.Shoot),I.Instance.PlaySFX(M.Fire,.3);this.weapon.WeaponData.Ammo.Count-=1;const t=this.spine.findBone(this.weapon.Name);for(let e=0;e<1;e++){let e=G.Instance.Get(m.Prefab.Bullet,this.node);e.setWorldPosition(this.spineTrans.convertToWorldSpaceAR(B.set(t.worldX,t.worldY,0))),e.angle=this.character.scale.x<0?180-this.gunBone.rotation:this.gunBone.rotation,e.getComponent(D).Init(this,this.weapon,C.Clone(this.weapon.WeaponData.Ammo),null)}let e=G.Instance.Get(m.Prefab.BulletBlank,this.node);this.spineTrans.convertToWorldSpaceAR(B.set(t.worldX,t.worldY,0),B),e.setWorldPosition(B),e.getComponent(D).InitBlank(this,h(-5*this.character.scale.x,C.GetRandom(5,8)).multiplyScalar(.2))}StopFire(){this.isFire=!1,this.unschedule(this.StartFire),this.StopAni(1)}AddSpineListener(){this.spine.setEventListener(((t,e)=>{"Replenish"==e.data.name&&(this.reloadCallback&&this.reloadCallback(),this.reloadCallback=null),"die"==e.data.name&&this.InitDeadBox()}))}onBeginContact(t,e,n){if("Bullet"==e.node.name){const t=n.getWorldManifold();let o=G.Instance.Get(m.Prefab.Explosion,y.Instance.Game);o.setWorldPosition(i(t.points[0].x,t.points[0].y)),o.angle=c.radiansToDegrees(h(0,1).signAngle(t.normal.negative()))-90;let s=e.node.getComponent(D);s&&s.weapon&&(this.TakeDamage(s.weapon,s.ammo),this.scheduleOnce((()=>{G.Instance.Put(e.node)})))}}onEndContact(t,e,i){}onDestroy(){}})||_);e._RF.pop()}}}));

System.register("chunks:///_virtual/XGTS_ChestRigInventory.ts",["cc","./NodeUtil.ts","./XGTS_DataManager.ts","./XGTS_Constant.ts","./XGTS_Data.ts","./XGTS_GridCell.ts","./XGTS_PoolManager.ts","./Tools.ts","./XGTS_Inventory.ts","./BundleManager.ts","./GameManager.ts","./XGTS_GameManager.ts","./EventManager.ts","./XGTS_UIManager.ts","./UIManager.ts","./XGTS_InventoryGrid.ts","./XGTS_AudioManager.ts"],(function(t){var e,a,n,i,s,r,o,l,h,u,m,p,g,C,D,y,I,S,c,T,d,P;return{setters:[function(t){e=t.cclegacy,a=t.UITransform,n=t.Label,i=t.Sprite,s=t._decorator},function(t){r=t.default},function(t){o=t.XGTS_DataManager},function(t){l=t.XGTS_Constant},function(t){h=t.XGTS_ItemType},function(t){u=t.GridCellState},function(t){m=t.XGTS_PoolManager},function(t){p=t.Tools},function(t){g=t.default},function(t){C=t.BundleManager},function(t){D=t.GameManager},function(t){y=t.XGTS_GameManager},function(t){I=t.EventManager},function(t){S=t.XGTS_UIManager},function(t){c=t.UIManager},function(t){T=t.XGTS_InventoryGrid},function(t){d=t.XGTS_AudioManager,P=t.XGTS_Audio}],execute:function(){var R;e._RF.push({},"1ee465ppjxNO4oIWxYw5uN5","XGTS_ChestRigInventory",void 0);const{ccclass:G,property:f}=s;t("default",G("XGTS_ChestRigInventory")(R=class extends g{constructor(...t){super(...t),this.Item=null,this.ItemLabel=null,this.Icon=null,this.PutTip=null,this.ndTrans=null,this.inBox=!1,this.playerNum=0}onLoad(){this.Item=r.GetComponent("Item",this.node,a),this.ItemLabel=r.GetComponent("ItemLabel",this.node,n),this.ItemContent=r.GetNode("ItemContent",this.node),this.ItemContentTrans=this.ItemContent.getComponent(a),this.Icon=r.GetComponent("Icon",this.node,i),this.PutTip=r.GetComponent("PutTip",this.node,i),this.ndTrans=this.node.getComponent(a)}InitPlayerNum(t){this.playerNum=t}Refresh(){let t=o.PlayerDatas[this.playerNum].ChestRigData;if(t){let e=t.EquipData.CarryingSpace.width,a=t.EquipData.CarryingSpace.height,n=o.PlayerDatas[this.playerNum].ChestRigGrid;n.width!==e||n.height!==a?T.ResizeGrid(n,e,a):T.ClearGrid(n),this.ItemContentTrans.setContentSize(e*l.itemSize,a*l.itemSize),this.ndTrans.setContentSize(170+e*l.itemSize+20,150+a*l.itemSize),this.ItemLabel.string=t.Name,C.LoadSpriteFrame(D.GameData.DefaultBundle,`Res/Items/${t.ImageId}`).then((t=>{this.Icon.spriteFrame=t,y.SetImagePreferScale(this.Icon,130,130)})),super.Init(t.EquipData.ItemData,o.PlayerDatas[this.playerNum].ChestRigGrid)}else this.ClearItems(),this.Icon.spriteFrame=null,this.ItemContentTrans.setContentSize(0,0),this.ndTrans.setContentSize(170,250),this.ItemLabel.string="胸挂"}EquipChestRig(t){o.PlayerDatas[this.playerNum].EquipChestRig(t),this.Refresh()}CanEquipChestRig(t,e){if(this.Item.getBoundingBoxToWorld().contains(e)){this.inBox=!0;let e=t.Type==h.ChestRig&&null==o.PlayerDatas[this.playerNum].ChestRigData;return this.SetPutTipState(e?u.CanPut:u.CanntPut),e}return this.inBox&&(this.ClearPutTipState(),this.inBox=!1),!1}SetPutTipState(t){this.PutTip.color=p.GetColorFromHex(t)}ClearPutTipState(){this.PutTip.color=p.GetColorFromHex(u.None)}OnDragStart(t){o.PlayerDatas[this.playerNum].ChestRigData&&super.OnDragStart(t)}OnDragging(t,e){this.CanEquipChestRig(t.data,e),o.PlayerDatas[this.playerNum].ChestRigData&&super.OnDragging(t,e)}OnDragEnd(t,e){if(this.CanEquipChestRig(t.data,e))return this.ClearPutTipState(),t.RemoveItemFromAndResetLastInventory(),this.EquipChestRig(t.data),m.Instance.Put(t.node),o.SaveData(),void y.Instance.HideTipCells();this.ClearPutTipState(),o.PlayerDatas[this.playerNum].ChestRigData&&super.OnDragEnd(t,e)}OnButtonClick(t){switch(d.Instance.PlaySFX(P.ButtonClick),t.target.name){case"Item":if(!o.PlayerDatas[this.playerNum].ChestRigData)return;S.Instance.ShowPanel(l.Panel.ItemInfoPanel,[o.PlayerDatas[this.playerNum].ChestRigData,!0,t=>{if("Sell"==t&&(o.PlayerDatas[this.playerNum].ChestRigData&&0==o.PlayerDatas[this.playerNum].ChestRigData.EquipData.ItemData.length?(c.ShowTip(`出售成功，获得${o.PlayerDatas[this.playerNum].ChestRigData.Price.toLocaleString()}`),o.PlayerDatas[this.playerNum].Money+=o.PlayerDatas[this.playerNum].ChestRigData.Price,o.PlayerDatas[this.playerNum].ChestRigData=null,this.Refresh()):o.PlayerDatas[this.playerNum].ChestRigData.EquipData.ItemData.length>0&&c.ShowTip("出售失败，胸挂中还有物品")),"Takeoff"==t)if(o.PlayerDatas[this.playerNum].ChestRigData&&0==o.PlayerDatas[this.playerNum].ChestRigData.EquipData.ItemData.length){let t=0;y.IsDoubleMode&&(t=1),o.PlayerDatas[t].AddItemToInventory(o.PlayerDatas[this.playerNum].ChestRigData)?(I.Scene.emit(l.Event.REFRESH_INVENTORY_ITEMS),o.PlayerDatas[this.playerNum].ChestRigData=null):c.ShowTip("放入失败"),this.Refresh()}else o.PlayerDatas[this.playerNum].ChestRigData.EquipData.ItemData.length>0&&c.ShowTip("放入失败，胸挂中还有物品")}])}}})||R);e._RF.pop()}}}));

System.register("chunks:///_virtual/XGTS_CommonItem.ts",["cc","./NodeUtil.ts","./XGTS_Data.ts","./BundleManager.ts","./XGTS_GameManager.ts","./GameManager.ts","./XGTS_AudioManager.ts"],(function(t){var e,a,n,s,i,o,l,c,h,u,r,d,m,g,b;return{setters:[function(t){e=t.cclegacy,a=t.Component,n=t.Label,s=t.Sprite,i=t.RichText,o=t.Button,l=t._decorator},function(t){c=t.default},function(t){h=t.XGTS_ItemType,u=t.XGTS_ItemData},function(t){r=t.BundleManager},function(t){d=t.XGTS_GameManager},function(t){m=t.GameManager},function(t){g=t.XGTS_AudioManager,b=t.XGTS_Audio}],execute:function(){var G;e._RF.push({},"3921ftt/FtBRq8BSCDyMnI9","XGTS_CommonItem",void 0);const{ccclass:p,property:I}=l;t("default",p("XGTS_CommonItem")(G=class extends a{constructor(...t){super(...t),this.Background=null,this.Icon=null,this.NameLabel=null,this.DescLabel=null,this.Button=null,this.data=null,this.callback=null}onLoad(){this.NameLabel=c.GetComponent("NameLabel",this.node,n),this.Background=c.GetComponent("Background",this.node,s),this.Icon=c.GetComponent("Icon",this.node,s),this.DescLabel=c.GetComponent("DescLabel",this.node,i),this.Button=this.node.getComponent(o)}Refresh(){this.NameLabel.string=this.data.Name,r.LoadSpriteFrame(m.GameData.DefaultBundle,`Res/Items/${this.data.ImageId}`).then((t=>{this.Icon.spriteFrame=t,d.SetImagePreferScale(this.Icon,100,100)})),this.Background.color=d.GetColorHexByQuality(this.data.Quality),this.data.Type==h.Ammo?this.DescLabel.string=`${this.data.Count}`:u.IsConsumable(this.data.Type)?this.DescLabel.string=`${this.data.ConsumableData.Durability}`:this.DescLabel.string=this.data.Desc}InitDisplay(t){this.data=t,this.Button.enabled=!1,this.Icon.spriteFrame=null,this.Refresh()}SetDescStr(t){this.DescLabel.string=t}Init(t,e){this.data=t,this.callback=e,this.Button.enabled=!0,this.Refresh()}OnButtonClick(){g.Instance.PlaySFX(b.ButtonClick),this.callback&&this.callback(this.data)}})||G);e._RF.pop()}}}));

System.register("chunks:///_virtual/XGTS_Constant.ts",["cc"],(function(e){var n;return{setters:[function(e){n=e.cclegacy}],execute:function(){n._RF.push({},"b3146/ICf1Emb0tHWrKbGFk","XGTS_Constant",void 0);e("XGTS_Quality",function(e){return e[e.None=0]="None",e[e.Common=1]="Common",e[e.Uncommon=2]="Uncommon",e[e.Rare=3]="Rare",e[e.Superior=4]="Superior",e[e.Legendary=5]="Legendary",e[e.Mythic=6]="Mythic",e}({})),e("XGTS_QualityColorHex",function(e){return e.None="#FFFFFF00",e.Common="#FFFFFF3C",e.Uncommon="#2FA1703C",e.Rare="#276ABF3C",e.Superior="#7430B93C",e.Epic="#cd23b2",e.Legendary="#E09A1A3C",e.Mythic="#F03A393C",e}({}));class a{}e("XGTS_Constant",a),a.SearchTime=[0,.2,.5,1,1.5,2,2.5],a.itemSize=100,a.MapInfo={"零号大坝":{Name:"零号大坝",EntryCosts:[0,112500],LevelRequirements:[0,12],TimeLimit:"25:00",MapName:"XGTS_Lv_1"},"长弓溪谷":{Name:"长弓溪谷",EntryCosts:[0,112500],LevelRequirements:[0,12],TimeLimit:"25:00",MapName:"XGTS_Lv_2"},"烽火荣都":{Name:"烽火荣都",EntryCosts:[0,212500],LevelRequirements:[0,12],TimeLimit:"30:00",MapName:"XGTS_Lv_3"},"校长办公室":{Name:"校长办公室",EntryCosts:[0,35e4],LevelRequirements:[0,12],TimeLimit:"30:00",MapName:"XGTS_Lv_4"},"宿舍":{Name:"宿舍",EntryCosts:[0,18e4],LevelRequirements:[0,12],TimeLimit:"30:00",MapName:"XGTS_Lv_5"},"体育场":{Name:"体育场",EntryCosts:[0,12e4],LevelRequirements:[0,12],TimeLimit:"30:00",MapName:"XGTS_Lv_6"},"电脑室":{Name:"电脑室",EntryCosts:[0,45e4],LevelRequirements:[0,12],TimeLimit:"30:00",MapName:"XGTS_Lv_7"}},a.Audio={BG:"BG",BG2:"BG2",Equip:"Equip",Unequip:"Unequip",Fire:"Fire",GetMoney:"GetMoney",Reload:"Reload",ButtonClick:"ButtonClick"},a.WorkbenchName=["","武器台","护甲台","子弹台","药品台"],a.Scene={Main:"Main"},a.Path={Tip:"Prefabs/UI/Tip",Broadcast:"Prefabs/UI/Broadcast",FloatingText:"Prefabs/UI/FloatingText"},a.Panel={InventoryPanel:"Panel/InventoryPanel",InventoryPanel_Double:"Panel/InventoryPanel_Double",InventoryPanel_Left:"Panel/InventoryPanel_Left",InventoryPanel_Right:"Panel/InventoryPanel_Right",ItemInfoPanel:"Panel/ItemInfoPanel",ShopPanel:"Panel/ShopPanel",SelectSafeBoxPanel:"Panel/SelectSafeBoxPanel",SelectMapPanel:"Panel/SelectMapPanel",SafeBoxPanel:"Panel/SafeBoxPanel",GameOverPanel:"Panel/GameOverPanel",UpgradePanel:"Panel/UpgradePanel",OutputPanel:"Panel/OutputPanel",SellPanel:"Panel/SellPanel",WorkbenchPanel:"Panel/WorkbenchPanel",RewardPanel:"Panel/RewardPanel",SkinShopPanel:"Panel/SkinShopPanel",AccessoriesPanel:"Panel/AccessoriesPanel",TutorialPanel:"Panel/TutorialPanel",ExitPanel:"Panel/ExitPanel"},a.Prefab={Item:"Item",CommonItem:"CommonItem",SkinItem:"SkinItem",GridCell:"GridCell",Bullet:"Bullet",BulletBlank:"BulletBlank",Missile:"Missile",MissileExplosion:"MissileExplosion",Explosion:"Explosion",GunFire:"GunFire",HPBar:"HPBar",Supplies:"Supplies",OutputItem:"OutputItem",FloatingText:"FloatingText"},a.Key={FirstInGame:"FirstInGame",isHavePassTutorial:"isHavePassTutorial",Money:"Money",EnergyBattery:"EnergyBattery",KCQB:"KCQB",SkinPiece:"SkinPiece",HuiZhangPiece:"HuiZhangPiece",EXP:"EXP",RankPoint:"RankPoint",Items:"Items",PlayerData:"PlayerData",PlayerDatas:"PlayerDatas",AgreePolicy:"AgreePoliaacy",GameData:"GameData",UnlockSeason:"Season",FreeReward:"FreeReward",AchievementTimes:"AchievementTimes",FirstOpenSafeBox:"FirstOpenSafeBox",FirstPutInventory:"FirstPutInventory"},a.Event={REFRESH_MONEY:"REFRESH_MONEY",REFRESH_INVENTORY_ITEMS:"REFRESH_INVENTORY_ITEMS",REFRESH_BACKPACK_ITEMS:"REFRESH_BACKPACK_ITEMS",REFRESH_CONTENT_SIZE:"REFRESH_CONTENT_SIZE",REFRESH_EUIP:"REFRESH_EUIP",REFRESH_EUIP_ITEMS:"REFRESH_INVENTORY_ITEMS",REFRESH_GAME_ITEM_UI:"REFRESH_GAME_ITEM_UI",REFRESH_WEAON_CONTENT:"REFRESH_WEAON_CONTENT",MOVEMENT:"MOVEMENT",MOVEMENT_STOP:"MOVEMENT_STOP",SET_ATTACK_DIR:"SET_ATTACK_DIR",FIRE_START:"FIRE_START",FIRE_STOP:"FIRE_STOP",SHOW_INTERACT_BUTTON:"SHOW_INTERACT_BUTTON",SHOW_EVACUATION:"SHOW_EVACUATION",HIDE_EVACUATION:"HIDE_EVACUATION",SHOW_TUTORIAL:"SHOW_TUTORIAL",HIDE_TUTORIAL:"HIDE_TUTORIAL",ON_ITEM_DRAGSTART:"ON_ITEM_DRAGSTART",ON_ITEM_DRAGGING:"ON_ITEM_DRAGGING",ON_ITEM_DRAGEND:"ON_ITEM_DRAGEND",CHANGE_DOUBLE_MODE:"CHANGE_DOUBLE_MODE",CHANGE_SINGLE_MODE:"CHANGE_SINGLE_MODE",MOVEMENT_1:"MOVEMENT_1",MOVEMENT_2:"MOVEMENT_2",MOVEMENT_STOP_1:"MOVEMENT_STOP_1",MOVEMENT_STOP_2:"MOVEMENT_STOP_2",RESTRICT_PLAYER_MOVEMENT:"RESTRICT_PLAYER_MOVEMENT",SHOW_INTERACT_BUTTON_1:"SHOW_INTERACT_BUTTON_1",SHOW_INTERACT_BUTTON_2:"SHOW_INTERACT_BUTTON_2",REFRESH_EUIP_1:"REFRESH_EUIP_1",REFRESH_EUIP_2:"REFRESH_EUIP_2",RESET_CAMERA:"RESET_CAMERA"},a.Group={Player:2,Enemy:4,Bullet:8,Obstacle:16,Interact:32},a.FirstOpenSafeBox=["勋章","摄影机"],a.FirstOpenWeaponBox=["沙漠之鹰","稳定型芯片A"],a.Showcases=["摄影机","显卡","军用无人机","军用电台","笔记本电脑","刀片服务器","高速磁盘阵列","G.T.I卫星通信天线","飞行记录仪","军用控制终端","曼德尔超算单元","便携军用雷达","军用信息终端","绝密服务器","云存储阵列","呼吸机","自动体外除颤器","复苏呼吸机","医疗机械人","强化碳纤维板","军用炮弹","奥莉薇娅香槟","名贵机械表","扫拖一体机器人","强力吸尘器","高级咖啡豆","黄金瞪羚","克劳迪乌斯半身像","棘龙爪化石","滑膛枪展品","万足金条","赛伊德的怀表","主战坦克模型","步战车模型","万金泪冠","“天圆地方”","“纵横”","雷斯的留声机","实验数据","量子存储","火箭燃料","非洲之心","装甲车电池","动力电池组"],n._RF.pop()}}}));

System.register("chunks:///_virtual/XGTS_ContainerInventory.ts",["cc","./NodeUtil.ts","./XGTS_Constant.ts","./XGTS_Data.ts","./XGTS_Inventory.ts"],(function(t){var n,e,i,o,r,s,a,u;return{setters:[function(t){n=t.cclegacy,e=t.Label,i=t.UITransform,o=t._decorator},function(t){r=t.default},function(t){s=t.XGTS_Constant},function(t){a=t.XGTS_ContainerType},function(t){u=t.default}],execute:function(){var c;n._RF.push({},"01b48jCmBdEWp0JGmTnYXp7","XGTS_ContainerInventory",void 0);const{ccclass:d,property:h}=o;t("default",d("XGTS_ContainerInventory")(c=class extends u{constructor(...t){super(...t),this.BarLabel=null,this.ndTrans=null,this.inBox=!1,this.type=a.BirdNest}onLoad(){this.BarLabel=r.GetComponent("BarLabel",this.node,e),this.ItemContent=r.GetNode("ItemContent",this.node),this.ItemContentTrans=this.ItemContent.getComponent(i),this.ndTrans=this.node.getComponent(i)}InitContainer(t){let n=t.Size.width,e=t.Size.height;this.ItemContentTrans.setContentSize(n*s.itemSize,e*s.itemSize),this.ndTrans.setContentSize(40+n*s.itemSize,120+e*s.itemSize),this.BarLabel.string=t.Name,super.InitLootContainer(t.ItemData,n,e)}OnDragStart(t){super.OnDragStart(t)}OnDragging(t,n){super.OnDragging(t,n)}OnDragEnd(t,n){super.OnDragEnd(t,n)}})||c);n._RF.pop()}}}));

System.register("chunks:///_virtual/XGTS_Data.ts",["cc","./XGTS_DataManager.ts","./Tools.ts"],(function(t){var i,e,s;return{setters:[function(t){i=t.cclegacy},function(t){e=t.XGTS_DataManager},function(t){s=t.Tools}],execute:function(){i._RF.push({},"d31f7LONQVEmq9MP96ktczO","XGTS_Data",void 0);let a=t("XGTS_ItemType",function(t){return t[t.None=0]="None",t[t.Helmet=1]="Helmet",t[t.BodyArmor=2]="BodyArmor",t[t.Weapon=3]="Weapon",t[t.Accessory=4]="Accessory",t[t.Ammo=5]="Ammo",t[t.ChestRig=6]="ChestRig",t[t.Backpack=7]="Backpack",t[t.ArmorItem=8]="ArmorItem",t[t.MedicalItem=9]="MedicalItem",t[t.Electronic=10]="Electronic",t[t.Medical=11]="Medical",t[t.ToolMaterial=12]="ToolMaterial",t[t.FurnitureItem=13]="FurnitureItem",t[t.CraftCollectible=14]="CraftCollectible",t[t.IntelDocument=15]="IntelDocument",t[t.EnergyFuel=16]="EnergyFuel",t}({})),r=t("XGTS_WeaponType",function(t){return t[t.MeleeWeapon=0]="MeleeWeapon",t[t.Pistol=1]="Pistol",t[t.AssaultRifle=2]="AssaultRifle",t[t.SubmachineGun=3]="SubmachineGun",t[t.MarksmanRifle=4]="MarksmanRifle",t[t.BoltActionRifle=5]="BoltActionRifle",t[t.LightMachineGun=6]="LightMachineGun",t[t.Shotgun=7]="Shotgun",t}({}));t("XGTS_CollectibleType",function(t){return t.Electronic="电子物品",t.Medical="医疗道具",t.ToolMaterial="工具材料",t.FurnitureItem="家具物品",t.CraftCollectible="工艺藏品",t.IntelDocument="资料情报",t.EnergyFuel="能源燃料",t}({})),t("XGTS_ContainerType",function(t){return t[t.AviationCrate=0]="AviationCrate",t[t.DeliveryBox=1]="DeliveryBox",t[t.BirdNest=2]="BirdNest",t[t.SafeBox=3]="SafeBox",t[t.ComputerCase=4]="ComputerCase",t[t.WeaponCase=5]="WeaponCase",t[t.CharactorCase=6]="CharactorCase",t}({})),t("XGTS_WorkbenchType",function(t){return t[t.Weapon=1]="Weapon",t[t.Armor=2]="Armor",t[t.Ammo=3]="Ammo",t[t.Medical=4]="Medical",t}({}));t("XGTS_ItemData",class{constructor(t,i,e,s,r,n,h,o,u,l){this.Type=a.None,this.Count=1,this.Point={x:0,y:0},this.Size={width:0,height:0},this.Rotated=!1,this.WeaponData=null,this.EquipData=null,this.AmmoData=null,this.ConsumableData=null,this.AccessoryData=null,this.Searched=!0,this.ID=t,this.type=i,this.Name=e,this.Price=s,this.Quality=r,this.size=n,this.Weight=h,this.ImageId=o,this.Desc=u,this.NotShow=l,this.Type=i,this.Size={width:Number(n.split("_")[0]),height:Number(n.split("_")[1])},i==a.Ammo&&(this.Count=60)}static IsGun(t){return t==a.Weapon}static IsEquip(t){return t==a.Helmet||t==a.BodyArmor||t==a.ChestRig||t==a.Backpack}static IsConsumable(t){return t==a.MedicalItem||t==a.ArmorItem}static IsCollection(t){return t==a.Electronic||t==a.Medical||t==a.ToolMaterial||t==a.FurnitureItem||t==a.CraftCollectible||t==a.IntelDocument||t==a.EnergyFuel}});t("XGTS_WeaponData",class{constructor(t,i,e,a,r,n,h,o,u,l,c,m,p,y,D){this.Required=[],this.Quantity=[],this.Ammo=null,this.Accessory_0=null,this.Accessory_1=null,this.Accessory_2=null,this.ID=t,this.Type=i,this.Quality=e,this.Name=a,this.AmmoType=r,this.PriceFluctuation=n,this.Damage=h,this.Precision=o,this.Recoil=u,this.Clip=l,this.FiringRate=c,this.ReloadDuration=m,this.required=p,this.quantity=y,this.Duration=D,s.IsEmptyStr(p)||(this.Required=p.trim().split(",").map((t=>Number(t)))),s.IsEmptyStr(y)||(this.Quantity=y.trim().split(",").map((t=>Number(t))))}get Data(){return e.ItemDataMap.get(a.Weapon).find((t=>t.Name==this.Name))}static IsMain(t){return t==r.AssaultRifle||t==r.SubmachineGun||t==r.MarksmanRifle||t==r.BoltActionRifle||t==r.LightMachineGun||t==r.Shotgun}static IsPistol(t){return t==r.Pistol}static IsMelee(t){return t==r.MeleeWeapon}});t("XGTS_AmmoData",class{constructor(t,i,e,a,r,n,h,o,u,l,c,m){this.Required=[],this.Quantity=[],this.ID=t,this.Type=i,this.Name=e,this.Lv1Damage=a,this.Lv2Damage=r,this.Lv3Damage=n,this.Lv4Damage=h,this.Lv5Damage=o,this.Lv6Damage=u,this.required=l,this.quantity=c,this.Duration=m,s.IsEmptyStr(l)||(this.Required=l.toString().trim().split(",").map((t=>Number(t)))),s.IsEmptyStr(l)||(this.Quantity=c.toString().trim().split(",").map((t=>Number(t))))}static GetDamage(t,i){switch(i){case 1:return t.Lv1Damage;case 2:return t.Lv2Damage;case 3:return t.Lv3Damage;case 4:return t.Lv4Damage;case 5:return t.Lv5Damage}}});t("XGTS_EquipData",class{constructor(t,i,e,a,r,n,h,o){this.Required=[],this.Quantity=[],this.MaxDurability=0,this.CarryingSpace={width:0,height:0},this.Grid=null,this.ItemData=[],this.ID=t,this.Name=i,this.Durability=e,this.HpMaxLoss=a,this.required=n,this.quantity=h,this.Duration=o,this.CarryingSpace={width:Number(r.split("_")[0]),height:Number(r.split("_")[1])},this.MaxDurability=this.Durability,s.IsEmptyStr(n)||(this.Required=n.toString().trim().split(",").map((t=>Number(t)))),s.IsEmptyStr(n)||(this.Quantity=h.toString().trim().split(",").map((t=>Number(t))))}});t("XGTS_ConsumableData",class{constructor(t,i,e,a,r,n,h,o,u){this.Required=[],this.Quantity=[],this.ID=t,this.Name=i,this.ReplySpeed=e,this.Durability=a,this.ReplyCoefficient=r,this.CostTime=n,this.required=h,this.quantity=o,this.Duration=u,s.IsEmptyStr(h)||(this.Required=h.toString().trim().split(",").map((t=>Number(t)))),s.IsEmptyStr(h)||(this.Quantity=o.toString().trim().split(",").map((t=>Number(t))))}});t("XGTS_AccessoryData",class{constructor(t,i,e,s,a,r,n,h,o){this.ID=t,this.SubID=i,this.Name=e,this.AccessoryType=s,this.RecoilUp=a,this.RecoilDown=r,this.ReloadingSpeedUp=n,this.ReloadingSpeedDown=h,this.Magnificationlens=o}});t("XGTS_SafeBoxData",class{constructor(t){this.CarryingSpace={width:0,height:0},this.ItemData=[],this.CarryingSpace={width:Number(t.split("_")[0]),height:Number(t.split("_")[1])}}});t("XGTS_ContainerData",class{constructor(t,i,e){this.Size={width:0,height:0},this.ItemData=[],this.Type=t,this.Name=i,this.Size={width:Number(e.split("_")[0]),height:Number(e.split("_")[1])}}});t("XGTS_ContainerLootData",class{constructor(t,i,e,s){this.ID=t,this.Type=i,this.Name=e,this.Probability=s}});t("XGTS_WorkbenchData",class{constructor(t,i,e,a,r,n,h){this.Requirements=[],this.QuantityDemanded=[],this.Making=[],this.Type=t,this.Lv=i,this.Cost=e,this.CostTime=a,this.requirements=r,this.quantityDemanded=n,this.making=h,s.IsEmptyStr(r)||(this.Requirements=r.toString().split(",").map((t=>Number(t)))),s.IsEmptyStr(n)||(this.QuantityDemanded=n.toString().split(",").map((t=>Number(t)))),s.IsEmptyStr(h)||(this.Making=h.toString().split(",").map((t=>Number(t))))}});t("XGTS_MatchData",class{constructor(t,i,e,s,a,r){this.MapName=t,this.EvacuationSite=i,this.Time=e,this.Reward=s,this.KilledPE=a,this.KilledPC=r}});t("XGTS_PrizePoolData",class{constructor(t,i,e,s){this.ID=t,this.Name=i,this.Probability=e,this.AwardType=s}});t("XGTS_SkinData",class{constructor(t,i,e){this.ID=t,this.Name=i,this.GunName=e}}),i._RF.pop()}}}));

System.register("chunks:///_virtual/XGTS_DataManager.ts",["cc","./PrefsManager.ts","./BundleManager.ts","./GameManager.ts","./XGTS_Data.ts","./XGTS_Constant.ts","./XGTS_PlayerData.ts","./Tools.ts","./XGTS_InventoryGrid.ts"],(function(e){var a,t,o,n,i,r,s,l,D,m,c,p,u,y,h,d,f,I,g,S,C;return{setters:[function(e){a=e.cclegacy},function(e){t=e.default},function(e){o=e.BundleManager},function(e){n=e.GameManager},function(e){i=e.XGTS_ContainerType,r=e.XGTS_ContainerLootData,s=e.XGTS_WeaponData,l=e.XGTS_AmmoData,D=e.XGTS_EquipData,m=e.XGTS_ConsumableData,c=e.XGTS_AccessoryData,p=e.XGTS_ContainerData,u=e.XGTS_WorkbenchData,y=e.XGTS_SkinData,h=e.XGTS_PrizePoolData,d=e.XGTS_ItemData,f=e.XGTS_ItemType},function(e){I=e.XGTS_Constant},function(e){g=e.XGTS_PlayerData},function(e){S=e.Tools},function(e){C=e.XGTS_InventoryGrid}],execute:function(){a._RF.push({},"c705f1b4-4948-4bb7-b1d2-afc2bc7a6a7g","XGTS_DataManager",void 0);class G{static LoadData(){if(G.ItemDataMap=new Map,G.ContainerLootMap=new Map,G.WeaponData=[],G.AmmoData=[],G.EquipData=[],G.ConsumableData=[],G.AccessoryData=[],G.ContainerData=[],G.WorkbenchData=new Map,G.SkinData=[],G.PrizePoolData=[],t.GetItem(I.Key.PlayerDatas)){let e=JSON.parse(t.GetItem(I.Key.PlayerDatas));this.PlayerDatas=[];for(let a=0;a<e.length;a++)this.PlayerDatas[a]=new g(e[a].Money,e[a].InventoryItemData,e[a].Weapon_Primary,e[a].Weapon_Secondary,e[a].Weapon_Pistol,e[a].Weapon_Melee,e[a].Weapon_Helmet,e[a].Weapon_BodyArmor,e[a].PocketData,e[a].ChestRigData,e[a].BackpackData,e[a].SafeBox,e[a].ShowcaseData)}else this.PlayerDatas=[],this.PlayerDatas[0]=new g,this.PlayerDatas[1]=new g,this.PlayerDatas[2]=new g;return console.log("[玩家数据]:",this.PlayerDatas),new Promise(((e,a)=>{Promise.all([o.LoadJson(n.GameData.DefaultBundle,"ContainerLoot"),o.LoadJson(n.GameData.DefaultBundle,"Weapons"),o.LoadJson(n.GameData.DefaultBundle,"Ammo"),o.LoadJson(n.GameData.DefaultBundle,"Equips"),o.LoadJson(n.GameData.DefaultBundle,"Consumable"),o.LoadJson(n.GameData.DefaultBundle,"GunEquipment"),o.LoadJson(n.GameData.DefaultBundle,"Containers"),o.LoadJson(n.GameData.DefaultBundle,"Workbench"),o.LoadJson(n.GameData.DefaultBundle,"skin"),o.LoadJson(n.GameData.DefaultBundle,"PrizePool")]).then((([e,a,t,d,f,I,g,S,C,T])=>{let _=e.json;G.ContainerLootMap.set(i.AviationCrate,[]),G.ContainerLootMap.set(i.DeliveryBox,[]),G.ContainerLootMap.set(i.BirdNest,[]),G.ContainerLootMap.set(i.SafeBox,[]),G.ContainerLootMap.set(i.ComputerCase,[]),G.ContainerLootMap.set(i.WeaponCase,[]);for(let e=0;e<_.武器箱.length;e++){const a=_.武器箱[e];G.ContainerLootMap.get(i.WeaponCase).push(new r(a.ID,a.Type,a.Name,a.Probability))}for(let e=0;e<_.机箱.length;e++){const a=_.机箱[e];G.ContainerLootMap.get(i.ComputerCase).push(new r(a.ID,a.Type,a.Name,a.Probability))}for(let e=0;e<_.保险箱.length;e++){const a=_.保险箱[e];G.ContainerLootMap.get(i.SafeBox).push(new r(a.ID,a.Type,a.Name,a.Probability))}for(let e=0;e<_.鸟窝.length;e++){const a=_.鸟窝[e];G.ContainerLootMap.get(i.BirdNest).push(new r(a.ID,a.Type,a.Name,a.Probability))}for(let e=0;e<_.快递盒.length;e++){const a=_.快递盒[e];G.ContainerLootMap.get(i.DeliveryBox).push(new r(a.ID,a.Type,a.Name,a.Probability))}for(let e=0;e<_.航空箱.length;e++){const a=_.航空箱[e];G.ContainerLootMap.get(i.AviationCrate).push(new r(a.ID,a.Type,a.Name,a.Probability))}console.log("ContainerLootMap",G.ContainerLootMap);let B=a.json;for(let e=0;e<B.length;e++){const a=B[e];G.WeaponData.push(new s(a.ID,a.Type,a.Quality,a.Name,a.AmmoType,a.PriceFluctuation,a.Damage,a.Precision,a.Recoil,a.Clip,a.FiringRate,a.ReloadDuration,a.Required,a.quantity,a.Duration))}console.log("WeaponData",G.WeaponData);let M=t.json;for(let e=0;e<M.length;e++){const a=M[e];G.AmmoData.push(new l(a.ID,a.Type,a.Name,a.Lv1Damage,a.Lv2Damage,a.Lv3Damage,a.Lv4Damage,a.Lv5Damage,a.Lv6Damage,a.Required,a.quantity,a.Duration))}console.log("AmmoData",G.AmmoData);let P=d.json;for(let e=0;e<P.length;e++){const a=P[e];G.EquipData.push(new D(a.ID,a.Name,a.Durability,a.HpMaxLoss,a.CarryingSpace,a.Required,a.quantity,a.Duration))}console.log("EquipData",G.EquipData);let b=f.json;for(let e=0;e<b.length;e++){const a=b[e];G.ConsumableData.push(new m(a.ID,a.name,a.replySpeed,a.Durability,a.replyCoefficient,a.costTime,a.Required,a.quantity,a.Duration))}console.log("ConsumableData",G.ConsumableData);let k=I.json;for(let e=0;e<k.length;e++){const a=k[e];G.AccessoryData.push(new c(a.ID,a.SubID,a.Name,a.AccessoryType,a.RecoilUp,a.RecoilDown,a.ReloadingSpeedUp,a.ReloadingSpeedDown,a.Magnificationlens))}console.log("AccessoryData",G.AccessoryData);let A=g.json;for(let e=0;e<A.length;e++){const a=A[e];G.ContainerData.push(new p(a.Type,a.Name,a.Size))}console.log("ContainerData",G.ContainerData);let L=S.json;for(let e=0;e<L.length;e++){const a=L[e];G.WorkbenchData.has(a.Type)||G.WorkbenchData.set(a.Type,[]),G.WorkbenchData.get(a.Type).push(new u(a.Type,a.Lv,a.Cost,a.CostTime,a.Requirements,a.QuantityDemanded,a.Making))}console.log("WorkbenchData",G.WorkbenchData);let w=C.json;for(let e=0;e<w.length;e++){const a=w[e];G.SkinData.push(new y(a.ID,a.Name,a.GunName))}console.log("SkinData",G.SkinData);let N=T.json;for(let e=0;e<N.length;e++){const a=N[e];G.PrizePoolData.push(new h(a.ID,a.Name,a.Probability,a.AwardType))}return console.log("PrizePoolData",G.PrizePoolData),o.LoadJson(n.GameData.DefaultBundle,"Items")})).then((a=>{let t=a.json;for(let e=0;e<t.length;e++){const a=t[e];G.ItemDataMap.has(a.Type)||G.ItemDataMap.set(a.Type,[]);let o=new d(a.ID,a.Type,a.Name,a.Price,a.Quality,a.Size,a.Weight,a.ImageId,a.Desc,a.NotShow);o.Type==f.Weapon&&(o.WeaponData=S.Clone(G.WeaponData.find((e=>e.ID==o.ID)))),o.Type==f.Accessory&&(o.AccessoryData=S.Clone(G.AccessoryData.find((e=>e.ID==o.ID)))),o.Type==f.Ammo&&(o.AmmoData=S.Clone(G.AmmoData.find((e=>e.ID==o.ID)))),d.IsEquip(o.Type)&&(o.EquipData=S.Clone(G.EquipData.find((e=>e.ID==o.ID)))),d.IsConsumable(o.Type)&&(o.ConsumableData=S.Clone(G.ConsumableData.find((e=>e.ID==o.ID)))),-1!==I.Showcases.findIndex((e=>e==o.Name))&&G.ShowcaseData.push(o),G.ItemDataMap.get(a.Type).push(o)}console.log("ShowcaseData",G.ShowcaseData),console.log("ItemData",G.ItemDataMap),e([])})).catch((e=>{console.error("加载数据出错",e),a(e)}))}))}static GetItemDataByType(e,a,t=!0){if(!this.ItemDataMap.has(e))return console.error(`Item 表中没有该物品 Type：${e}`),null;let o=G.ItemDataMap.get(e).find((e=>e.ID==a));return o||console.error(`Item 表中没有该物品 ID：${a}`),t?S.Clone(o):o}static GetItemDataByTypeName(e,a,t=!0){if(!this.ItemDataMap.has(e))return console.error(`Item 表中没有该物品 Type：${e}`),null;let o=G.ItemDataMap.get(e).find((e=>e.Name==a));return o||console.error(`Item 表中没有该物品 Name：${a}`),t?S.Clone(o):o}static GetItemDataByName(e,a=!0){let t=null;for(const[o,n]of G.ItemDataMap)if(t=n.find((a=>a.Name==e)),t)return a&&(t=S.Clone(t)),t;return t||console.error(`Item 表中没有该物品 Name：${e}`),null}static GetItemDataByID(e){let a=null;for(const[t,o]of G.ItemDataMap)if(a=o.find((a=>a.ID==e)),a)return a;return a||console.error(`Item 表中没有该物品 ID：${e}`),null}static CheckTable(){for(const e of this.ContainerLootMap.keys())this.ContainerLootMap.get(e).forEach((e=>{G.ItemDataMap.get(e.Type).find((e=>e.ID==e.ID))||console.error("Item表中无法找到ContainerLoot表中的：",e.Name)}))}static CloneItemData(e){return S.Clone(e)}static GetRandomAmmoByType(e){let a=G.AmmoData.filter((a=>a.Type==e)),t=G.ItemDataMap.get(f.Ammo).find((e=>e.ID==a[Math.floor(Math.random()*a.length)].ID));return G.CloneItemData(t)}static SetDefaultEquip(e){e.Weapon_Helmet=this.GetItemDataByTypeName(f.Helmet,"老式钢盔"),e.Weapon_BodyArmor=this.GetItemDataByTypeName(f.BodyArmor,"轻型防弹衣"),e.EquipChestRig(this.GetItemDataByTypeName(f.ChestRig,"G01战术弹挂")),e.EquipBackpack(this.GetItemDataByTypeName(f.Backpack,"雨林猎手背包")),e.Weapon_Primary=this.GetItemDataByTypeName(f.Weapon,"M4A1"),e.Weapon_Primary.WeaponData.Ammo=this.GetItemDataByType(f.Ammo,50833);let a=[];for(let e=0;e<5;e++)a.push(this.GetItemDataByType(f.Ammo,50833));let t=this.GetItemDataByTypeName(f.MedicalItem,"户外医疗箱");this.FillContainer(e.ChestRigGrid,a,e.ChestRigData.EquipData.ItemData),this.FillContainer(e.BackpackGrid,[t],e.BackpackData.EquipData.ItemData),console.error(S.Clone(e.BackpackGrid))}static FillContainer(e,a,t){let o=e.width*e.height,n=[];console.error(1,S.Clone(e));for(let t=0;t<a.length;t++){let i=a[t];for(let a=0;a<o;a++){let t=a%e.width,o=Math.floor(a/e.width);if(0==e.grid[o][t]&&C.CanPlaceItem(e,t,o,i.Size.width,i.Size.height)){C.PlaceItem(e,t,o,i.Size.width,i.Size.height),i.Point.x=t,i.Point.y=o,n.push(i);break}}}console.error(2,S.Clone(e)),a=n,t.push(...n)}static GetGunUseSkin(e,a=""){return t.GetString(`Gun_Skin_Use_${e}`,a)}static SetGunUseSkin(e,a){return t.SetString(`Gun_Skin_Use_${e}`,a)}static GetGunSkinUnlock(e){return t.GetBool(`Gun_Skin_Unlock_${e}`)}static SetGunSkinUnlock(e,a=!0){return t.SetBool(`Gun_Skin_Unlock_${e}`,a)}static GetSafeBoxUnlock(e){switch(e){case"SafeBox_1":return t.GetNumber(`SafeBox_AdTimes_${e}`,0)>=3;case"SafeBox_2":return t.GetNumber(`SafeBox_AdTimes_${e}`,0)>=6;case"SafeBox_3":return t.GetNumber(`SafeBox_AdTimes_${e}`,0)>=9}return!0}static GetSafeBoxAdTimes(e){return t.GetNumber(`SafeBox_AdTimes_${e}`,0)}static SetSafeBoxAdTimes(e,a){return t.SetNumber(`SafeBox_AdTimes_${e}`,a)}static SaveData(){console.log("存储数据",I.Key.PlayerDatas),t.SetItem(I.Key.PlayerDatas,JSON.stringify(this.PlayerDatas))}}e("XGTS_DataManager",G),G.Names=[],G.ItemDataMap=void 0,G.ContainerLootMap=void 0,G.EquipData=void 0,G.WeaponData=void 0,G.ConsumableData=void 0,G.AccessoryData=void 0,G.AmmoData=void 0,G.ContainerData=void 0,G.PlayerData=void 0,G.PlayerDatas=void 0,G.ShowcaseData=[],G.WorkbenchData=void 0,G.SkinData=void 0,G.PrizePoolData=void 0,a._RF.pop()}}}));

System.register("chunks:///_virtual/XGTS_Evacuation.ts",["./rollupPluginModLoBabelHelpers.js","cc","./XGTS_Constant.ts","./EventManager.ts","./XGTS_LvManager.ts","./XGTS_DataManager.ts"],(function(t){var n,e,a,o,i,c,r,s,l,u,p,C;return{setters:[function(t){n=t.applyDecoratedDescriptor,e=t.initializerDefineProperty},function(t){a=t.cclegacy,o=t.CCString,i=t._decorator,c=t.Component,r=t.BoxCollider2D,s=t.Contact2DType},function(t){l=t.XGTS_Constant},function(t){u=t.EventManager},function(t){p=t.XGTS_LvManager},function(t){C=t.XGTS_DataManager}],execute:function(){var E,h,S,T,f;a._RF.push({},"0f9c1xiSf5AioPi8qWkSpv/","XGTS_Evacuation",void 0);const{ccclass:_,property:d}=i;t("default",(E=_("XGTS_Evacuation"),h=d(o),E((f=n((T=class extends c{constructor(...t){super(...t),this.collider=null,e(this,"EvacuationSite",f,this)}onLoad(){this.collider=this.node.getComponent(r)}onBeginContact(t,n,e){if(n.group==l.Group.Player){p.Instance.matchData.EvacuationSite=this.EvacuationSite;let t="",n=!1,e=C.PlayerDatas[0].GetBackpackItem("摄影机"),a=C.PlayerDatas[1].GetBackpackItem("摄影机"),o=C.PlayerDatas[2].GetBackpackItem("摄影机");n=!!(e||a||o),"训练场"==p.Instance.MapName&&(n||(t="还有容器没被搜索")),u.Scene.emit(l.Event.SHOW_EVACUATION,t)}}onEndContact(t,n,e){n.group==l.Group.Player&&u.Scene.emit(l.Event.HIDE_EVACUATION)}onEnable(){this.collider.on(s.BEGIN_CONTACT,this.onBeginContact,this),this.collider.on(s.END_CONTACT,this.onEndContact,this)}onDisable(){this.collider.off(s.BEGIN_CONTACT,this.onBeginContact,this),this.collider.off(s.END_CONTACT,this.onEndContact,this)}}).prototype,"EvacuationSite",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),S=T))||S));a._RF.pop()}}}));

System.register("chunks:///_virtual/XGTS_Evacuations.ts",["cc","./Tools.ts"],(function(e){var t,n,o,c;return{setters:[function(e){t=e.cclegacy,n=e.Component,o=e._decorator},function(e){c=e.Tools}],execute:function(){var s;t._RF.push({},"d917e9RFF5OZ5We1Rx99wav","XGTS_Evacuations",void 0);const{ccclass:i,property:a}=o;e("default",i("XGTS_Evacuations")(s=class extends n{onLoad(){if(this.node.children.length>2){let e=[];e.push(c.GetRandomInt(0,this.node.children.length)),e.push(c.GetRandomInt(0,this.node.children.length));for(let t=0;t<this.node.children.length;t++)this.node.children[t].active=-1!=e.indexOf(t)}}})||s);t._RF.pop()}}}));

System.register("chunks:///_virtual/XGTS_ExitPanel.ts",["cc","./PanelBase.ts","./XGTS_UIManager.ts","./XGTS_Constant.ts","./XGTS_DataManager.ts"],(function(a){var n,e,t,c,l,r,s;return{setters:[function(a){n=a.cclegacy,e=a.director,t=a._decorator},function(a){c=a.PanelBase},function(a){l=a.XGTS_UIManager},function(a){r=a.XGTS_Constant},function(a){s=a.XGTS_DataManager}],execute:function(){var i;n._RF.push({},"ce6044AnKxPxY0MuNlOl7ek","XGTS_ExitPanel",void 0);const{ccclass:o,property:u}=t;a("XGTS_ExitPanel",o("XGTS_ExitPanel")(i=class extends c{OnYesClick(){var a,n,t;null==(a=s.PlayerDatas[0])||a.ClearBackpack(),null==(n=s.PlayerDatas[1])||n.ClearBackpack(),null==(t=s.PlayerDatas[2])||t.ClearBackpack(),e.loadScene("XGTS_Start")}OnNoClick(){l.Instance.HidePanel(r.Panel.ExitPanel)}})||i);n._RF.pop()}}}));

System.register("chunks:///_virtual/XGTS_FloatingText.ts",["cc","./XGTS_PoolManager.ts","./Tools.ts"],(function(t){var e,o,n,a,l,s,i,c,h,r,d,p;return{setters:[function(t){e=t.cclegacy,o=t.Component,n=t.Label,a=t.Vec3,l=t.UIOpacity,s=t.Tween,i=t.tween,c=t.v3,h=t.math,r=t._decorator},function(t){d=t.XGTS_PoolManager},function(t){p=t.Tools}],execute:function(){var T;e._RF.push({},"b777dDaRlVCga0AL1IbCVCl","XGTS_FloatingText",void 0);const{ccclass:g,property:b}=r;t("XGTS_FloatingText",g("XGTS_FloatingText")(T=class extends o{constructor(...t){super(...t),this.label=null}onLoad(){this.label=this.node.getChildByName("Label").getComponent(n)}Show(t,e,o,n=.35,i=1){switch(this.node.setScale(a.ONE),this.label.color=p.GetColorFromHex(e),this.label.outlineColor=p.GetColorFromHex(o),this.label.string=t,this.label.node.getComponent(l)?this.label.node.getComponent(l).opacity=255:this.label.node.addComponent(l),s.stopAllByTarget(this.node),s.stopAllByTarget(this.label.node),i){case 1:this.ShowTween1(n);break;case 2:this.ShowTween2(n);break;default:this.ShowTween1(n)}}ShowTween1(t){this.node.setScale(a.ZERO),i(this.node).to(.2,{scale:a.ONE},{easing:"backOut"}).delay(t).call((()=>i(this.label.node.getComponent(l)).to(.25,{opacity:100}).start())).to(.25,{position:c(this.node.position.x+100*h.random()*(h.random()>.5?-1:1),this.node.position.y+150)}).call((()=>d.Instance.Put(this.node))).start()}ShowTween2(t){i(this.label.node.getComponent(l)).delay(t).to(.25,{opacity:0}).start(),i(this.node).delay(t).to(.25,{position:c(0,250)}).call((()=>{d.Instance.Put(this.node)})).start()}})||T);e._RF.pop()}}}));

System.register("chunks:///_virtual/XGTS_GameInit.ts",["cc","./XGTS_DataManager.ts","./UIManager.ts"],(function(a){var t,n,e,r,c,o;return{setters:[function(a){t=a.cclegacy,n=a.Component,e=a._decorator},function(a){r=a.XGTS_DataManager},function(a){c=a.UIManager,o=a.Panel}],execute:function(){var s;t._RF.push({},"b630bmAjHhEMLnzXCBuF2Mr","XGTS_GameInit",void 0);const{ccclass:i,property:u}=e;a("XGTS_GameInit",i("XGTS_GameInit")(s=class extends n{start(){r.LoadData().then((()=>{c.ShowPanel(o.LoadingPanel,"XGTS_Start")}))}})||s);t._RF.pop()}}}));

System.register("chunks:///_virtual/XGTS_GameItemUI.ts",["./rollupPluginModLoBabelHelpers.js","cc","./BundleManager.ts","./NodeUtil.ts","./GameManager.ts","./XGTS_WeaponContent.ts","./XGTS_DataManager.ts","./XGTS_GameManager.ts","./Tools.ts"],(function(e){var t,a,n,o,s,i,r,l,m,c,u,p,h,y,_,d;return{setters:[function(e){t=e.applyDecoratedDescriptor,a=e.initializerDefineProperty},function(e){n=e.cclegacy,o=e.Enum,s=e._decorator,i=e.Component,r=e.Sprite,l=e.Label,m=e.size},function(e){c=e.BundleManager},function(e){u=e.default},function(e){p=e.GameManager},function(e){h=e.XGTS_WeaponContentType},function(e){y=e.XGTS_DataManager},function(e){_=e.XGTS_GameManager},function(e){d=e.Tools}],execute:function(){var S,G,f,D,b;n._RF.push({},"801199553dCi7A1MNnM3h7S","XGTS_GameItemUI",void 0);const{ccclass:g,property:P}=s;e("default",(S=g("XGTS_GameItemUI"),G=P({type:o(h)}),S((b=t((D=class extends i{constructor(...e){super(...e),this.Selected=null,this.Icon=null,this.Name_Lb=null,this.Bullet_Lb=null,a(this,"type",b,this)}onLoad(){this.Selected=u.GetNode("Selected",this.node),this.Icon=u.GetComponent("Icon",this.node,r),this.Name_Lb=u.GetComponent("Name_Lb",this.node,l),this.Bullet_Lb=u.GetComponent("Bullet_Lb",this.node,l)}Refresh(){let e=null,t=m();switch(this.Icon.spriteFrame=null,this.type){case h.Primary:e=y.PlayerDatas[0].Weapon_Primary,t=m(300,125),this.Name_Lb.string=e?e.Name:"主武器";break;case h.Secondary:e=y.PlayerDatas[0].Weapon_Secondary,t=m(300,125),this.Name_Lb.string=e?e.Name:"副武器";break;case h.Pistol:e=y.PlayerDatas[0].Weapon_Pistol,t=m(150,60),this.Name_Lb.string=e?e.Name:"手枪";break;case h.Melee:e=y.PlayerDatas[0].Weapon_Melee,t=m(150,60),c.LoadSpriteFrame(p.GameData.DefaultBundle,"Res/Items/刀").then((e=>{this.Icon.spriteFrame=e,_.SetImagePreferScale(this.Icon,t.width,t.height,15)})),this.Name_Lb.string=e?e.Name:"刀具"}if(e){let a=e.ImageId;d.IsEmptyStr(y.GetGunUseSkin(e.Name))||(a=`${y.GetGunUseSkin(e.Name)}`),c.LoadSpriteFrame(p.GameData.DefaultBundle,`Res/Items/${a}`).then((e=>{this.Icon.spriteFrame=e,_.SetImagePreferScale(this.Icon,t.width,t.height,15)}))}this.RefreshAmmoCount()}RefreshAmmoCount(){this.Bullet_Lb.string="";let e=null;switch(this.type){case h.Primary:if(e=y.PlayerDatas[0].Weapon_Primary,e){let t=0;e.WeaponData.Ammo&&(t=e.WeaponData.Ammo.Count),this.Bullet_Lb.string=`${t}/${y.PlayerDatas[0].GetAmmoCountByType(e.WeaponData.AmmoType)}`}break;case h.Secondary:if(e=y.PlayerDatas[0].Weapon_Secondary,e){let t=0;e.WeaponData.Ammo&&(t=e.WeaponData.Ammo.Count),this.Bullet_Lb.string=`${t}/${y.PlayerDatas[0].GetAmmoCountByType(e.WeaponData.AmmoType)}`}break;case h.Pistol:if(e=y.PlayerDatas[0].Weapon_Pistol,e){let t=0;e.WeaponData.Ammo&&(t=e.WeaponData.Ammo.Count),this.Bullet_Lb.string=`${t}/${y.PlayerDatas[0].GetAmmoCountByType(e.WeaponData.AmmoType)}`}break;case h.Melee:this.Bullet_Lb.string=""}}RefreshSelected(e){this.Selected.active=this.type==e}}).prototype,"type",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return h.Primary}}),f=D))||f));n._RF.pop()}}}));

System.register("chunks:///_virtual/XGTS_GameManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./XGTS_Item.ts","./XGTS_Constant.ts","./Tools.ts","./XGTS_GridCell.ts","./XGTS_InventoryGrid.ts","./XGTS_PoolManager.ts","./XGTS_UIManager.ts","./ProjectEventManager.ts","./EventManager.ts"],(function(e){var t,n,o,a,i,r,l,s,c,h,d,u,p,S,m,P,g,f,y,G,C,I,M;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.initializerDefineProperty},function(e){o=e.cclegacy,a=e.Prefab,i=e._decorator,r=e.Component,l=e.PhysicsSystem2D,s=e.director,c=e.Director,h=e.UITransform},function(e){d=e.default},function(e){u=e.XGTS_Constant,p=e.XGTS_QualityColorHex,S=e.XGTS_Quality},function(e){m=e.Tools},function(e){P=e.XGTS_GridCell,g=e.GridCellState},function(e){f=e.XGTS_InventoryGrid},function(e){y=e.XGTS_PoolManager},function(e){G=e.XGTS_UIManager},function(e){C=e.ProjectEventManager,I=e.ProjectEvent},function(e){M=e.EventManager}],execute:function(){var T,_,w,z,b,E;o._RF.push({},"61770Pz/PJLV6FHaWwc3YLJ","XGTS_GameManager",void 0);const{ccclass:X,property:x}=i;e("XGTS_GameManager",(T=X("XGTS_GameManager"),_=x([a]),T(((E=class e extends r{constructor(...e){super(...e),this.playerNode=null,this.player=null,this.playerNodes=[],this.players=[],this.suppliesNodes=new Map,n(this,"poolPrefabs",b,this),this.prefabMap=new Map,this.cells=[],this.killedPCCount=0,this.killedPECount=0}onLoad(){e.Instance=this;for(let e=0;e<this.poolPrefabs.length;e++)this.prefabMap.set(this.poolPrefabs[e].name,this.poolPrefabs[e]),y.Instance.Preload(this.poolPrefabs[e],50);l.instance.debugDrawFlags=0,s.addPersistRootNode(this.node),C.emit(I.游戏开始,"三角洲"),console.log("GameManager输出：",e.IsDoubleMode),s.on(c.EVENT_BEFORE_SCENE_LOADING,this.resetGameRuningData,this)}resetGameRuningData(){e.isChangeScene?e.isChangeScene=!1:(e.IsDoubleMode=!1,e.Instance.player&&e.Instance.player.destroy(),e.Instance.playerNode&&e.Instance.playerNode.destroy(),e.Instance.player=null,e.Instance.playerNode=null,M.Scene.emit(u.Event.RESET_CAMERA),e.Instance.playerNodes.forEach((e=>{e.destroy()})),e.Instance.players.forEach((e=>{e.destroy()})),e.Instance.playerNodes=[],e.Instance.players=[])}ShowTipCells(e,t,n){this.cells.forEach((e=>{e.isValid?y.Instance.Put(e.node):console.error("cell 失效")})),this.cells=[];for(let o=0;o<t.length;o++){let a=y.Instance.Get(u.Prefab.GridCell,n.node),i=f.GridPointToWorldPosition(t[o],n);a.setWorldPosition(i);let r=a.getComponent(P);r.SetState(e?g.CanPut:g.CanntPut),this.cells.push(r)}}HideTipCells(){this.cells.forEach((e=>{y.Instance.Put(e.node)})),this.cells=[]}static FillContainer(e,t,n){for(let o=0;o<e.length;o++){let a=y.Instance.Get(u.Prefab.Item,n.node);a.getComponent(d).Init(e[o]),a.setPosition(e[o].Point.x*u.itemSize+u.itemSize/2,-e[o].Point.y*u.itemSize-u.itemSize/2),f.PlaceItem(t,e[o].Point.x,e[o].Point.y,e[o].Size.width,e[o].Size.height)}}static FillContainerByData(e,t){let n=t.width*t.height,o=[];for(let a=0;a<e.length;a++){let i=e[a];for(let e=0;e<n;e++){let n=e%t.width,a=Math.floor(e/t.width);if(0==t.grid[a][n]&&f.CanPlaceItem(t,n,a,i.Size.width,i.Size.height)){f.PlaceItem(t,n,a,i.Size.width,i.Size.height),i.Point.x=n,i.Point.y=a,o.push(i);break}}}e=o}static FillLootContainer(e,t){let n=t.width*t.height,o=[];for(let a=0;a<e.length;a++){let i=e[a];for(let e=0;e<n;e++){let n=e%t.width,a=Math.floor(e/t.width);if(0==t.grid[a][n]){if(f.CanPlaceItem(t,n,a,i.Size.width,i.Size.height)){f.PlaceItem(t,n,a,i.Size.width,i.Size.height),i.Point.x=n,i.Point.y=a,i.Rotated=!1,o.push(i);break}if(f.CanPlaceItem(t,n,a,i.Size.height,i.Size.width)){f.PlaceItem(t,n,a,i.Size.height,i.Size.width),i.Point.x=n,i.Point.y=a,i.Rotated=!0,o.push(i);break}}}}e.length=0,e.push(...o)}static GetColorHexByQuality(e){switch(e){case S.None:case S.Common:return m.GetColorFromHex(p.Common);case S.Uncommon:return m.GetColorFromHex(p.Uncommon);case S.Rare:return m.GetColorFromHex(p.Rare);case S.Superior:return m.GetColorFromHex(p.Superior);case S.Legendary:return m.GetColorFromHex(p.Legendary);case S.Mythic:return m.GetColorFromHex(p.Mythic);default:return m.GetColorFromHex(p.Common)}}static SetImagePreferScale(e,t,n,o=15){let a=(t-o)/e.getComponent(h).contentSize.width,i=(n-o)/e.getComponent(h).contentSize.height,r=a>i?i:a;e.node.setScale(r,r,1)}OnButtonClick(e){switch(e.target.name){case"ShopPanelButton":G.Instance.ShowPanel(u.Panel.ShopPanel)}}}).Instance=null,E.IsGameOver=!1,E.IsDoubleMode=!1,E.itemPlayerNum=0,E.isChangeScene=!1,E.currentBackpackNum=0,b=t((z=E).prototype,"poolPrefabs",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),w=z))||w));o._RF.pop()}}}));

System.register("chunks:///_virtual/XGTS_GameOverPanel.ts",["cc","./NodeUtil.ts","./UIManager.ts","./GameManager.ts","./ProjectEventManager.ts","./PanelBase.ts","./Tools.ts","./XGTS_DataManager.ts","./XGTS_AudioManager.ts","./XGTS_LvManager.ts","./XGTS_Constant.ts","./XGTS_GameManager.ts"],(function(e){var a,t,l,n,i,s,o,h,P,c,r,u,b,m,D,d,G,L,T;return{setters:[function(e){a=e.cclegacy,t=e.RichText,l=e.Label,n=e.sys,i=e._decorator},function(e){s=e.default},function(e){o=e.UIManager,h=e.Panel},function(e){P=e.GameManager},function(e){c=e.ProjectEventManager,r=e.ProjectEvent},function(e){u=e.PanelBase},function(e){b=e.Tools},function(e){m=e.XGTS_DataManager},function(e){D=e.XGTS_AudioManager,d=e.XGTS_Audio},function(e){G=e.XGTS_LvManager},function(e){L=e.XGTS_Constant},function(e){T=e.XGTS_GameManager}],execute:function(){var g;a._RF.push({},"71fd7ab2-b6e8-465f-83bb-c63220c2e85g","XGTS_GameOverPanel",void 0);const{ccclass:M,property:S}=i;e("default",M("XGTS_GameOverPanel")(g=class extends u{constructor(...e){super(...e),this.Panel=null,this.DetailPanel=null,this.PanelResultRichText=null,this.PanelCheliLabel=null,this.PanelTimeLabel=null,this.DetailPanelResultRichText=null,this.DetailPanelMapLabel=null,this.DetailPanelCheliLabel=null,this.DetailPanelTimeLabel=null,this.DetailPanlMoneyLabel=null,this.DetailPanlKillPLabel=null,this.DetailPanlKillELabel=null,this.data=null}onLoad(){this.Panel=s.GetNode("Panel",this.node),this.DetailPanel=s.GetNode("DetailPanel",this.node),this.PanelResultRichText=s.GetComponent("PanelResultRichText",this.node,t),this.PanelCheliLabel=s.GetComponent("PanelCheliLabel",this.node,l),this.PanelTimeLabel=s.GetComponent("PanelTimeLabel",this.node,l),this.DetailPanelResultRichText=s.GetComponent("DetailPanelResultRichText",this.node,t),this.DetailPanelMapLabel=s.GetComponent("DetailPanelMapLabel",this.node,l),this.DetailPanelCheliLabel=s.GetComponent("DetailPanelCheliLabel",this.node,l),this.DetailPanelTimeLabel=s.GetComponent("DetailPanelTimeLabel",this.node,l),this.DetailPanlMoneyLabel=s.GetComponent("DetailPanlMoneyLabel",this.node,l),this.DetailPanlKillPLabel=s.GetComponent("DetailPanlKillPLabel",this.node,l),this.DetailPanlKillELabel=s.GetComponent("DetailPanlKillELabel",this.node,l)}Show(e,a){T.IsGameOver=!0,D.Instance.StopBGM(),m.SaveData(),super.Show(this.Panel),this.data=a,this.DetailPanel.active=!1,this.RefreshPanel(e),this.RefreshDetailPanel(e),"训练场"==G.Instance.matchData.MapName&&n.localStorage.setItem(L.Key.isHavePassTutorial,!0),c.emit(r.游戏结束,P.GameData.gameName)}RefreshPanel(e){this.PanelResultRichText.string=`<b><color=${e?"#95f0a6":"#bd4b41"}>${e?"撤离成功":"撤离失败"}</color></b>`,this.PanelCheliLabel.string=this.data.MapName,this.PanelTimeLabel.string=b.FormatTime(this.data.Time)}RefreshDetailPanel(e){this.DetailPanelResultRichText.string=`<b><color=${e?"#95f0a6":"#bd4b41"}>${e?"撤离成功":"撤离失败"}</color></b>`,this.DetailPanelMapLabel.string=this.data.MapName,this.DetailPanelCheliLabel.string=this.data.EvacuationSite,this.DetailPanelTimeLabel.string=b.FormatTime(this.data.Time),this.DetailPanlMoneyLabel.string=`${this.data.Reward.toLocaleString()}`,this.DetailPanlKillPLabel.string=`${this.data.KilledPC}`,this.DetailPanlKillELabel.string=`${this.data.KilledPE}`}OnButtonClick(e){switch(D.Instance.PlaySFX(d.ButtonClick),e.target.name){case"Panel":this.Panel.active=!1,this.DetailPanel.active=!0;break;case"ContinueButton":T.isChangeScene=!0,o.ShowPanel(h.LoadingPanel,[P.GameData,P.GameData.startScene])}}})||g);a._RF.pop()}}}));

System.register("chunks:///_virtual/XGTS_GamePanel_Double.ts",["cc","./BundleManager.ts","./NodeUtil.ts","./UIManager.ts","./GameManager.ts","./EventManager.ts","./XGTS_HPBar.ts","./XGTS_Constant.ts","./XGTS_UIManager.ts","./XGTS_DataManager.ts","./XGTS_PlayerInventory.ts","./XGTS_Data.ts","./XGTS_GameManager.ts","./XGTS_CommonItem.ts","./XGTS_PoolManager.ts","./XGTS_LvManager.ts","./XGTS_CameraController.ts","./Tools.ts","./XGTS_AudioManager.ts","./ProjectEventManager.ts"],(function(t){var e,a,n,o,i,s,l,c,h,r,u,m,I,d,p,S,B,y,T,D,C,M,v,_,E,b,G,w,P,f,A,k,g,N,R;return{setters:[function(t){e=t.cclegacy,a=t._decorator,n=t.Component,o=t.Label,i=t.Sprite,s=t.Node,l=t.Color,c=t.Tween,h=t.tween,r=t.v3,u=t.director,m=t.instantiate,I=t.Vec3},function(t){d=t.BundleManager},function(t){p=t.default},function(t){S=t.UIManager,B=t.Panel},function(t){y=t.GameManager},function(t){T=t.EventManager},function(t){D=t.default},function(t){C=t.XGTS_Constant},function(t){M=t.XGTS_UIManager},function(t){v=t.XGTS_DataManager},function(t){_=t.default},function(t){E=t.XGTS_ItemType},function(t){b=t.XGTS_GameManager},function(t){G=t.default},function(t){w=t.XGTS_PoolManager},function(t){P=t.XGTS_LvManager},function(t){f=t.default},function(t){A=t.Tools},function(t){k=t.XGTS_AudioManager,g=t.XGTS_Audio},function(t){N=t.ProjectEventManager,R=t.ProjectEvent}],execute:function(){var U,O;e._RF.push({},"2d04bvjTsRC0ZIxJOVq0MrS","XGTS_GamePanel_Double",void 0);const{ccclass:H,property:X}=a;t("default",H("XGTS_GamePanel_Double")(((O=class t extends n{constructor(...t){super(...t),this.InteractButtons=[],this.Evacuation=null,this.EvacuationTitle=null,this.EvacuationCountDownLabel=null,this.EvacuationBG=null,this.UseItem=null,this.UseItemFill=null,this.UseItemIcon=null,this.MapButton=null,this.BottomBar=null,this.Joystick=null,this.ReturnButton=null,this.MoreGameButton=null,this.BroadcastPosition=null,this.ReloadButton=null,this.AmmoButton=null,this.AmmoScrollView=null,this.UseMedicineButton=null,this.MedicineButton=null,this.MedicineScrollViews=[],this.NormalBar=null,this.HPBar=null,this.mapMode=!1,this.interactCallbacks=[],this.countDown=5,this.startCount=!1,this.medItems=[],this.medTimer=0,this.ammoItems=[],this.touchs=[]}onLoad(){t.Instance=this,this.InteractButtons=[p.GetNode("InteractButton_1",this.node),p.GetNode("InteractButton_2",this.node)],this.Evacuation=p.GetNode("Evacuation",this.node),this.EvacuationTitle=p.GetComponent("EvacuationTitle",this.node,o),this.EvacuationCountDownLabel=p.GetComponent("EvacuationCountDownLabel",this.node,o),this.EvacuationBG=p.GetComponent("EvacuationBG",this.node,i),this.UseItem=p.GetNode("UseItem",this.node),this.UseItemFill=p.GetComponent("UseItemFill",this.node,i),this.UseItemIcon=p.GetComponent("UseItemIcon",this.node,i),this.MapButton=p.GetNode("MapButton",this.node),this.BottomBar=p.GetNode("BottomBar",this.node),this.Joystick=p.GetNode("Joystick",this.node),this.ReturnButton=p.GetNode("ReturnButton",this.node),this.MoreGameButton=p.GetNode("MoreGameButton",this.node),this.BroadcastPosition=p.GetNode("BroadcastPosition",this.node),this.NormalBar=p.GetNode("NormalBar",this.node),this.HPBar=p.GetComponent("HPBar",this.node,D),this.ReloadButton=p.GetNode("ReloadButton",this.node),this.AmmoButton=p.GetNode("AmmoButton",this.node),this.AmmoScrollView=p.GetNode("AmmoScrollView",this.node),this.MedicineButton=p.GetNode("MedicineButton",this.node),this.MedicineScrollViews=[p.GetNode("MedicineScrollView_1",this.node),p.GetNode("MedicineScrollView_2",this.node)],this.node.on(s.EventType.TOUCH_START,this.OnTouchStart,this),this.node.on(s.EventType.TOUCH_MOVE,this.OnTouchMove,this),this.node.on(s.EventType.TOUCH_END,this.OnTouchEnd,this),this.node.on(s.EventType.TOUCH_CANCEL,this.OnTouchEnd,this)}onDestroy(){}start(){this.ShowInteractButton_1(!1),this.ShowInteractButton_2(!1),this.MoreGameButton.active="特勤处"==P.Instance.MapName,N.emit(R.初始化更多模式按钮,this.MoreGameButton)}ShowInteractButton_1(t,e=null){e&&(this.interactCallbacks[0]=e.bind(1)),this.InteractButtons[0].active=t}ShowInteractButton_2(t,e=null){e&&(this.interactCallbacks[1]=e.bind(2)),this.InteractButtons[1].active=t}ShowEvacuation(t=""){this.Evacuation.active=!0,this.EvacuationCountDownLabel.string="",A.IsEmptyStr(t)?(this.EvacuationTitle.string="正在撤离",this.startCount=!0,this.countDown=5):this.EvacuationTitle.string=t,this.EvacuationBG.color=A.IsEmptyStr(t)?l.GREEN:l.RED}HideEvacution(){this.Evacuation.active=!1,this.countDown=5,this.startCount=!1}RefreshMedItems(t){this.medItems.forEach((t=>w.Instance.Put(t.node))),this.medItems=[];let e=v.PlayerDatas[t].GetBackpackAllItemByType(E.MedicalItem);if(e.push(...v.PlayerDatas[t].GetBackpackAllItemByType(E.ArmorItem)),e.length>0)for(let a=0;a<e.length;a++){let n=w.Instance.Get(C.Prefab.CommonItem,this.MedicineScrollViews[t-1].getChildByPath("view/MedicineContent")).getComponent(G);n.Init(e[a],this.MedCallback.bind(this,t)),this.medItems.push(n)}}MedCallback(t,e){if(e.Type==E.MedicalItem){let a=b.Instance.players[t-1];a&&a.HP<a.MaxHP?this.ShowUseItem(!0,e,(e=>{let n=a.MaxHP-a.HP;n>e.ConsumableData.Durability?(n=e.ConsumableData.Durability,v.PlayerDatas[t].RemoveItemFromBackpack(e)):e.ConsumableData.Durability-=n,this.RefreshMedItems(t),a.HP+=n})):S.ShowTip("血量已满")}e.Type==E.ArmorItem&&(null!=v.PlayerDatas[t].Weapon_Helmet&&e.Name.includes("头盔")?this.ShowUseItem(!0,e,(e=>{let a=v.PlayerDatas[t].Weapon_Helmet.EquipData,n=a.MaxDurability-a.Durability;n>e.ConsumableData.Durability?(n=e.ConsumableData.Durability,v.PlayerDatas[t].RemoveItemFromBackpack(e)):e.ConsumableData.Durability-=n,a.MaxDurability=Math.ceil(a.MaxDurability-n*(1-a.HpMaxLoss)),a.Durability+n>a.MaxDurability?a.Durability=a.MaxDurability:a.Durability+=n,this.RefreshMedItems(t)})):null!=v.PlayerDatas[t].Weapon_BodyArmor&&e.Name.includes("护甲")?this.ShowUseItem(!0,e,(e=>{let a=v.PlayerDatas[t].Weapon_BodyArmor.EquipData,n=a.MaxDurability-a.Durability;n>e.ConsumableData.Durability?(n=e.ConsumableData.Durability,v.PlayerDatas[t].RemoveItemFromBackpack(e)):e.ConsumableData.Durability-=n,a.MaxDurability=Math.ceil(a.MaxDurability-n*(1-a.HpMaxLoss)),a.Durability+n>a.MaxDurability?a.Durability=a.MaxDurability:a.Durability+=n,this.RefreshMedItems(t)})):S.ShowTip("未装备"))}ShowUseItem(t,e=null,a=null){this.UseItem.active=t,t?(c.stopAllByTarget(this.UseItemFill),this.UseItemFill.fillRange=1,d.LoadSpriteFrame(y.GameData.DefaultBundle,`Res/Items/${e.ImageId}`).then((t=>{this.UseItemIcon.spriteFrame=t,b.SetImagePreferScale(this.UseItemIcon,180,180)})),h(this.UseItemFill).to(e.ConsumableData.CostTime,{fillRange:0}).call((()=>{a&&a(e),this.ShowUseItem(!1)})).start()):c.stopAllByTarget(this.UseItemFill)}Reload(){if(b.Instance.player.weapon){const t=b.Instance.player.weapon.WeaponData;let e=t.Clip;if(t.Ammo&&(e=t.Clip-t.Ammo.Count),0==e)return;let a=v.PlayerDatas[1].GetAmmoByType(t.AmmoType,e);a?b.Instance.player.Reload((()=>{a.Count>e?a.Count-=e:e=a.Count,b.Instance.player.weapon.WeaponData.Ammo||(b.Instance.player.weapon.WeaponData.Ammo=A.Clone(a)),b.Instance.player.weapon.WeaponData.Ammo.Count+=e,T.Scene.emit(C.Event.REFRESH_WEAON_CONTENT)})):S.ShowTip("没有弹药")}else S.ShowTip("未装备武器")}RefreshAmmoItems(){this.ammoItems.forEach((t=>w.Instance.Put(t.node))),this.ammoItems=[];let t=v.PlayerDatas[1].GetBackpackAllItemByType(E.Ammo);if(t.length>0)for(let e=0;e<t.length;e++){let a=w.Instance.Get(C.Prefab.CommonItem,this.AmmoScrollView.getChildByPath("view/AmmoContent")).getComponent(G);a.Init(t[e],this.AmmoItemCallback.bind(this)),this.ammoItems.push(a)}}AmmoItemCallback(t){let e=b.Instance.player.weapon.WeaponData;e&&t.AmmoData.Type==e.AmmoType?b.Instance.player.Reload((()=>{let a=e.Clip;e.Ammo&&(a=e.Clip-e.Ammo.Count),0!=a&&(t.Count>a?t.Count-=a:(a=t.Count,v.PlayerDatas[1].RemoveItemFromBackpack(t),this.RefreshAmmoItems()),b.Instance.player.weapon.WeaponData.Ammo||(b.Instance.player.weapon.WeaponData.Ammo=A.Clone(t)),b.Instance.player.weapon.WeaponData.Ammo.Count+=a,T.Scene.emit(C.Event.REFRESH_WEAON_CONTENT),this.RefreshAmmoItems())})):S.ShowTip("换弹失败")}RefreshHPBar(t){this.HPBar.Set(t)}update(t){this.startCount&&(this.countDown-=t,this.countDown<=0&&(this.countDown=0,this.startCount=!1,P.Instance.matchData.Reward=v.PlayerDatas[1].GetTotalValue(),M.Instance.ShowPanel(C.Panel.GameOverPanel,[!0,P.Instance.matchData])),this.EvacuationCountDownLabel.string=`${this.countDown.toFixed(2)}`)}OnTouchStart(t){this.mapMode}OnTouchMove(t){this.mapMode&&f.Instance.Move(r(t.getDelta().clone().x,t.getDelta().clone().y))}OnTouchEnd(t){this.mapMode}OnMapButtonClick(){this.mapMode=!this.mapMode,this.BottomBar.active=!this.mapMode,this.Joystick.active=!this.mapMode,this.mapMode?(f.Instance.stopFollow=!0,f.Instance.ZoomOut(2e3,(()=>{}))):(this.touchs=[],f.Instance.stopFollow=!1,f.Instance.ZoomIn())}OnBackpackButtonClick(t){"特勤处"==P.Instance.MapName?d.LoadPrefab(y.GameData.DefaultBundle,"UI/PlayerInventory").then((e=>{const a=t=>{let a=m(e);a.setParent(t),a.setPosition(I.ZERO);let n=a.getComponent(_);return n.InitPlayerInventory(),n};b.IsDoubleMode?(b.currentBackpackNum=t,M.Instance.ShowPanel(C.Panel.InventoryPanel_Double,[a,t])):M.Instance.ShowPanel(C.Panel.InventoryPanel,[a])})):b.IsDoubleMode?1==t?M.Instance.ShowPanel(C.Panel.InventoryPanel_Left,[null,t]):M.Instance.ShowPanel(C.Panel.InventoryPanel_Right,[null,t]):M.Instance.ShowPanel(C.Panel.InventoryPanel,[null])}OnButtonClick(t){switch(k.Instance.PlaySFX(g.ButtonClick),t.target.name){case"InteractButton_1":this.interactCallbacks[0]&&this.interactCallbacks[0]();break;case"InteractButton_2":this.interactCallbacks[1]&&this.interactCallbacks[1]();break;case"UseMedicineButton_1":this.MedicineScrollViews[0].active=!this.MedicineScrollViews[0].active,this.MedicineScrollViews[0].active&&this.RefreshMedItems(1);break;case"UseMedicineButton_2":this.MedicineScrollViews[1].active=!this.MedicineScrollViews[1].active,this.MedicineScrollViews[1].active&&this.RefreshMedItems(2);break;case"BackpackButton_1":this.OnBackpackButtonClick(1);break;case"BackpackButton_2":this.OnBackpackButtonClick(2);break;case"UseItemCancelButton":this.ShowUseItem(!1,null,null);break;case"ReturnButton":"XGTS_Start"==u.getScene().name||"XGTS_Tutorial"==u.getScene().name?N.emit(R.返回主页按钮事件,(()=>{S.ShowPanel(B.LoadingPanel,y.StartScene,(()=>{N.emit(R.返回主页,"修狗逃生")}))})):M.Instance.ShowPanel(C.Panel.ExitPanel)}}onEnable(){T.Scene.on(C.Event.SHOW_INTERACT_BUTTON_1,this.ShowInteractButton_1,this),T.Scene.on(C.Event.SHOW_INTERACT_BUTTON_2,this.ShowInteractButton_2,this),T.Scene.on(C.Event.SHOW_EVACUATION,this.ShowEvacuation,this),T.Scene.on(C.Event.HIDE_EVACUATION,this.HideEvacution,this)}onDisable(){T.Scene.off(C.Event.SHOW_INTERACT_BUTTON_1,this.ShowInteractButton_1,this),T.Scene.off(C.Event.SHOW_INTERACT_BUTTON_2,this.ShowInteractButton_2,this),T.Scene.off(C.Event.SHOW_EVACUATION,this.ShowEvacuation,this),T.Scene.off(C.Event.HIDE_EVACUATION,this.HideEvacution,this)}}).Instance=null,U=O))||U);e._RF.pop()}}}));

System.register("chunks:///_virtual/XGTS_GamePanel.ts",["cc","./BundleManager.ts","./NodeUtil.ts","./UIManager.ts","./GameManager.ts","./EventManager.ts","./XGTS_HPBar.ts","./XGTS_Constant.ts","./XGTS_UIManager.ts","./XGTS_DataManager.ts","./XGTS_PlayerInventory.ts","./XGTS_Data.ts","./XGTS_GameManager.ts","./XGTS_CommonItem.ts","./XGTS_PoolManager.ts","./XGTS_GameItemUI.ts","./XGTS_LvManager.ts","./XGTS_CameraController.ts","./Tools.ts","./XGTS_AudioManager.ts","./ProjectEventManager.ts"],(function(t){var e,a,n,o,i,s,l,h,c,r,m,u,I,d,p,S,y,M,C,B,E,D,T,G,v,f,P,_,A,b,w,R,g,N,U,W;return{setters:[function(t){e=t.cclegacy,a=t._decorator,n=t.Component,o=t.Label,i=t.Sprite,s=t.Node,l=t.Color,h=t.Tween,c=t.tween,r=t.v3,m=t.director,u=t.instantiate,I=t.Vec3},function(t){d=t.BundleManager},function(t){p=t.default},function(t){S=t.UIManager,y=t.Panel},function(t){M=t.GameManager},function(t){C=t.EventManager},function(t){B=t.default},function(t){E=t.XGTS_Constant},function(t){D=t.XGTS_UIManager},function(t){T=t.XGTS_DataManager},function(t){G=t.default},function(t){v=t.XGTS_ItemType},function(t){f=t.XGTS_GameManager},function(t){P=t.default},function(t){_=t.XGTS_PoolManager},function(t){A=t.default},function(t){b=t.XGTS_LvManager},function(t){w=t.default},function(t){R=t.Tools},function(t){g=t.XGTS_AudioManager,N=t.XGTS_Audio},function(t){U=t.ProjectEventManager,W=t.ProjectEvent}],execute:function(){var k,H;e._RF.push({},"5c9599ce-9865-4a98-9d14-674ddc90220g","XGTS_GamePanel",void 0);const{ccclass:O,property:X}=a;t("default",O("XGTS_GamePanel")(((H=class t extends n{constructor(...t){super(...t),this.InteractButton=null,this.Evacuation=null,this.EvacuationTitle=null,this.EvacuationCountDownLabel=null,this.EvacuationBG=null,this.UseItem=null,this.UseItemFill=null,this.UseItemIcon=null,this.MapButton=null,this.BottomBar=null,this.Joystick=null,this.ReturnButton=null,this.MoreGameButton=null,this.BroadcastPosition=null,this.Weapon_0=null,this.Weapon_1=null,this.Pistol=null,this.MeleeWeapon=null,this.ReloadButton=null,this.AmmoButton=null,this.AmmoScrollView=null,this.UseMedicineButton=null,this.MedicineButton=null,this.MedicineScrollView=null,this.NormalBar=null,this.HPBar=null,this.mapMode=!1,this.interactCallback=null,this.countDown=5,this.startCount=!1,this.medItems=[],this.medTimer=0,this.ammoItems=[],this.touchs=[]}onLoad(){t.Instance=this,this.InteractButton=p.GetNode("InteractButton",this.node),this.Evacuation=p.GetNode("Evacuation",this.node),this.EvacuationTitle=p.GetComponent("EvacuationTitle",this.node,o),this.EvacuationCountDownLabel=p.GetComponent("EvacuationCountDownLabel",this.node,o),this.EvacuationBG=p.GetComponent("EvacuationBG",this.node,i),this.UseItem=p.GetNode("UseItem",this.node),this.UseItemFill=p.GetComponent("UseItemFill",this.node,i),this.UseItemIcon=p.GetComponent("UseItemIcon",this.node,i),this.MapButton=p.GetNode("MapButton",this.node),this.BottomBar=p.GetNode("BottomBar",this.node),this.Joystick=p.GetNode("Joystick",this.node),this.ReturnButton=p.GetNode("ReturnButton",this.node),this.MoreGameButton=p.GetNode("MoreGameButton",this.node),this.BroadcastPosition=p.GetNode("BroadcastPosition",this.node),this.NormalBar=p.GetNode("NormalBar",this.node),this.HPBar=p.GetComponent("HPBar",this.node,B),this.Weapon_0=p.GetComponent("Weapon_0",this.node,A),this.Weapon_1=p.GetComponent("Weapon_1",this.node,A),this.Pistol=p.GetComponent("Pistol",this.node,A),this.MeleeWeapon=p.GetComponent("MeleeWeapon",this.node,A),this.ReloadButton=p.GetNode("ReloadButton",this.node),this.AmmoButton=p.GetNode("AmmoButton",this.node),this.AmmoScrollView=p.GetNode("AmmoScrollView",this.node),this.UseMedicineButton=p.GetNode("UseMedicineButton",this.node),this.MedicineButton=p.GetNode("MedicineButton",this.node),this.MedicineScrollView=p.GetNode("MedicineScrollView",this.node),this.node.on(s.EventType.TOUCH_START,this.OnTouchStart,this),this.node.on(s.EventType.TOUCH_MOVE,this.OnTouchMove,this),this.node.on(s.EventType.TOUCH_END,this.OnTouchEnd,this),this.node.on(s.EventType.TOUCH_CANCEL,this.OnTouchEnd,this)}onDestroy(){}start(){this.HPBar.Init(l.WHITE),this.RefreshGameItemUI(),this.ShowInteractButton(!1),this.MoreGameButton.active="特勤处"==b.Instance.MapName,U.emit(W.初始化更多模式按钮,this.MoreGameButton)}ShowInteractButton(t,e=null){this.interactCallback=e,this.InteractButton.active=t}ShowEvacuation(t=""){this.Evacuation.active=!0,this.EvacuationCountDownLabel.string="",R.IsEmptyStr(t)?(this.EvacuationTitle.string="正在撤离",this.startCount=!0,this.countDown=5):this.EvacuationTitle.string=t,this.EvacuationBG.color=R.IsEmptyStr(t)?l.GREEN:l.RED}HideEvacution(){this.Evacuation.active=!1,this.countDown=5,this.startCount=!1}RefreshGameItemUI(){this.Weapon_0.Refresh(),this.Weapon_1.Refresh(),this.Pistol.Refresh(),this.MeleeWeapon.Refresh()}RefreshAmmoCount(){this.Weapon_0.RefreshAmmoCount(),this.Weapon_1.RefreshAmmoCount(),this.Pistol.RefreshAmmoCount()}RefreshMedItems(){this.medItems.forEach((t=>_.Instance.Put(t.node))),this.medItems=[];let t=T.PlayerDatas[0].GetBackpackAllItemByType(v.MedicalItem);if(t.push(...T.PlayerDatas[0].GetBackpackAllItemByType(v.ArmorItem)),t.length>0)for(let e=0;e<t.length;e++){let a=_.Instance.Get(E.Prefab.CommonItem,this.MedicineScrollView.getChildByPath("view/MedicineContent")).getComponent(P);a.Init(t[e],this.MedCallback.bind(this)),this.medItems.push(a)}}MedCallback(t){if(t.Type==v.MedicalItem){let e=f.Instance.player;e&&e.HP<e.MaxHP?this.ShowUseItem(!0,t,(t=>{let a=e.MaxHP-e.HP;a>t.ConsumableData.Durability?(a=t.ConsumableData.Durability,T.PlayerDatas[0].RemoveItemFromBackpack(t)):t.ConsumableData.Durability-=a,this.RefreshMedItems(),e.HP+=a})):S.ShowTip("血量已满")}t.Type==v.ArmorItem&&(null!=T.PlayerDatas[0].Weapon_Helmet&&t.Name.includes("头盔")?this.ShowUseItem(!0,t,(t=>{let e=T.PlayerDatas[0].Weapon_Helmet.EquipData,a=e.MaxDurability-e.Durability;a>t.ConsumableData.Durability?(a=t.ConsumableData.Durability,T.PlayerDatas[0].RemoveItemFromBackpack(t)):t.ConsumableData.Durability-=a,e.MaxDurability=Math.ceil(e.MaxDurability-a*(1-e.HpMaxLoss)),e.Durability+a>e.MaxDurability?e.Durability=e.MaxDurability:e.Durability+=a,this.RefreshMedItems()})):null!=T.PlayerDatas[0].Weapon_BodyArmor&&t.Name.includes("护甲")?this.ShowUseItem(!0,t,(t=>{let e=T.PlayerDatas[0].Weapon_BodyArmor.EquipData,a=e.MaxDurability-e.Durability;a>t.ConsumableData.Durability?(a=t.ConsumableData.Durability,T.PlayerDatas[0].RemoveItemFromBackpack(t)):t.ConsumableData.Durability-=a,e.MaxDurability=Math.ceil(e.MaxDurability-a*(1-e.HpMaxLoss)),e.Durability+a>e.MaxDurability?e.Durability=e.MaxDurability:e.Durability+=a,this.RefreshMedItems()})):S.ShowTip("未装备"))}ShowUseItem(t,e=null,a=null){this.UseItem.active=t,t?(h.stopAllByTarget(this.UseItemFill),this.UseItemFill.fillRange=1,d.LoadSpriteFrame(M.GameData.DefaultBundle,`Res/Items/${e.ImageId}`).then((t=>{this.UseItemIcon.spriteFrame=t,f.SetImagePreferScale(this.UseItemIcon,180,180)})),c(this.UseItemFill).to(e.ConsumableData.CostTime,{fillRange:0}).call((()=>{a&&a(e),this.ShowUseItem(!1)})).start()):h.stopAllByTarget(this.UseItemFill)}Reload(){if(f.Instance.player.weapon){const t=f.Instance.player.weapon.WeaponData;let e=t.Clip;if(t.Ammo&&(e=t.Clip-t.Ammo.Count),0==e)return;let a=T.PlayerDatas[0].GetAmmoByType(t.AmmoType,e);a?f.Instance.player.Reload((()=>{a.Count>e?a.Count-=e:e=a.Count,f.Instance.player.weapon.WeaponData.Ammo||(f.Instance.player.weapon.WeaponData.Ammo=R.Clone(a)),f.Instance.player.weapon.WeaponData.Ammo.Count+=e,C.Scene.emit(E.Event.REFRESH_WEAON_CONTENT)})):S.ShowTip("没有弹药")}else S.ShowTip("未装备武器")}RefreshAmmoItems(){this.ammoItems.forEach((t=>_.Instance.Put(t.node))),this.ammoItems=[];let t=T.PlayerDatas[0].GetBackpackAllItemByType(v.Ammo);if(t.length>0)for(let e=0;e<t.length;e++){let a=_.Instance.Get(E.Prefab.CommonItem,this.AmmoScrollView.getChildByPath("view/AmmoContent")).getComponent(P);a.Init(t[e],this.AmmoItemCallback.bind(this)),this.ammoItems.push(a)}}AmmoItemCallback(t){let e=f.Instance.player.weapon.WeaponData;e&&t.AmmoData.Type==e.AmmoType?f.Instance.player.Reload((()=>{let a=e.Clip;e.Ammo&&(a=e.Clip-e.Ammo.Count),0!=a&&(t.Count>a?t.Count-=a:(a=t.Count,T.PlayerDatas[0].RemoveItemFromBackpack(t),this.RefreshAmmoItems()),f.Instance.player.weapon.WeaponData.Ammo||(f.Instance.player.weapon.WeaponData.Ammo=R.Clone(t)),f.Instance.player.weapon.WeaponData.Ammo.Count+=a,C.Scene.emit(E.Event.REFRESH_WEAON_CONTENT),this.RefreshAmmoItems())})):S.ShowTip("换弹失败")}RefreshHPBar(t){this.HPBar.Set(t)}update(t){this.startCount&&(this.countDown-=t,this.countDown<=0&&(this.countDown=0,this.startCount=!1,b.Instance.matchData.Reward=T.PlayerDatas[0].GetTotalValue(),D.Instance.ShowPanel(E.Panel.GameOverPanel,[!0,b.Instance.matchData])),this.EvacuationCountDownLabel.string=`${this.countDown.toFixed(2)}`)}OnTouchStart(t){this.mapMode}OnTouchMove(t){this.mapMode&&w.Instance.Move(r(t.getDelta().clone().x,t.getDelta().clone().y))}OnTouchEnd(t){this.mapMode}OnMapButtonClick(){this.mapMode=!this.mapMode,this.BottomBar.active=!this.mapMode,this.Joystick.active=!this.mapMode,this.mapMode?(w.Instance.stopFollow=!0,w.Instance.ZoomOut(2e3,(()=>{}))):(this.touchs=[],w.Instance.stopFollow=!1,w.Instance.ZoomIn())}OnButtonClick(t){switch(g.Instance.PlaySFX(N.ButtonClick),t.target.name){case"InteractButton":this.interactCallback&&this.interactCallback();break;case"Weapon_0":T.PlayerDatas[0].Weapon_Primary&&f.Instance.player.SetGun(T.PlayerDatas[0].Weapon_Primary);break;case"Weapon_1":T.PlayerDatas[0].Weapon_Secondary&&f.Instance.player.SetGun(T.PlayerDatas[0].Weapon_Secondary);break;case"Pistol":T.PlayerDatas[0].Weapon_Pistol&&f.Instance.player.SetGun(T.PlayerDatas[0].Weapon_Pistol);break;case"MeleeWeapon":f.Instance.player.SetMeelee();break;case"MedicineButton":case"UseMedicineButton":this.MedicineScrollView.active=!this.MedicineScrollView.active,this.MedicineScrollView.active&&this.RefreshMedItems(),this.MedicineButton.getChildByName("MedicineButtonIcon").setScale(this.MedicineScrollView.active?.4:-.4,.4,1);break;case"ReloadButton":this.Reload();break;case"AmmoButton":this.AmmoScrollView.active=!this.AmmoScrollView.active,this.AmmoScrollView.active&&this.RefreshAmmoItems(),this.AmmoButton.getChildByName("AmmoButtonIcon").setScale(this.AmmoScrollView.active?.4:-.4,.4,1);break;case"BackpackButton":"特勤处"==b.Instance.MapName?d.LoadPrefab(M.GameData.DefaultBundle,"UI/PlayerInventory").then((t=>{D.Instance.ShowPanel(E.Panel.InventoryPanel,[e=>{let a=u(t);a.setParent(e),a.setPosition(I.ZERO);let n=a.getComponent(G);return n.InitPlayerInventory(),n}])})):D.Instance.ShowPanel(E.Panel.InventoryPanel,[null]);break;case"UseItemCancelButton":this.ShowUseItem(!1,null,null);break;case"ReturnButton":"XGTS_Start"==m.getScene().name||"XGTS_Tutorial"==m.getScene().name?U.emit(W.返回主页按钮事件,(()=>{S.ShowPanel(y.LoadingPanel,M.StartScene,(()=>{U.emit(W.返回主页,"修狗逃生")}))})):D.Instance.ShowPanel(E.Panel.ExitPanel)}}onEnable(){C.Scene.on(E.Event.SHOW_INTERACT_BUTTON,this.ShowInteractButton,this),C.Scene.on(E.Event.SHOW_EVACUATION,this.ShowEvacuation,this),C.Scene.on(E.Event.HIDE_EVACUATION,this.HideEvacution,this),C.Scene.on(E.Event.REFRESH_GAME_ITEM_UI,this.RefreshGameItemUI,this),C.Scene.on(E.Event.REFRESH_WEAON_CONTENT,this.RefreshAmmoCount,this)}onDisable(){C.Scene.off(E.Event.SHOW_INTERACT_BUTTON,this.ShowInteractButton,this),C.Scene.off(E.Event.SHOW_EVACUATION,this.ShowEvacuation,this),C.Scene.off(E.Event.HIDE_EVACUATION,this.HideEvacution,this),C.Scene.off(E.Event.REFRESH_GAME_ITEM_UI,this.RefreshGameItemUI,this),C.Scene.off(E.Event.REFRESH_WEAON_CONTENT,this.RefreshAmmoCount,this)}}).Instance=null,k=H))||k);e._RF.pop()}}}));

System.register("chunks:///_virtual/XGTS_GridCell.ts",["cc","./NodeUtil.ts","./Tools.ts"],(function(t){var o,e,n,r,s,c,l,i;return{setters:[function(t){o=t.cclegacy,e=t.Component,n=t.Vec2,r=t.UITransform,s=t.Sprite,c=t._decorator},function(t){l=t.default},function(t){i=t.Tools}],execute:function(){var u;o._RF.push({},"d68e0bR+1REtIJLJYJlkAX2","XGTS_GridCell",void 0);const{ccclass:a,property:d}=c;let C=t("GridCellState",function(t){return t.None="#FFFFFF00",t.CanPut="#A4FFA43C",t.CanntPut="#FFA4A43C",t}({}));t("XGTS_GridCell",a("XGTS_GridCell")(u=class extends e{constructor(...t){super(...t),this.Trans=null,this.Background=null,this.pos=new n}onLoad(){this.Trans=this.node.getComponent(r),this.Background=l.GetComponent("Background",this.node,s)}SetState(t){this.Background.color=i.GetColorFromHex(t)}ClearState(){this.Background.color=i.GetColorFromHex(C.None)}})||u);o._RF.pop()}}}));

System.register("chunks:///_virtual/XGTS_GunFire.ts",["cc","./XGTS_PoolManager.ts"],(function(e){var n,s,t,i,o,u;return{setters:[function(e){n=e.cclegacy,s=e.Component,t=e.sp,i=e.UITransform,o=e._decorator},function(e){u=e.XGTS_PoolManager}],execute:function(){var l;n._RF.push({},"4e3c6TpNZROf5VKTxt9hX0/","XGTS_GunFire",void 0);const{ccclass:p,property:r}=o;e("default",p("XGTS_GunFire")(l=class extends s{constructor(...e){super(...e),this.spine=null,this.spineTrans=null}onLoad(){this.spine=this.node.getComponent(t.Skeleton),this.spineTrans=this.spine.node.getComponent(i)}Play(){this.spine.setAnimation(0,"animation",!1)}Stop(){var e;null==(e=this.spine)||e.clearTrack(0)}SetAniMix(e,n){var s,t;null==(s=this.spine)||s.setMix(e,n,.2),null==(t=this.spine)||t.setMix(n,e,.2)}onEnable(){this.AddSpineListener()}AddSpineListener(){this.spine.setCompleteListener((e=>{u.Instance.Put(this.node)}))}DebugSlot(){var e,n,s,t;this.spine.debugSlots=!(null!=(e=this.spine)&&e.debugSlots),this.spine.debugBones=!(null!=(n=this.spine)&&n.debugBones),this.spine.debugMesh=!(null!=(s=this.spine)&&s.debugMesh),this.spine.useTint=!(null!=(t=this.spine)&&t.useTint)}})||l);n._RF.pop()}}}));

System.register("chunks:///_virtual/XGTS_HPBar.ts",["cc","./NodeUtil.ts","./Tools.ts"],(function(t){var o,r,e,s,n,a,i;return{setters:[function(t){o=t.cclegacy,r=t.Component,e=t.Sprite,s=t.Color,n=t._decorator},function(t){a=t.default},function(t){i=t.Tools}],execute:function(){var c;o._RF.push({},"20f74B2Bu5BN4v9o07OHZ7b","XGTS_HPBar",void 0);const{ccclass:B,property:G}=n;t("default",B("XGTS_HPBar")(c=class extends r{constructor(...t){super(...t),this.HPBarFG=null}onLoad(){this.HPBarFG||(this.HPBarFG=a.GetComponent("HPBarFG",this.node,e))}Init(t=s.RED){this.HPBarFG||(this.HPBarFG=a.GetComponent("HPBarFG",this.node,e)),this.HPBarFG.color=t,this.Set(1)}Set(t){this.HPBarFG||(this.HPBarFG=a.GetComponent("HPBarFG",this.node,e)),t=i.Clamp(t,0,1),this.HPBarFG.fillRange=t}})||c);o._RF.pop()}}}));

System.register("chunks:///_virtual/XGTS_InteractItem.ts",["./rollupPluginModLoBabelHelpers.js","cc","./XGTS_Constant.ts","./EventManager.ts","./XGTS_UIManager.ts","./XGTS_DataManager.ts","./XGTS_Data.ts","./UIManager.ts","./XGTS_GameManager.ts"],(function(e){var n,a,t,o,c,l,r,s,i,P,T,S,h,I;return{setters:[function(e){n=e.applyDecoratedDescriptor,a=e.initializerDefineProperty},function(e){t=e.cclegacy,o=e._decorator,c=e.Component,l=e.BoxCollider2D,r=e.Contact2DType},function(e){s=e.XGTS_Constant},function(e){i=e.EventManager},function(e){P=e.XGTS_UIManager},function(e){T=e.XGTS_DataManager},function(e){S=e.XGTS_WorkbenchType},function(e){h=e.UIManager},function(e){I=e.XGTS_GameManager}],execute:function(){var p,_,b;t._RF.push({},"b827aLfDiNL2rDGwGLHU9Yx","XGTS_InteractItem",void 0);const{ccclass:u,property:m}=o;e("default",u("XGTS_InteractItem")((b=n((_=class extends c{constructor(...e){super(...e),a(this,"generateBox",b,this),this.collider=null,this.taken=!1}onLoad(){this.collider=this.node.getComponent(l),this.collider.on(r.BEGIN_CONTACT,this.onBeginContact,this),this.collider.on(r.END_CONTACT,this.onEndContact,this)}start(){this.generateBox&&this.Init()}Init(){}InitDieBox(e,n,a){}Take(){}ShowSuppliesItems(e){}ItemCallback(e){}onBeginContact(e,n,a){if(n.group==s.Group.Player){let e="",a=0;switch(I.IsDoubleMode&&(e="_"+n.node.name.split("_")[1],a=parseInt(n.node.name.split("_")[1])),this.node.name){case"停机坪":i.Scene.emit(s.Event.SHOW_INTERACT_BUTTON+e,!0,(()=>{P.Instance.ShowPanel(s.Panel.SelectMapPanel,[a])}));break;case"NPC_商人":i.Scene.emit(s.Event.SHOW_INTERACT_BUTTON+e,!0,(()=>{P.Instance.ShowPanel(s.Panel.ShopPanel,[a])}));break;case"NPC_出售商人":i.Scene.emit(s.Event.SHOW_INTERACT_BUTTON+e,!0,(()=>{P.Instance.ShowPanel(s.Panel.SellPanel,[a])}));break;case"NPC_皮肤商人":i.Scene.emit(s.Event.SHOW_INTERACT_BUTTON+e,!0,(()=>{P.Instance.ShowPanel(s.Panel.SkinShopPanel,[a])}));break;case"武器台":i.Scene.emit(s.Event.SHOW_INTERACT_BUTTON+e,!0,(()=>{P.Instance.ShowPanel(s.Panel.WorkbenchPanel,["武器台：可以制作武器。",{cb:()=>{P.Instance.ShowPanel(s.Panel.UpgradePanel,[S.Weapon,a])},text:"升级"},{cb:()=>{0==T.PlayerDatas[a].GetWorkbenchLv(S.Weapon)?h.ShowTip("武器台等级为0，无法进行制造。"):P.Instance.ShowPanel(s.Panel.OutputPanel,[S.Weapon,a])},text:"使用"},{cb:()=>{P.Instance.HidePanel(s.Panel.WorkbenchPanel)},text:"离开"}])}));break;case"护甲台":i.Scene.emit(s.Event.SHOW_INTERACT_BUTTON+e,!0,(()=>{P.Instance.ShowPanel(s.Panel.WorkbenchPanel,["护甲台：可以制作护甲。",{cb:()=>{P.Instance.ShowPanel(s.Panel.UpgradePanel,[S.Armor,a])},text:"升级"},{cb:()=>{0==T.PlayerDatas[a].GetWorkbenchLv(S.Armor)?h.ShowTip("护甲台等级为0，无法进行制造。"):P.Instance.ShowPanel(s.Panel.OutputPanel,[S.Armor,a])},text:"使用"},{cb:()=>{P.Instance.HidePanel(s.Panel.WorkbenchPanel)},text:"离开"}])}));break;case"子弹台":i.Scene.emit(s.Event.SHOW_INTERACT_BUTTON+e,!0,(()=>{T.PlayerDatas[a].GetWorkbenchLv(S.Ammo);P.Instance.ShowPanel(s.Panel.WorkbenchPanel,["子弹台：可以制作子弹。",{cb:()=>{P.Instance.ShowPanel(s.Panel.UpgradePanel,[S.Ammo,a])},text:"升级"},{cb:()=>{0==T.PlayerDatas[a].GetWorkbenchLv(S.Ammo)?h.ShowTip("子弹台等级为0，无法进行制造。"):P.Instance.ShowPanel(s.Panel.OutputPanel,[S.Ammo,a])},text:"使用"},{cb:()=>{P.Instance.HidePanel(s.Panel.WorkbenchPanel)},text:"离开"}])}));break;case"药品台":i.Scene.emit(s.Event.SHOW_INTERACT_BUTTON+e,!0,(()=>{T.PlayerDatas[a].GetWorkbenchLv(S.Medical);P.Instance.ShowPanel(s.Panel.WorkbenchPanel,["药品台：可以制作药品。",{cb:()=>{P.Instance.ShowPanel(s.Panel.UpgradePanel,[S.Medical,a])},text:"升级"},{cb:()=>{0==T.PlayerDatas[a].GetWorkbenchLv(S.Medical)?h.ShowTip("药品台等级为0，无法进行制造。"):P.Instance.ShowPanel(s.Panel.OutputPanel,[S.Medical,a])},text:"使用"},{cb:()=>{P.Instance.HidePanel(s.Panel.WorkbenchPanel)},text:"离开"}])}))}}}onEndContact(e,n,a){let t="";I.IsDoubleMode&&(t="_"+n.node.name.split("_")[1]),n.group==s.Group.Player&&i.Scene.emit(s.Event.SHOW_INTERACT_BUTTON+t,!1)}}).prototype,"generateBox",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),p=_))||p);t._RF.pop()}}}));

System.register("chunks:///_virtual/XGTS_Inventory.ts",["cc","./XGTS_InventoryGrid.ts","./XGTS_Item.ts","./XGTS_DataManager.ts","./XGTS_GameManager.ts","./XGTS_Constant.ts","./XGTS_Data.ts","./XGTS_PoolManager.ts","./Tools.ts","./PrefsManager.ts","./XGTS_Showcases.ts","./EventManager.ts","./XGTS_LvManager.ts"],(function(t){var e,i,a,n,d,h,s,o,r,l,S,m,g,I,z,P,c,y,C;return{setters:[function(t){e=t.cclegacy,i=t.v3,a=t.v2,n=t.Component,d=t.director,h=t._decorator},function(t){s=t.XGTS_InventoryGrid},function(t){o=t.default},function(t){r=t.XGTS_DataManager},function(t){l=t.XGTS_GameManager},function(t){S=t.XGTS_Constant,m=t.XGTS_Quality},function(t){g=t.XGTS_ItemData},function(t){I=t.XGTS_PoolManager},function(t){z=t.Tools},function(t){P=t.default},function(t){c=t.default},function(t){y=t.EventManager},function(t){C=t.XGTS_LvManager}],execute:function(){var u;e._RF.push({},"7d819Wmy4dFUbNWlfKV1g7O","XGTS_Inventory",void 0);const{ccclass:x,property:f}=h,T=i(),w=a();t("default",x("XGTS_Inventory")(u=class extends n{constructor(...t){super(...t),this.ItemContent=null,this.ItemContentTrans=null,this.data=[],this.items=[],this.gridCtrl=null,this.lastResult=a(-1,-1),this.stopSearch=!1}start(){d.getScene().on("修勾逃生_展示表情",this.Showmeme,this)}Init(t,e){this.data=t,this.gridCtrl=e,this.ClearItems();for(let e=0;e<t.length;e++){let i=I.Instance.Get(S.Prefab.Item,this.ItemContentTrans.node),a=i.getComponent(o);a.Init(t[e]),a.belongInventory=this,t[e].Rotated?i.setPosition(t[e].Point.x*S.itemSize+t[e].Size.height*S.itemSize/2,-t[e].Point.y*S.itemSize-t[e].Size.width*S.itemSize/2):i.setPosition(t[e].Point.x*S.itemSize+t[e].Size.width*S.itemSize/2,-t[e].Point.y*S.itemSize-t[e].Size.height*S.itemSize/2),this.items.push(a),t[e].Rotated?s.PlaceItem(this.gridCtrl,t[e].Point.x,t[e].Point.y,t[e].Size.height,t[e].Size.width):s.PlaceItem(this.gridCtrl,t[e].Point.x,t[e].Point.y,t[e].Size.width,t[e].Size.height)}let i=this.items.filter((t=>!t.data.Searched));const a=t=>{t>=i.length||this.stopSearch||i[t].Search((()=>{a(t+1)}))};a(0)}InitLootContainer(t,e,i){this.data=t,this.gridCtrl=new s(e,i),this.ClearItems(),l.FillLootContainer(this.data,this.gridCtrl);for(let t=0;t<this.data.length;t++){const e=this.data[t];let i=I.Instance.Get(S.Prefab.Item,this.ItemContentTrans.node);e.Rotated?i.setPosition(e.Point.x*S.itemSize+e.Size.height*S.itemSize/2,-e.Point.y*S.itemSize-e.Size.width*S.itemSize/2):i.setPosition(e.Point.x*S.itemSize+e.Size.width*S.itemSize/2,-e.Point.y*S.itemSize-e.Size.height*S.itemSize/2);let a=i.getComponent(o);a.Init(e),a.belongInventory=this,this.items.push(a)}let a=this.items.filter((t=>!t.data.Searched));const n=t=>{t>=a.length||this.stopSearch||a[t].Search((()=>{n(t+1)}))};n(0)}AddItem(t){let e=this.gridCtrl.width*this.gridCtrl.height;for(let i=0;i<e;i++){let e=i%this.gridCtrl.width,a=Math.floor(i/this.gridCtrl.width);if(0==this.gridCtrl.grid[a][e]){if(s.CanPlaceItem(this.gridCtrl,e,a,t.Size.width,t.Size.height)){s.PlaceItem(this.gridCtrl,e,a,t.Size.width,t.Size.height),t.Point.x=e,t.Point.y=a,t.Rotated=!1;let i=I.Instance.Get(S.Prefab.Item,this.ItemContentTrans.node);i.setPosition(e*S.itemSize+t.Size.width*S.itemSize/2,-a*S.itemSize-t.Size.height*S.itemSize/2);let n=i.getComponent(o);return n.Init(t),this.items.push(n),!0}if(s.CanPlaceItem(this.gridCtrl,e,a,t.Size.height,t.Size.width)){s.PlaceItem(this.gridCtrl,e,a,t.Size.height,t.Size.width),t.Point.x=e,t.Point.y=a,t.Rotated=!0;let i=I.Instance.Get(S.Prefab.Item,this.ItemContentTrans.node);i.setPosition(e*S.itemSize+t.Size.height*S.itemSize/2,-a*S.itemSize-t.Size.width*S.itemSize/2);let n=i.getComponent(o);return n.Init(t),this.items.push(n),!0}}}return!1}ClearItems(){this.items&&0!=this.items.length&&(this.items.forEach((t=>{var e;(null==(e=t.node)?void 0:e.parent)==this.ItemContentTrans.node&&I.Instance.Put(t.node)})),this.items.length=0,s.ClearGrid(this.gridCtrl))}AddItemToArray(t){-1===this.data.findIndex((e=>e===t))&&this.data.push(t)}RemoveItemFromArray(t){let e=this.items.findIndex((e=>e.data===t));if(-1!==e){let t=this.items[e];this.items.splice(e,1),t.node&&t.node.parent&&I.Instance.Put(t.node)}let i=this.data.findIndex((e=>e===t));-1!==i&&this.data.splice(i,1),t.Rotated?s.RemoveItem(this.gridCtrl,t.Point.x,t.Point.y,t.Size.height,t.Size.width):s.RemoveItem(this.gridCtrl,t.Point.x,t.Point.y,t.Size.width,t.Size.height)}OnDragStart(t){t.isShopItem||-1!==this.data.findIndex((e=>e===t.data))&&(t.data.Rotated?s.RemoveItem(this.gridCtrl,t.data.Point.x,t.data.Point.y,t.data.Size.height,t.data.Size.width):s.RemoveItem(this.gridCtrl,t.data.Point.x,t.data.Point.y,t.data.Size.width,t.data.Size.height))}OnDragging(t,e){if(!(t.isShopItem||(this.ItemContentTrans.convertToNodeSpaceAR(T.set(e.x,e.y),T),T.x<0||T.x>this.ItemContentTrans.width||-T.y<0||-T.y>this.ItemContentTrans.height||(w.set(T.x,T.y),w.set(Math.floor(w.x/100),Math.floor(-T.y/100)),this.lastResult.x==w.x&&this.lastResult.y==w.y)))){this.lastResult.set(w.x,w.y),l.Instance.HideTipCells(),t.data.Rotated?s.RemoveItem(this.gridCtrl,t.data.Point.x,t.data.Point.y,t.data.Size.height,t.data.Size.width):s.RemoveItem(this.gridCtrl,t.data.Point.x,t.data.Point.y,t.data.Size.width,t.data.Size.height);let e=[],i=s.CanPlaceItem(this.gridCtrl,w.x,w.y,t.data.Size.width,t.data.Size.height),n=!1;if(i||(i=s.CanPlaceItem(this.gridCtrl,w.x,w.y,t.data.Size.height,t.data.Size.width),n=i),i){let i=n?t.data.Size.height:t.data.Size.width,d=n?t.data.Size.width:t.data.Size.height;for(let t=0;t<i;t++)for(let i=0;i<d;i++)e.push(a(w.x+t,w.y+i));l.Instance.ShowTipCells(!0,e,this.ItemContentTrans)}else{for(let i=0;i<t.data.Size.width;i++)for(let n=0;n<t.data.Size.height;n++)e.push(a(w.x+i,w.y+n));l.Instance.ShowTipCells(!1,e,this.ItemContentTrans)}}}OnDragEnd(t,e){if(t.isShopItem)return;if(this.lastResult.set(-1,-1),this.ItemContentTrans.convertToNodeSpaceAR(T.set(e.x,e.y),T),l.Instance.HideTipCells(),T.x<0||T.x>this.ItemContentTrans.width||-T.y<0||-T.y>this.ItemContentTrans.height)return void(-1!==this.data.findIndex((e=>e===t.data))&&(t.data.Rotated?s.PlaceItem(this.gridCtrl,t.data.Point.x,t.data.Point.y,t.data.Size.height,t.data.Size.width):s.PlaceItem(this.gridCtrl,t.data.Point.x,t.data.Point.y,t.data.Size.width,t.data.Size.height),t.data.Rotated?T.set(100*t.data.Point.x+50*t.data.Size.height,100*-t.data.Point.y-50*t.data.Size.width,0):T.set(100*t.data.Point.x+50*t.data.Size.width,100*-t.data.Point.y-50*t.data.Size.height,0),t.node.setPosition(T)));w.set(T.x,T.y),w.set(Math.floor(w.x/100),Math.floor(-T.y/100));let i=s.CanPlaceItem(this.gridCtrl,w.x,w.y,t.data.Size.width,t.data.Size.height),a=!1;i||(i=s.CanPlaceItem(this.gridCtrl,w.x,w.y,t.data.Size.height,t.data.Size.width),a=i);let n=-1==this.data.findIndex((e=>e===t.data));if(i){let e=0;if(l.IsDoubleMode&&(e=1),this.data==r.PlayerDatas[e].InventoryItemData&&t.data.Quality>=m.Mythic&&g.IsCollection(t.data.Type)&&P.GetBool(S.Key.FirstPutInventory,!0)&&c.Instance.GetTarget(t.data.Name)){let e=c.Instance.GetTarget(t.data.Name,(()=>{P.SetBool(S.Key.FirstPutInventory,!1),y.Scene.emit(S.Event.SHOW_TUTORIAL,C.Instance.GuideTarget)}));e&&y.Scene.emit(S.Event.SHOW_TUTORIAL,e.node)}n&&(t.belongInventory.RemoveItemFromArray(t.data),t.belongInventory=this,this.AddItemToArray(t.data),this.items.push(t)),t.data.Point.x=w.x,t.data.Point.y=w.y,t.data.Rotated=a,a?s.PlaceItem(this.gridCtrl,w.x,w.y,t.data.Size.height,t.data.Size.width):s.PlaceItem(this.gridCtrl,w.x,w.y,t.data.Size.width,t.data.Size.height),t.node.setParent(this.ItemContent),a?T.set(100*w.x+50*t.data.Size.height,100*-w.y-50*t.data.Size.width,0):T.set(100*w.x+50*t.data.Size.width,100*-w.y-50*t.data.Size.height,0),t.node.setPosition(T),t.Init(t.data)}else-1!==this.data.findIndex((e=>e===t.data))?(t.data.Rotated?s.PlaceItem(this.gridCtrl,t.data.Point.x,t.data.Point.y,t.data.Size.height,t.data.Size.width):s.PlaceItem(this.gridCtrl,t.data.Point.x,t.data.Point.y,t.data.Size.width,t.data.Size.height),t.data.Rotated?T.set(100*t.data.Point.x+50*t.data.Size.height,100*-t.data.Point.y-50*t.data.Size.width,0):T.set(100*t.data.Point.x+50*t.data.Size.width,100*-t.data.Point.y-50*t.data.Size.height,0),t.node.setPosition(T)):n&&t.belongInventory&&(t.belongInventory.AddItemToArray(t.data),t.belongInventory.items.push(t),z.RemoveItemFromArray(this.items,t),t.node.setParent(t.belongInventory.ItemContent),t.data.Rotated?T.set(100*t.data.Point.x+50*t.data.Size.height,100*-t.data.Point.y-50*t.data.Size.width,0):T.set(100*t.data.Point.x+50*t.data.Size.width,100*-t.data.Point.y-50*t.data.Size.height,0),t.node.setPosition(T));r.SaveData()}Showmeme(t){this.node.getChildByPath("Meme/"+t)&&(this.node.getChildByPath("Meme/"+t).active=!0,this.scheduleOnce((()=>{this.node.getChildByPath("Meme/"+t).active=!1}),2.5))}})||u);e._RF.pop()}}}));

System.register("chunks:///_virtual/XGTS_InventoryGrid.ts",["cc","./XGTS_Constant.ts"],(function(t){var i,r,e,o;return{setters:[function(t){i=t.cclegacy,r=t.v2,e=t.v3},function(t){o=t.XGTS_Constant}],execute:function(){i._RF.push({},"a638daBfPtNnrY8mk/lG2EO","XGTS_InventoryGrid",void 0);t("XGTS_InventoryGrid",class{constructor(t,i){this.width=void 0,this.height=void 0,this.grid=[],this.width=t,this.height=i,this.grid=Array.from({length:i},(()=>Array.from({length:t},(()=>0))))}static GetPlaceItemPoints(t,i,e,o,n){let d=[];for(let h=i;h<i+o;h++)if(!(h>t.width-1))for(let i=e;i<e+n;i++)i>t.height-1||d.push(r(h,i));return d}static CanPlaceItem(t,i,r,e,o){if(!t||!t.grid)return!1;if(i+e>t.width||r+o>t.height)return!1;if(i<0||r<0)return!1;for(let n=i;n<i+e;n++)if(!(n>=t.width||n<0))for(let i=r;i<r+o;i++)if(!(i>=t.height||i<0)){if(!t.grid[i]||void 0===t.grid[i][n])return!1;if(0!=t.grid[i][n])return!1}return!0}static PlaceItem(t,i,r,e,o){if(t&&t.grid)for(let n=i;n<i+e;n++)if(!(n>=t.width||n<0))for(let i=r;i<r+o;i++)i>=t.height||i<0||t.grid[i]&&void 0!==t.grid[i][n]&&(t.grid[i][n]=1)}static RemoveItem(t,i,r,e,o){if(t&&t.grid)for(let n=i;n<i+e;n++)if(!(n>=t.width||n<0))for(let i=r;i<r+o;i++)i>=t.height||i<0||t.grid[i]&&void 0!==t.grid[i][n]&&(t.grid[i][n]=0)}static ClearGrid(t){let i=t.grid;for(let t=0;t<i.length;t++)for(let r=0;r<i[t].length;r++)1===i[t][r]&&(i[t][r]=0)}static ResizeGrid(t,i,r){t.width=i,t.height=r,t.grid=Array.from({length:r},(()=>Array.from({length:i},(()=>0))))}static GridPointToWorldPosition(t,i){let r=e(t.x*o.itemSize,-t.y*o.itemSize,0);return i.convertToWorldSpaceAR(r)}}),i._RF.pop()}}}));

System.register("chunks:///_virtual/XGTS_InventoryPanel_Double.ts",["cc","./NodeUtil.ts","./PanelBase.ts","./XGTS_DataManager.ts","./EventManager.ts","./XGTS_Constant.ts","./XGTS_BackpackInventory.ts","./XGTS_WeaponContent.ts","./XGTS_SingleInventory.ts","./XGTS_UIManager.ts","./XGTS_ChestRigInventory.ts","./XGTS_SafeBoxInventory.ts","./UIManager.ts","./XGTS_AudioManager.ts","./XGTS_GameManager.ts"],(function(e){var t,a,n,r,o,s,i,l,h,y,p,c,m,u,_,g,P,D,I,S;return{setters:[function(e){t=e.cclegacy,a=e.Label,n=e.ScrollView,r=e._decorator},function(e){o=e.default},function(e){s=e.PanelBase},function(e){i=e.XGTS_DataManager},function(e){l=e.EventManager},function(e){h=e.XGTS_Constant},function(e){y=e.default},function(e){p=e.XGTS_WeaponContent,c=e.XGTS_WeaponContentType},function(e){m=e.default},function(e){u=e.XGTS_UIManager},function(e){_=e.default},function(e){g=e.default},function(e){P=e.UIManager},function(e){D=e.XGTS_AudioManager,I=e.XGTS_Audio},function(e){S=e.XGTS_GameManager}],execute:function(){var N;t._RF.push({},"4da6eX5Jk5Hvo4sRSak3MR1","XGTS_InventoryPanel_Double",void 0);const{ccclass:d,property:W}=r;e("default",d("XGTS_InventoryPanel_Double")(N=class extends s{constructor(...e){super(...e),this.playerNum=0,this.PlayerNumlbL=null,this.Content=null,this.ItemContent=null,this.PocketInventorys=null,this.InventoryNd=null,this.MoneyLabel=null,this.TotalValueLabel=null,this.BackpackScrollView=null,this.Weapon_Primary=null,this.Weapon_Secondary=null,this.Weapon_Pistol=null,this.Weapon_Melee=null,this.Weapon_Helmet=null,this.Weapon_BodyArmor=null,this.singleInventorys=[],this.ChestRigInventory=null,this.BackpackInventory=null,this.SafeBoxInventory=null,this.targetInventory=null}onLoad(){this.PlayerNumlbL=o.GetComponent("PlayerNum",this.node,a),this.Content=o.GetNode("Content",this.node),this.ItemContent=o.GetNode("ItemContent",this.node),this.TotalValueLabel=o.GetComponent("TotalValueLabel",this.node,a),this.MoneyLabel=o.GetComponent("MoneyLabel",this.node,a),this.BackpackScrollView=o.GetComponent("BackpackScrollView",this.node,n),this.PocketInventorys=o.GetNode("PocketInventorys",this.node),this.InventoryNd=o.GetNode("InventoryNd",this.node),this.ChestRigInventory=o.GetComponent("ChestRigInventory",this.node,_),this.BackpackInventory=o.GetComponent("BackpackInventory",this.node,y),this.SafeBoxInventory=o.GetComponent("SafeBoxInventory",this.node,g),this.Weapon_Primary=o.GetComponent("Weapon_Primary",this.node,p),this.Weapon_Secondary=o.GetComponent("Weapon_Secondary",this.node,p),this.Weapon_Pistol=o.GetComponent("Weapon_Pistol",this.node,p),this.Weapon_Melee=o.GetComponent("Weapon_Melee",this.node,p),this.Weapon_Helmet=o.GetComponent("Weapon_Helmet",this.node,p),this.Weapon_BodyArmor=o.GetComponent("Weapon_BodyArmor",this.node,p)}start(){let e=S.currentBackpackNum;for(let t=0;t<this.PocketInventorys.children.length;t++){let a=this.PocketInventorys.children[t].getComponent(m);i.PlayerDatas[e].PocketData[t]||(i.PlayerDatas[e].PocketData[t]=[]),a.InitSingle(i.PlayerDatas[e].PocketData[t],i.PlayerDatas[e].SingleGrids[t]),this.singleInventorys.push(a)}S.currentBackpackNum=0}Show(e,t){this.playerNum=t,this.PlayerNumlbL.string="P"+t.toString(),this.targetInventory&&this.targetInventory.node.destroy();let a=e&&e(this.InventoryNd);this.targetInventory=a;for(let e=0;e<this.singleInventorys.length;e++){let t=this.singleInventorys[e];i.PlayerDatas[this.playerNum].PocketData[e]||(i.PlayerDatas[this.playerNum].PocketData[e]=[]),t.InitSingle(i.PlayerDatas[this.playerNum].PocketData[e],i.PlayerDatas[this.playerNum].SingleGrids[e])}this.ChestRigInventory.InitPlayerNum(this.playerNum),this.BackpackInventory.InitPlayerNum(this.playerNum),this.SafeBoxInventory.InitPlayerNum(this.playerNum),this.Weapon_Primary.InitPlayerNum(this.playerNum),this.Weapon_Secondary.InitPlayerNum(this.playerNum),this.Weapon_Pistol.InitPlayerNum(this.playerNum),this.Weapon_Melee.InitPlayerNum(this.playerNum),this.Weapon_Helmet.InitPlayerNum(this.playerNum),this.Weapon_BodyArmor.InitPlayerNum(this.playerNum),this.ChestRigInventory.Refresh(),this.BackpackInventory.Refresh(),this.SafeBoxInventory.Refresh(),this.Weapon_Primary.Init(c.Primary),this.Weapon_Secondary.Init(c.Secondary),this.Weapon_Pistol.Init(c.Pistol),this.Weapon_Melee.Init(c.Melee),this.Weapon_Helmet.Init(c.Helmet),this.Weapon_BodyArmor.Init(c.BodyArmor),this.RefreshTotalValue(),this.RefreshMoney(),this.RefreshWeaponContentLabel()}RefreshWeaponContentLabel(){this.Weapon_Primary.RefreshContentLabel(),this.Weapon_Secondary.RefreshContentLabel(),this.Weapon_Pistol.RefreshContentLabel(),this.Weapon_Melee.RefreshContentLabel(),this.Weapon_Helmet.RefreshContentLabel(),this.Weapon_BodyArmor.RefreshContentLabel()}OnDragStart(e){this.BackpackScrollView.enabled=!1,this.targetInventory&&this.targetInventory.OnDragStart(e),this.ChestRigInventory.OnDragStart(e),this.BackpackInventory.OnDragStart(e),this.SafeBoxInventory.OnDragStart(e),this.Weapon_Primary.OnDragStart(e),this.Weapon_Secondary.OnDragStart(e),this.Weapon_Pistol.OnDragStart(e),this.Weapon_Melee.OnDragStart(e),this.Weapon_Helmet.OnDragStart(e),this.Weapon_BodyArmor.OnDragStart(e),this.singleInventorys.forEach((t=>{t.OnDragStart(e)}))}OnDragging(e,t){this.targetInventory&&this.targetInventory.OnDragging(e,t),this.ChestRigInventory.OnDragging(e,t),this.BackpackInventory.OnDragging(e,t),this.SafeBoxInventory.OnDragging(e,t),this.Weapon_Primary.OnDragging(e,t),this.Weapon_Secondary.OnDragging(e,t),this.Weapon_Pistol.OnDragging(e,t),this.Weapon_Melee.OnDragging(e,t),this.Weapon_Helmet.OnDragging(e,t),this.Weapon_BodyArmor.OnDragging(e,t),this.singleInventorys.forEach((a=>{a.OnDragging(e,t)}))}OnDragEnd(e,t){this.BackpackScrollView.enabled=!0;let a=this.BackpackScrollView.getScrollOffset();this.targetInventory&&this.targetInventory.OnDragEnd(e,t),this.ChestRigInventory.OnDragEnd(e,t),this.BackpackInventory.OnDragEnd(e,t),this.SafeBoxInventory.OnDragEnd(e,t),this.Weapon_Primary.OnDragEnd(e,t),this.Weapon_Secondary.OnDragEnd(e,t),this.Weapon_Pistol.OnDragEnd(e,t),this.Weapon_Melee.OnDragEnd(e,t),this.Weapon_Helmet.OnDragEnd(e,t),this.Weapon_BodyArmor.OnDragEnd(e,t),this.singleInventorys.forEach((a=>{a.OnDragEnd(e,t)})),this.RefreshTotalValue(),l.Scene.emit(h.Event.REFRESH_GAME_ITEM_UI),l.Scene.emit(h.Event.REFRESH_WEAON_CONTENT),l.Scene.emit(h.Event.REFRESH_EUIP+"_"+this.playerNum),this.BackpackScrollView.scrollToOffset(a,0)}RefreshMoney(){this.MoneyLabel.string=`${i.PlayerDatas[this.playerNum].Money.toLocaleString()}`}RefreshTotalValue(){let e=0;if(i.PlayerDatas[this.playerNum].Weapon_Primary&&(e+=i.PlayerDatas[this.playerNum].Weapon_Primary.Price),i.PlayerDatas[this.playerNum].Weapon_Secondary&&(e+=i.PlayerDatas[this.playerNum].Weapon_Secondary.Price),i.PlayerDatas[this.playerNum].Weapon_Pistol&&(e+=i.PlayerDatas[this.playerNum].Weapon_Pistol.Price),i.PlayerDatas[this.playerNum].Weapon_Helmet&&(e+=i.PlayerDatas[this.playerNum].Weapon_Helmet.Price),i.PlayerDatas[this.playerNum].Weapon_BodyArmor&&(e+=i.PlayerDatas[this.playerNum].Weapon_BodyArmor.Price),i.PlayerDatas[this.playerNum].PocketData)for(let t=0;t<i.PlayerDatas[this.playerNum].PocketData.length;t++){const a=i.PlayerDatas[this.playerNum].PocketData[t];a[0]&&(e+=a[0].Price)}if(i.PlayerDatas[this.playerNum].ChestRigData){e+=i.PlayerDatas[this.playerNum].ChestRigData.Price;for(let t=0;t<i.PlayerDatas[this.playerNum].ChestRigData.EquipData.ItemData.length;t++){let t=i.PlayerDatas[this.playerNum].ChestRigData.EquipData.ItemData;for(let a=0;a<t.length;a++)t[a]&&(e+=t[a].Price)}}if(i.PlayerDatas[this.playerNum].BackpackData){e+=i.PlayerDatas[this.playerNum].BackpackData.Price;for(let t=0;t<i.PlayerDatas[this.playerNum].BackpackData.EquipData.ItemData.length;t++){let t=i.PlayerDatas[this.playerNum].BackpackData.EquipData.ItemData;for(let a=0;a<t.length;a++)t[a]&&(e+=t[a].Price)}}if(i.PlayerDatas[this.playerNum].SafeBox)for(let t=0;t<i.PlayerDatas[this.playerNum].SafeBox.ItemData.length;t++){let t=i.PlayerDatas[this.playerNum].SafeBox.ItemData;for(let a=0;a<t.length;a++)t[a]&&(e+=t[a].Price)}this.TotalValueLabel.string="总价值："+i.PlayerDatas[this.playerNum].GetTotalValue().toLocaleString()}OnButtonClick(e){D.Instance.PlaySFX(I.ButtonClick);const t=(e,t,a)=>{const n=e[t];u.Instance.ShowPanel(h.Panel.ItemInfoPanel,[n,!0,r=>{"Sell"==r&&(P.ShowTip(`出售成功，获得${n.Price.toLocaleString()}`),i.PlayerDatas[this.playerNum].Money+=n.Price,e[t]=null,S.Instance.players[this.playerNum-1].weapon==n&&(S.Instance.players[this.playerNum-1].weapon=null),l.Scene.emit(h.Event.REFRESH_EUIP+"_"+this.playerNum),l.Scene.emit(h.Event.REFRESH_GAME_ITEM_UI)),"Takeoff"==r&&(i.PlayerDatas[1].AddItemToInventory(n)?(e[t]=null,S.Instance.players[this.playerNum-1].weapon==n&&(S.Instance.players[this.playerNum-1].weapon=null),l.Scene.emit(h.Event.REFRESH_EUIP+"_"+this.playerNum),l.Scene.emit(h.Event.REFRESH_GAME_ITEM_UI)):P.ShowTip("放入失败")),a.RefreshWeaponContent(),a.RefreshContentLabel(),this.RefreshTotalValue()}])};switch(e.target.name){case"Weapon_Primary":i.PlayerDatas[this.playerNum].Weapon_Primary&&t(i.PlayerDatas[this.playerNum],"Weapon_Primary",this.Weapon_Primary);break;case"Weapon_Pistol":i.PlayerDatas[this.playerNum].Weapon_Pistol&&t(i.PlayerDatas[this.playerNum],"Weapon_Pistol",this.Weapon_Pistol);break;case"Weapon_Secondary":i.PlayerDatas[this.playerNum].Weapon_Secondary&&t(i.PlayerDatas[this.playerNum],"Weapon_Secondary",this.Weapon_Secondary);break;case"Weapon_Helmet":i.PlayerDatas[this.playerNum].Weapon_Helmet&&t(i.PlayerDatas[this.playerNum],"Weapon_Helmet",this.Weapon_Helmet);break;case"Weapon_BodyArmor":i.PlayerDatas[this.playerNum].Weapon_BodyArmor&&t(i.PlayerDatas[this.playerNum],"Weapon_BodyArmor",this.Weapon_BodyArmor);break;case"ReturnButton":u.Instance.HidePanel(h.Panel.InventoryPanel_Double)}}onEnable(){l.on(h.Event.REFRESH_WEAON_CONTENT,this.RefreshWeaponContentLabel,this),l.on(h.Event.REFRESH_MONEY,this.RefreshMoney,this),l.on(h.Event.ON_ITEM_DRAGSTART,this.OnDragStart,this),l.on(h.Event.ON_ITEM_DRAGGING,this.OnDragging,this),l.on(h.Event.ON_ITEM_DRAGEND,this.OnDragEnd,this)}onDisable(){l.off(h.Event.REFRESH_WEAON_CONTENT,this.RefreshWeaponContentLabel,this),l.off(h.Event.REFRESH_MONEY,this.RefreshMoney,this),l.off(h.Event.ON_ITEM_DRAGSTART,this.OnDragStart,this),l.off(h.Event.ON_ITEM_DRAGGING,this.OnDragging,this),l.off(h.Event.ON_ITEM_DRAGEND,this.OnDragEnd,this)}})||N);t._RF.pop()}}}));

System.register("chunks:///_virtual/XGTS_InventoryPanel_Left.ts",["cc","./NodeUtil.ts","./PanelBase.ts","./XGTS_DataManager.ts","./EventManager.ts","./XGTS_Constant.ts","./XGTS_BackpackInventory.ts","./XGTS_WeaponContent.ts","./XGTS_SingleInventory.ts","./XGTS_UIManager.ts","./XGTS_ChestRigInventory.ts","./XGTS_SafeBoxInventory.ts","./UIManager.ts","./XGTS_AudioManager.ts","./XGTS_GameManager.ts"],(function(e){var t,a,n,r,o,s,i,l,h,y,p,c,m,_,u,g,P,D,I,S;return{setters:[function(e){t=e.cclegacy,a=e.Label,n=e.ScrollView,r=e._decorator},function(e){o=e.default},function(e){s=e.PanelBase},function(e){i=e.XGTS_DataManager},function(e){l=e.EventManager},function(e){h=e.XGTS_Constant},function(e){y=e.default},function(e){p=e.XGTS_WeaponContent,c=e.XGTS_WeaponContentType},function(e){m=e.default},function(e){_=e.XGTS_UIManager},function(e){u=e.default},function(e){g=e.default},function(e){P=e.UIManager},function(e){D=e.XGTS_AudioManager,I=e.XGTS_Audio},function(e){S=e.XGTS_GameManager}],execute:function(){var N;t._RF.push({},"5f6643mxaNAUrPbgVEySTJb","XGTS_InventoryPanel_Left",void 0);const{ccclass:f,property:d}=r;e("default",f("XGTS_InventoryPanel_Left")(N=class extends s{constructor(...e){super(...e),this.playerNum=0,this.Content=null,this.ItemContent=null,this.PocketInventorys=null,this.InventoryNd=null,this.MoneyLabel=null,this.TotalValueLabel=null,this.BackpackScrollView=null,this.Weapon_Primary=null,this.Weapon_Secondary=null,this.Weapon_Pistol=null,this.Weapon_Melee=null,this.Weapon_Helmet=null,this.Weapon_BodyArmor=null,this.singleInventorys=[],this.ChestRigInventory=null,this.BackpackInventory=null,this.SafeBoxInventory=null,this.targetInventory=null}onLoad(){this.Content=o.GetNode("Content",this.node),this.ItemContent=o.GetNode("ItemContent",this.node),this.TotalValueLabel=o.GetComponent("TotalValueLabel",this.node,a),this.MoneyLabel=o.GetComponent("MoneyLabel",this.node,a),this.BackpackScrollView=o.GetComponent("BackpackScrollView",this.node,n),this.PocketInventorys=o.GetNode("PocketInventorys",this.node),this.InventoryNd=o.GetNode("InventoryNd",this.node),this.ChestRigInventory=o.GetComponent("ChestRigInventory",this.node,u),this.BackpackInventory=o.GetComponent("BackpackInventory",this.node,y),this.SafeBoxInventory=o.GetComponent("SafeBoxInventory",this.node,g),this.Weapon_Primary=o.GetComponent("Weapon_Primary",this.node,p),this.Weapon_Secondary=o.GetComponent("Weapon_Secondary",this.node,p),this.Weapon_Pistol=o.GetComponent("Weapon_Pistol",this.node,p),this.Weapon_Melee=o.GetComponent("Weapon_Melee",this.node,p),this.Weapon_Helmet=o.GetComponent("Weapon_Helmet",this.node,p),this.Weapon_BodyArmor=o.GetComponent("Weapon_BodyArmor",this.node,p)}start(){let e=S.currentBackpackNum;for(let t=0;t<this.PocketInventorys.children.length;t++){let a=this.PocketInventorys.children[t].getComponent(m);i.PlayerDatas[e].PocketData[t]||(i.PlayerDatas[e].PocketData[t]=[]),a.InitSingle(i.PlayerDatas[e].PocketData[t],i.PlayerDatas[e].SingleGrids[t]),this.singleInventorys.push(a)}S.currentBackpackNum=0}Show(e,t){this.playerNum=t,this.targetInventory&&this.targetInventory.node.destroy();let a=e&&e(this.InventoryNd);this.targetInventory=a;for(let e=0;e<this.singleInventorys.length;e++){let t=this.singleInventorys[e];i.PlayerDatas[this.playerNum].PocketData[e]||(i.PlayerDatas[this.playerNum].PocketData[e]=[]),t.InitSingle(i.PlayerDatas[this.playerNum].PocketData[e],i.PlayerDatas[this.playerNum].SingleGrids[e])}this.ChestRigInventory.InitPlayerNum(this.playerNum),this.BackpackInventory.InitPlayerNum(this.playerNum),this.SafeBoxInventory.InitPlayerNum(this.playerNum),this.Weapon_Primary.InitPlayerNum(this.playerNum),this.Weapon_Secondary.InitPlayerNum(this.playerNum),this.Weapon_Pistol.InitPlayerNum(this.playerNum),this.Weapon_Melee.InitPlayerNum(this.playerNum),this.Weapon_Helmet.InitPlayerNum(this.playerNum),this.Weapon_BodyArmor.InitPlayerNum(this.playerNum),this.ChestRigInventory.Refresh(),this.BackpackInventory.Refresh(),this.SafeBoxInventory.Refresh(),this.Weapon_Primary.Init(c.Primary),this.Weapon_Secondary.Init(c.Secondary),this.Weapon_Pistol.Init(c.Pistol),this.Weapon_Melee.Init(c.Melee),this.Weapon_Helmet.Init(c.Helmet),this.Weapon_BodyArmor.Init(c.BodyArmor),this.RefreshTotalValue(),this.RefreshMoney(),this.RefreshWeaponContentLabel()}RefreshWeaponContentLabel(){this.Weapon_Primary.RefreshContentLabel(),this.Weapon_Secondary.RefreshContentLabel(),this.Weapon_Pistol.RefreshContentLabel(),this.Weapon_Melee.RefreshContentLabel(),this.Weapon_Helmet.RefreshContentLabel(),this.Weapon_BodyArmor.RefreshContentLabel()}OnDragStart(e){this.BackpackScrollView.enabled=!1,this.targetInventory&&this.targetInventory.OnDragStart(e),this.ChestRigInventory.OnDragStart(e),this.BackpackInventory.OnDragStart(e),this.SafeBoxInventory.OnDragStart(e),this.Weapon_Primary.OnDragStart(e),this.Weapon_Secondary.OnDragStart(e),this.Weapon_Pistol.OnDragStart(e),this.Weapon_Melee.OnDragStart(e),this.Weapon_Helmet.OnDragStart(e),this.Weapon_BodyArmor.OnDragStart(e),this.singleInventorys.forEach((t=>{t.OnDragStart(e)}))}OnDragging(e,t){this.targetInventory&&this.targetInventory.OnDragging(e,t),this.ChestRigInventory.OnDragging(e,t),this.BackpackInventory.OnDragging(e,t),this.SafeBoxInventory.OnDragging(e,t),this.Weapon_Primary.OnDragging(e,t),this.Weapon_Secondary.OnDragging(e,t),this.Weapon_Pistol.OnDragging(e,t),this.Weapon_Melee.OnDragging(e,t),this.Weapon_Helmet.OnDragging(e,t),this.Weapon_BodyArmor.OnDragging(e,t),this.singleInventorys.forEach((a=>{a.OnDragging(e,t)}))}OnDragEnd(e,t){this.BackpackScrollView.enabled=!0;let a=this.BackpackScrollView.getScrollOffset();this.targetInventory&&this.targetInventory.OnDragEnd(e,t),this.ChestRigInventory.OnDragEnd(e,t),this.BackpackInventory.OnDragEnd(e,t),this.SafeBoxInventory.OnDragEnd(e,t),this.Weapon_Primary.OnDragEnd(e,t),this.Weapon_Secondary.OnDragEnd(e,t),this.Weapon_Pistol.OnDragEnd(e,t),this.Weapon_Melee.OnDragEnd(e,t),this.Weapon_Helmet.OnDragEnd(e,t),this.Weapon_BodyArmor.OnDragEnd(e,t),this.singleInventorys.forEach((a=>{a.OnDragEnd(e,t)})),this.RefreshTotalValue(),l.Scene.emit(h.Event.REFRESH_GAME_ITEM_UI),l.Scene.emit(h.Event.REFRESH_WEAON_CONTENT),l.Scene.emit(h.Event.REFRESH_EUIP),this.BackpackScrollView.scrollToOffset(a,0)}RefreshMoney(){this.MoneyLabel.string=`${i.PlayerDatas[this.playerNum].Money.toLocaleString()}`}RefreshTotalValue(){let e=0;if(i.PlayerDatas[this.playerNum].Weapon_Primary&&(e+=i.PlayerDatas[this.playerNum].Weapon_Primary.Price),i.PlayerDatas[this.playerNum].Weapon_Secondary&&(e+=i.PlayerDatas[this.playerNum].Weapon_Secondary.Price),i.PlayerDatas[this.playerNum].Weapon_Pistol&&(e+=i.PlayerDatas[this.playerNum].Weapon_Pistol.Price),i.PlayerDatas[this.playerNum].Weapon_Helmet&&(e+=i.PlayerDatas[this.playerNum].Weapon_Helmet.Price),i.PlayerDatas[this.playerNum].Weapon_BodyArmor&&(e+=i.PlayerDatas[this.playerNum].Weapon_BodyArmor.Price),i.PlayerDatas[this.playerNum].PocketData)for(let t=0;t<i.PlayerDatas[this.playerNum].PocketData.length;t++){const a=i.PlayerDatas[this.playerNum].PocketData[t];a[0]&&(e+=a[0].Price)}if(i.PlayerDatas[this.playerNum].ChestRigData){e+=i.PlayerDatas[this.playerNum].ChestRigData.Price;for(let t=0;t<i.PlayerDatas[this.playerNum].ChestRigData.EquipData.ItemData.length;t++){let t=i.PlayerDatas[this.playerNum].ChestRigData.EquipData.ItemData;for(let a=0;a<t.length;a++)t[a]&&(e+=t[a].Price)}}if(i.PlayerDatas[this.playerNum].BackpackData){e+=i.PlayerDatas[this.playerNum].BackpackData.Price;for(let t=0;t<i.PlayerDatas[this.playerNum].BackpackData.EquipData.ItemData.length;t++){let t=i.PlayerDatas[this.playerNum].BackpackData.EquipData.ItemData;for(let a=0;a<t.length;a++)t[a]&&(e+=t[a].Price)}}if(i.PlayerDatas[this.playerNum].SafeBox)for(let t=0;t<i.PlayerDatas[this.playerNum].SafeBox.ItemData.length;t++){let t=i.PlayerDatas[this.playerNum].SafeBox.ItemData;for(let a=0;a<t.length;a++)t[a]&&(e+=t[a].Price)}this.TotalValueLabel.string="总价值："+i.PlayerDatas[this.playerNum].GetTotalValue().toLocaleString()}OnButtonClick(e){D.Instance.PlaySFX(I.ButtonClick);const t=(e,t,a)=>{const n=e[t];S.itemPlayerNum=this.playerNum,_.Instance.ShowPanel(h.Panel.ItemInfoPanel,[n,!0,r=>{"Sell"==r&&(P.ShowTip(`出售成功，获得${n.Price.toLocaleString()}`),i.PlayerDatas[this.playerNum].Money+=n.Price,e[t]=null,S.Instance.player.weapon==n&&(S.Instance.player.weapon=null),l.Scene.emit(h.Event.REFRESH_EUIP),l.Scene.emit(h.Event.REFRESH_GAME_ITEM_UI)),"Takeoff"==r&&(i.PlayerDatas[this.playerNum].AddItemToInventory(n)?(e[t]=null,S.Instance.player.weapon==n&&(S.Instance.player.weapon=null),l.Scene.emit(h.Event.REFRESH_EUIP),l.Scene.emit(h.Event.REFRESH_GAME_ITEM_UI)):P.ShowTip("放入失败")),a.RefreshWeaponContent(),a.RefreshContentLabel(),this.RefreshTotalValue()}])};switch(e.target.name){case"Weapon_Primary":i.PlayerDatas[this.playerNum].Weapon_Primary&&t(i.PlayerDatas[this.playerNum],"Weapon_Primary",this.Weapon_Primary);break;case"Weapon_Pistol":i.PlayerDatas[this.playerNum].Weapon_Pistol&&t(i.PlayerDatas[this.playerNum],"Weapon_Pistol",this.Weapon_Pistol);break;case"Weapon_Secondary":i.PlayerDatas[this.playerNum].Weapon_Secondary&&t(i.PlayerDatas[this.playerNum],"Weapon_Secondary",this.Weapon_Secondary);break;case"Weapon_Helmet":i.PlayerDatas[this.playerNum].Weapon_Helmet&&t(i.PlayerDatas[this.playerNum],"Weapon_Helmet",this.Weapon_Helmet);break;case"Weapon_BodyArmor":i.PlayerDatas[this.playerNum].Weapon_BodyArmor&&t(i.PlayerDatas[this.playerNum],"Weapon_BodyArmor",this.Weapon_BodyArmor);break;case"ReturnButton":_.Instance.HidePanel(h.Panel.InventoryPanel_Left)}}onEnable(){l.on(h.Event.REFRESH_WEAON_CONTENT,this.RefreshWeaponContentLabel,this),l.on(h.Event.REFRESH_MONEY,this.RefreshMoney,this),l.on(h.Event.ON_ITEM_DRAGSTART,this.OnDragStart,this),l.on(h.Event.ON_ITEM_DRAGGING,this.OnDragging,this),l.on(h.Event.ON_ITEM_DRAGEND,this.OnDragEnd,this)}onDisable(){l.off(h.Event.REFRESH_WEAON_CONTENT,this.RefreshWeaponContentLabel,this),l.off(h.Event.REFRESH_MONEY,this.RefreshMoney,this),l.off(h.Event.ON_ITEM_DRAGSTART,this.OnDragStart,this),l.off(h.Event.ON_ITEM_DRAGGING,this.OnDragging,this),l.off(h.Event.ON_ITEM_DRAGEND,this.OnDragEnd,this)}})||N);t._RF.pop()}}}));

System.register("chunks:///_virtual/XGTS_InventoryPanel_Right.ts",["cc","./NodeUtil.ts","./PanelBase.ts","./XGTS_DataManager.ts","./EventManager.ts","./XGTS_Constant.ts","./XGTS_BackpackInventory.ts","./XGTS_WeaponContent.ts","./XGTS_SingleInventory.ts","./XGTS_UIManager.ts","./XGTS_ChestRigInventory.ts","./XGTS_SafeBoxInventory.ts","./UIManager.ts","./XGTS_AudioManager.ts","./XGTS_GameManager.ts"],(function(e){var t,a,n,r,o,s,i,l,h,y,p,c,m,_,u,g,P,D,I,S;return{setters:[function(e){t=e.cclegacy,a=e.Label,n=e.ScrollView,r=e._decorator},function(e){o=e.default},function(e){s=e.PanelBase},function(e){i=e.XGTS_DataManager},function(e){l=e.EventManager},function(e){h=e.XGTS_Constant},function(e){y=e.default},function(e){p=e.XGTS_WeaponContent,c=e.XGTS_WeaponContentType},function(e){m=e.default},function(e){_=e.XGTS_UIManager},function(e){u=e.default},function(e){g=e.default},function(e){P=e.UIManager},function(e){D=e.XGTS_AudioManager,I=e.XGTS_Audio},function(e){S=e.XGTS_GameManager}],execute:function(){var N;t._RF.push({},"5a3a6OuwrZJZK7eEtDA8SQc","XGTS_InventoryPanel_Right",void 0);const{ccclass:d,property:W}=r;e("default",d("XGTS_InventoryPanel_Right")(N=class extends s{constructor(...e){super(...e),this.playerNum=0,this.Content=null,this.ItemContent=null,this.PocketInventorys=null,this.InventoryNd=null,this.MoneyLabel=null,this.TotalValueLabel=null,this.BackpackScrollView=null,this.Weapon_Primary=null,this.Weapon_Secondary=null,this.Weapon_Pistol=null,this.Weapon_Melee=null,this.Weapon_Helmet=null,this.Weapon_BodyArmor=null,this.singleInventorys=[],this.ChestRigInventory=null,this.BackpackInventory=null,this.SafeBoxInventory=null,this.targetInventory=null}onLoad(){this.Content=o.GetNode("Content",this.node),this.ItemContent=o.GetNode("ItemContent",this.node),this.TotalValueLabel=o.GetComponent("TotalValueLabel",this.node,a),this.MoneyLabel=o.GetComponent("MoneyLabel",this.node,a),this.BackpackScrollView=o.GetComponent("BackpackScrollView",this.node,n),this.PocketInventorys=o.GetNode("PocketInventorys",this.node),this.InventoryNd=o.GetNode("InventoryNd",this.node),this.ChestRigInventory=o.GetComponent("ChestRigInventory",this.node,u),this.BackpackInventory=o.GetComponent("BackpackInventory",this.node,y),this.SafeBoxInventory=o.GetComponent("SafeBoxInventory",this.node,g),this.Weapon_Primary=o.GetComponent("Weapon_Primary",this.node,p),this.Weapon_Secondary=o.GetComponent("Weapon_Secondary",this.node,p),this.Weapon_Pistol=o.GetComponent("Weapon_Pistol",this.node,p),this.Weapon_Melee=o.GetComponent("Weapon_Melee",this.node,p),this.Weapon_Helmet=o.GetComponent("Weapon_Helmet",this.node,p),this.Weapon_BodyArmor=o.GetComponent("Weapon_BodyArmor",this.node,p)}start(){let e=S.currentBackpackNum;for(let t=0;t<this.PocketInventorys.children.length;t++){let a=this.PocketInventorys.children[t].getComponent(m);i.PlayerDatas[e].PocketData[t]||(i.PlayerDatas[e].PocketData[t]=[]),a.InitSingle(i.PlayerDatas[e].PocketData[t],i.PlayerDatas[e].SingleGrids[t]),this.singleInventorys.push(a)}S.currentBackpackNum=0}Show(e,t){this.playerNum=t,this.targetInventory&&this.targetInventory.node.destroy();let a=e&&e(this.InventoryNd);this.targetInventory=a;for(let e=0;e<this.singleInventorys.length;e++){let t=this.singleInventorys[e];i.PlayerDatas[this.playerNum].PocketData[e]||(i.PlayerDatas[this.playerNum].PocketData[e]=[]),t.InitSingle(i.PlayerDatas[this.playerNum].PocketData[e],i.PlayerDatas[this.playerNum].SingleGrids[e])}this.ChestRigInventory.InitPlayerNum(this.playerNum),this.BackpackInventory.InitPlayerNum(this.playerNum),this.SafeBoxInventory.InitPlayerNum(this.playerNum),this.Weapon_Primary.InitPlayerNum(this.playerNum),this.Weapon_Secondary.InitPlayerNum(this.playerNum),this.Weapon_Pistol.InitPlayerNum(this.playerNum),this.Weapon_Melee.InitPlayerNum(this.playerNum),this.Weapon_Helmet.InitPlayerNum(this.playerNum),this.Weapon_BodyArmor.InitPlayerNum(this.playerNum),this.ChestRigInventory.Refresh(),this.BackpackInventory.Refresh(),this.SafeBoxInventory.Refresh(),this.Weapon_Primary.Init(c.Primary),this.Weapon_Secondary.Init(c.Secondary),this.Weapon_Pistol.Init(c.Pistol),this.Weapon_Melee.Init(c.Melee),this.Weapon_Helmet.Init(c.Helmet),this.Weapon_BodyArmor.Init(c.BodyArmor),this.RefreshTotalValue(),this.RefreshMoney(),this.RefreshWeaponContentLabel()}RefreshWeaponContentLabel(){this.Weapon_Primary.RefreshContentLabel(),this.Weapon_Secondary.RefreshContentLabel(),this.Weapon_Pistol.RefreshContentLabel(),this.Weapon_Melee.RefreshContentLabel(),this.Weapon_Helmet.RefreshContentLabel(),this.Weapon_BodyArmor.RefreshContentLabel()}OnDragStart(e){this.BackpackScrollView.enabled=!1,this.targetInventory&&this.targetInventory.OnDragStart(e),this.ChestRigInventory.OnDragStart(e),this.BackpackInventory.OnDragStart(e),this.SafeBoxInventory.OnDragStart(e),this.Weapon_Primary.OnDragStart(e),this.Weapon_Secondary.OnDragStart(e),this.Weapon_Pistol.OnDragStart(e),this.Weapon_Melee.OnDragStart(e),this.Weapon_Helmet.OnDragStart(e),this.Weapon_BodyArmor.OnDragStart(e),this.singleInventorys.forEach((t=>{t.OnDragStart(e)}))}OnDragging(e,t){this.targetInventory&&this.targetInventory.OnDragging(e,t),this.ChestRigInventory.OnDragging(e,t),this.BackpackInventory.OnDragging(e,t),this.SafeBoxInventory.OnDragging(e,t),this.Weapon_Primary.OnDragging(e,t),this.Weapon_Secondary.OnDragging(e,t),this.Weapon_Pistol.OnDragging(e,t),this.Weapon_Melee.OnDragging(e,t),this.Weapon_Helmet.OnDragging(e,t),this.Weapon_BodyArmor.OnDragging(e,t),this.singleInventorys.forEach((a=>{a.OnDragging(e,t)}))}OnDragEnd(e,t){this.BackpackScrollView.enabled=!0;let a=this.BackpackScrollView.getScrollOffset();this.targetInventory&&this.targetInventory.OnDragEnd(e,t),this.ChestRigInventory.OnDragEnd(e,t),this.BackpackInventory.OnDragEnd(e,t),this.SafeBoxInventory.OnDragEnd(e,t),this.Weapon_Primary.OnDragEnd(e,t),this.Weapon_Secondary.OnDragEnd(e,t),this.Weapon_Pistol.OnDragEnd(e,t),this.Weapon_Melee.OnDragEnd(e,t),this.Weapon_Helmet.OnDragEnd(e,t),this.Weapon_BodyArmor.OnDragEnd(e,t),this.singleInventorys.forEach((a=>{a.OnDragEnd(e,t)})),this.RefreshTotalValue(),l.Scene.emit(h.Event.REFRESH_GAME_ITEM_UI),l.Scene.emit(h.Event.REFRESH_WEAON_CONTENT),l.Scene.emit(h.Event.REFRESH_EUIP),this.BackpackScrollView.scrollToOffset(a,0)}RefreshMoney(){this.MoneyLabel.string=`${i.PlayerDatas[this.playerNum].Money.toLocaleString()}`}RefreshTotalValue(){let e=0;if(i.PlayerDatas[this.playerNum].Weapon_Primary&&(e+=i.PlayerDatas[this.playerNum].Weapon_Primary.Price),i.PlayerDatas[this.playerNum].Weapon_Secondary&&(e+=i.PlayerDatas[this.playerNum].Weapon_Secondary.Price),i.PlayerDatas[this.playerNum].Weapon_Pistol&&(e+=i.PlayerDatas[this.playerNum].Weapon_Pistol.Price),i.PlayerDatas[this.playerNum].Weapon_Helmet&&(e+=i.PlayerDatas[this.playerNum].Weapon_Helmet.Price),i.PlayerDatas[this.playerNum].Weapon_BodyArmor&&(e+=i.PlayerDatas[this.playerNum].Weapon_BodyArmor.Price),i.PlayerDatas[this.playerNum].PocketData)for(let t=0;t<i.PlayerDatas[this.playerNum].PocketData.length;t++){const a=i.PlayerDatas[this.playerNum].PocketData[t];a[0]&&(e+=a[0].Price)}if(i.PlayerDatas[this.playerNum].ChestRigData){e+=i.PlayerDatas[this.playerNum].ChestRigData.Price;for(let t=0;t<i.PlayerDatas[this.playerNum].ChestRigData.EquipData.ItemData.length;t++){let t=i.PlayerDatas[this.playerNum].ChestRigData.EquipData.ItemData;for(let a=0;a<t.length;a++)t[a]&&(e+=t[a].Price)}}if(i.PlayerDatas[this.playerNum].BackpackData){e+=i.PlayerDatas[this.playerNum].BackpackData.Price;for(let t=0;t<i.PlayerDatas[this.playerNum].BackpackData.EquipData.ItemData.length;t++){let t=i.PlayerDatas[this.playerNum].BackpackData.EquipData.ItemData;for(let a=0;a<t.length;a++)t[a]&&(e+=t[a].Price)}}if(i.PlayerDatas[this.playerNum].SafeBox)for(let t=0;t<i.PlayerDatas[this.playerNum].SafeBox.ItemData.length;t++){let t=i.PlayerDatas[this.playerNum].SafeBox.ItemData;for(let a=0;a<t.length;a++)t[a]&&(e+=t[a].Price)}this.TotalValueLabel.string="总价值："+i.PlayerDatas[this.playerNum].GetTotalValue().toLocaleString()}OnButtonClick(e){D.Instance.PlaySFX(I.ButtonClick);const t=(e,t,a)=>{const n=e[t];S.itemPlayerNum=this.playerNum,_.Instance.ShowPanel(h.Panel.ItemInfoPanel,[n,!0,r=>{"Sell"==r&&(P.ShowTip(`出售成功，获得${n.Price.toLocaleString()}`),i.PlayerDatas[this.playerNum].Money+=n.Price,e[t]=null,S.Instance.player.weapon==n&&(S.Instance.player.weapon=null),l.Scene.emit(h.Event.REFRESH_EUIP),l.Scene.emit(h.Event.REFRESH_GAME_ITEM_UI)),"Takeoff"==r&&(i.PlayerDatas[this.playerNum].AddItemToInventory(n)?(e[t]=null,S.Instance.player.weapon==n&&(S.Instance.player.weapon=null),l.Scene.emit(h.Event.REFRESH_EUIP),l.Scene.emit(h.Event.REFRESH_GAME_ITEM_UI)):P.ShowTip("放入失败")),a.RefreshWeaponContent(),a.RefreshContentLabel(),this.RefreshTotalValue()}])};switch(e.target.name){case"Weapon_Primary":i.PlayerDatas[this.playerNum].Weapon_Primary&&t(i.PlayerDatas[this.playerNum],"Weapon_Primary",this.Weapon_Primary);break;case"Weapon_Pistol":i.PlayerDatas[this.playerNum].Weapon_Pistol&&t(i.PlayerDatas[this.playerNum],"Weapon_Pistol",this.Weapon_Pistol);break;case"Weapon_Secondary":i.PlayerDatas[this.playerNum].Weapon_Secondary&&t(i.PlayerDatas[this.playerNum],"Weapon_Secondary",this.Weapon_Secondary);break;case"Weapon_Helmet":i.PlayerDatas[this.playerNum].Weapon_Helmet&&t(i.PlayerDatas[this.playerNum],"Weapon_Helmet",this.Weapon_Helmet);break;case"Weapon_BodyArmor":i.PlayerDatas[this.playerNum].Weapon_BodyArmor&&t(i.PlayerDatas[this.playerNum],"Weapon_BodyArmor",this.Weapon_BodyArmor);break;case"ReturnButton":_.Instance.HidePanel(h.Panel.InventoryPanel_Right)}}onEnable(){l.on(h.Event.REFRESH_WEAON_CONTENT,this.RefreshWeaponContentLabel,this),l.on(h.Event.REFRESH_MONEY,this.RefreshMoney,this),l.on(h.Event.ON_ITEM_DRAGSTART,this.OnDragStart,this),l.on(h.Event.ON_ITEM_DRAGGING,this.OnDragging,this),l.on(h.Event.ON_ITEM_DRAGEND,this.OnDragEnd,this)}onDisable(){l.off(h.Event.REFRESH_WEAON_CONTENT,this.RefreshWeaponContentLabel,this),l.off(h.Event.REFRESH_MONEY,this.RefreshMoney,this),l.off(h.Event.ON_ITEM_DRAGSTART,this.OnDragStart,this),l.off(h.Event.ON_ITEM_DRAGGING,this.OnDragging,this),l.off(h.Event.ON_ITEM_DRAGEND,this.OnDragEnd,this)}})||N);t._RF.pop()}}}));

System.register("chunks:///_virtual/XGTS_InventoryPanel.ts",["cc","./NodeUtil.ts","./PanelBase.ts","./XGTS_DataManager.ts","./EventManager.ts","./XGTS_Constant.ts","./XGTS_BackpackInventory.ts","./XGTS_WeaponContent.ts","./XGTS_SingleInventory.ts","./XGTS_UIManager.ts","./XGTS_ChestRigInventory.ts","./XGTS_SafeBoxInventory.ts","./UIManager.ts","./XGTS_AudioManager.ts","./XGTS_GameManager.ts","./ProjectEventManager.ts","./GameManager.ts"],(function(e){var t,a,n,o,r,s,i,l,h,y,c,g,p,_,D,P,I,S,d,f,E,m,W;return{setters:[function(e){t=e.cclegacy,a=e.Label,n=e.ScrollView,o=e._decorator},function(e){r=e.default},function(e){s=e.PanelBase},function(e){i=e.XGTS_DataManager},function(e){l=e.EventManager},function(e){h=e.XGTS_Constant},function(e){y=e.default},function(e){c=e.XGTS_WeaponContent,g=e.XGTS_WeaponContentType},function(e){p=e.default},function(e){_=e.XGTS_UIManager},function(e){D=e.default},function(e){P=e.default},function(e){I=e.UIManager},function(e){S=e.XGTS_AudioManager,d=e.XGTS_Audio},function(e){f=e.XGTS_GameManager},function(e){E=e.ProjectEventManager,m=e.ProjectEvent},function(e){W=e.GameManager}],execute:function(){var v;t._RF.push({},"dc57fMCYIxIwLmofKqRH0qI","XGTS_InventoryPanel",void 0);const{ccclass:u,property:R}=o;e("default",u("XGTS_InventoryPanel")(v=class extends s{constructor(...e){super(...e),this.Content=null,this.ItemContent=null,this.PocketInventorys=null,this.InventoryNd=null,this.MoneyLabel=null,this.TotalValueLabel=null,this.BackpackScrollView=null,this.Weapon_Primary=null,this.Weapon_Secondary=null,this.Weapon_Pistol=null,this.Weapon_Melee=null,this.Weapon_Helmet=null,this.Weapon_BodyArmor=null,this.singleInventorys=[],this.ChestRigInventory=null,this.BackpackInventory=null,this.SafeBoxInventory=null,this.targetInventory=null}onLoad(){this.Content=r.GetNode("Content",this.node),this.ItemContent=r.GetNode("ItemContent",this.node),this.TotalValueLabel=r.GetComponent("TotalValueLabel",this.node,a),this.MoneyLabel=r.GetComponent("MoneyLabel",this.node,a),this.BackpackScrollView=r.GetComponent("BackpackScrollView",this.node,n),this.PocketInventorys=r.GetNode("PocketInventorys",this.node),this.InventoryNd=r.GetNode("InventoryNd",this.node),this.ChestRigInventory=r.GetComponent("ChestRigInventory",this.node,D),this.BackpackInventory=r.GetComponent("BackpackInventory",this.node,y),this.SafeBoxInventory=r.GetComponent("SafeBoxInventory",this.node,P),this.Weapon_Primary=r.GetComponent("Weapon_Primary",this.node,c),this.Weapon_Secondary=r.GetComponent("Weapon_Secondary",this.node,c),this.Weapon_Pistol=r.GetComponent("Weapon_Pistol",this.node,c),this.Weapon_Melee=r.GetComponent("Weapon_Melee",this.node,c),this.Weapon_Helmet=r.GetComponent("Weapon_Helmet",this.node,c),this.Weapon_BodyArmor=r.GetComponent("Weapon_BodyArmor",this.node,c)}start(){for(let e=0;e<this.PocketInventorys.children.length;e++){let t=this.PocketInventorys.children[e].getComponent(p);i.PlayerDatas[0].PocketData[e]||(i.PlayerDatas[0].PocketData[e]=[]),t.InitSingle(i.PlayerDatas[0].PocketData[e],i.PlayerDatas[0].SingleGrids[e]),this.singleInventorys.push(t)}}Show(e){this.targetInventory&&this.targetInventory.node.destroy();let t=e&&e(this.InventoryNd);this.targetInventory=t;for(let e=0;e<this.singleInventorys.length;e++){let t=this.singleInventorys[e];i.PlayerDatas[0].PocketData[e]||(i.PlayerDatas[0].PocketData[e]=[]),t.InitSingle(i.PlayerDatas[0].PocketData[e],i.PlayerDatas[0].SingleGrids[e])}this.ChestRigInventory.Refresh(),this.BackpackInventory.Refresh(),this.SafeBoxInventory.Refresh(),this.Weapon_Primary.Init(g.Primary),this.Weapon_Secondary.Init(g.Secondary),this.Weapon_Pistol.Init(g.Pistol),this.Weapon_Melee.Init(g.Melee),this.Weapon_Helmet.Init(g.Helmet),this.Weapon_BodyArmor.Init(g.BodyArmor),this.RefreshTotalValue(),this.RefreshMoney(),this.RefreshWeaponContentLabel(),E.emit(m.页面转换,W.GameData.gameName)}RefreshWeaponContentLabel(){this.Weapon_Primary.RefreshContentLabel(),this.Weapon_Secondary.RefreshContentLabel(),this.Weapon_Pistol.RefreshContentLabel(),this.Weapon_Melee.RefreshContentLabel(),this.Weapon_Helmet.RefreshContentLabel(),this.Weapon_BodyArmor.RefreshContentLabel()}OnDragStart(e){this.BackpackScrollView.enabled=!1,this.targetInventory&&this.targetInventory.OnDragStart(e),this.ChestRigInventory.OnDragStart(e),this.BackpackInventory.OnDragStart(e),this.SafeBoxInventory.OnDragStart(e),this.Weapon_Primary.OnDragStart(e),this.Weapon_Secondary.OnDragStart(e),this.Weapon_Pistol.OnDragStart(e),this.Weapon_Melee.OnDragStart(e),this.Weapon_Helmet.OnDragStart(e),this.Weapon_BodyArmor.OnDragStart(e),this.singleInventorys.forEach((t=>{t.OnDragStart(e)}))}OnDragging(e,t){this.targetInventory&&this.targetInventory.OnDragging(e,t),this.ChestRigInventory.OnDragging(e,t),this.BackpackInventory.OnDragging(e,t),this.SafeBoxInventory.OnDragging(e,t),this.Weapon_Primary.OnDragging(e,t),this.Weapon_Secondary.OnDragging(e,t),this.Weapon_Pistol.OnDragging(e,t),this.Weapon_Melee.OnDragging(e,t),this.Weapon_Helmet.OnDragging(e,t),this.Weapon_BodyArmor.OnDragging(e,t),this.singleInventorys.forEach((a=>{a.OnDragging(e,t)}))}OnDragEnd(e,t){this.BackpackScrollView.enabled=!0;let a=this.BackpackScrollView.getScrollOffset();this.targetInventory&&this.targetInventory.OnDragEnd(e,t),this.ChestRigInventory.OnDragEnd(e,t),this.BackpackInventory.OnDragEnd(e,t),this.SafeBoxInventory.OnDragEnd(e,t),this.Weapon_Primary.OnDragEnd(e,t),this.Weapon_Secondary.OnDragEnd(e,t),this.Weapon_Pistol.OnDragEnd(e,t),this.Weapon_Melee.OnDragEnd(e,t),this.Weapon_Helmet.OnDragEnd(e,t),this.Weapon_BodyArmor.OnDragEnd(e,t),this.singleInventorys.forEach((a=>{a.OnDragEnd(e,t)})),this.RefreshTotalValue(),l.Scene.emit(h.Event.REFRESH_GAME_ITEM_UI),l.Scene.emit(h.Event.REFRESH_WEAON_CONTENT),l.Scene.emit(h.Event.REFRESH_EUIP),this.BackpackScrollView.scrollToOffset(a,0)}RefreshMoney(){this.MoneyLabel.string=`${i.PlayerDatas[0].Money.toLocaleString()}`}RefreshTotalValue(){let e=0;if(i.PlayerDatas[0].Weapon_Primary&&(e+=i.PlayerDatas[0].Weapon_Primary.Price),i.PlayerDatas[0].Weapon_Secondary&&(e+=i.PlayerDatas[0].Weapon_Secondary.Price),i.PlayerDatas[0].Weapon_Pistol&&(e+=i.PlayerDatas[0].Weapon_Pistol.Price),i.PlayerDatas[0].Weapon_Helmet&&(e+=i.PlayerDatas[0].Weapon_Helmet.Price),i.PlayerDatas[0].Weapon_BodyArmor&&(e+=i.PlayerDatas[0].Weapon_BodyArmor.Price),i.PlayerDatas[0].PocketData)for(let t=0;t<i.PlayerDatas[0].PocketData.length;t++){const a=i.PlayerDatas[0].PocketData[t];a[0]&&(e+=a[0].Price)}if(i.PlayerDatas[0].ChestRigData){e+=i.PlayerDatas[0].ChestRigData.Price;for(let t=0;t<i.PlayerDatas[0].ChestRigData.EquipData.ItemData.length;t++){let t=i.PlayerDatas[0].ChestRigData.EquipData.ItemData;for(let a=0;a<t.length;a++)t[a]&&(e+=t[a].Price)}}if(i.PlayerDatas[0].BackpackData){e+=i.PlayerDatas[0].BackpackData.Price;for(let t=0;t<i.PlayerDatas[0].BackpackData.EquipData.ItemData.length;t++){let t=i.PlayerDatas[0].BackpackData.EquipData.ItemData;for(let a=0;a<t.length;a++)t[a]&&(e+=t[a].Price)}}if(i.PlayerDatas[0].SafeBox)for(let t=0;t<i.PlayerDatas[0].SafeBox.ItemData.length;t++){let t=i.PlayerDatas[0].SafeBox.ItemData;for(let a=0;a<t.length;a++)t[a]&&(e+=t[a].Price)}this.TotalValueLabel.string="总价值："+i.PlayerDatas[0].GetTotalValue().toLocaleString()}OnButtonClick(e){S.Instance.PlaySFX(d.ButtonClick);const t=(e,t,a)=>{const n=e[t];f.itemPlayerNum=0,_.Instance.ShowPanel(h.Panel.ItemInfoPanel,[n,!0,o=>{"Sell"==o&&(I.ShowTip(`出售成功，获得${n.Price.toLocaleString()}`),i.PlayerDatas[0].Money+=n.Price,e[t]=null,f.Instance.player.weapon==n&&(f.Instance.player.weapon=null),l.Scene.emit(h.Event.REFRESH_EUIP),l.Scene.emit(h.Event.REFRESH_GAME_ITEM_UI)),"Takeoff"==o&&(i.PlayerDatas[0].AddItemToInventory(n)?(e[t]=null,f.Instance.player.weapon==n&&(f.Instance.player.weapon=null),l.Scene.emit(h.Event.REFRESH_EUIP),l.Scene.emit(h.Event.REFRESH_GAME_ITEM_UI)):I.ShowTip("放入失败")),a.RefreshWeaponContent(),a.RefreshContentLabel(),this.RefreshTotalValue()}])};switch(e.target.name){case"Weapon_Primary":i.PlayerDatas[0].Weapon_Primary&&t(i.PlayerDatas[0],"Weapon_Primary",this.Weapon_Primary);break;case"Weapon_Pistol":i.PlayerDatas[0].Weapon_Pistol&&t(i.PlayerDatas[0],"Weapon_Pistol",this.Weapon_Pistol);break;case"Weapon_Secondary":i.PlayerDatas[0].Weapon_Secondary&&t(i.PlayerDatas[0],"Weapon_Secondary",this.Weapon_Secondary);break;case"Weapon_Helmet":i.PlayerDatas[0].Weapon_Helmet&&t(i.PlayerDatas[0],"Weapon_Helmet",this.Weapon_Helmet);break;case"Weapon_BodyArmor":i.PlayerDatas[0].Weapon_BodyArmor&&t(i.PlayerDatas[0],"Weapon_BodyArmor",this.Weapon_BodyArmor);break;case"ReturnButton":_.Instance.HidePanel(h.Panel.InventoryPanel)}}onEnable(){l.on(h.Event.REFRESH_WEAON_CONTENT,this.RefreshWeaponContentLabel,this),l.on(h.Event.REFRESH_MONEY,this.RefreshMoney,this),l.on(h.Event.ON_ITEM_DRAGSTART,this.OnDragStart,this),l.on(h.Event.ON_ITEM_DRAGGING,this.OnDragging,this),l.on(h.Event.ON_ITEM_DRAGEND,this.OnDragEnd,this)}onDisable(){l.off(h.Event.REFRESH_WEAON_CONTENT,this.RefreshWeaponContentLabel,this),l.off(h.Event.REFRESH_MONEY,this.RefreshMoney,this),l.off(h.Event.ON_ITEM_DRAGSTART,this.OnDragStart,this),l.off(h.Event.ON_ITEM_DRAGGING,this.OnDragging,this),l.off(h.Event.ON_ITEM_DRAGEND,this.OnDragEnd,this)}})||v);t._RF.pop()}}}));

System.register("chunks:///_virtual/XGTS_Item.ts",["cc","./NodeUtil.ts","./XGTS_Data.ts","./XGTS_Constant.ts","./XGTS_GameManager.ts","./EventManager.ts","./BundleManager.ts","./GameManager.ts","./XGTS_AudioManager.ts"],(function(t){var e,n,i,s,a,o,h,c,r,l,d,m,u,I,S,g,p,T,C,y,D,_,v,G;return{setters:[function(t){e=t.cclegacy,n=t.Component,i=t.v3,s=t.UITransform,a=t.Sprite,o=t.Widget,h=t.UIOpacity,c=t.Label,r=t.Vec3,l=t.Tween,d=t.tween,m=t.director,u=t.find,I=t.Node,S=t._decorator},function(t){g=t.default},function(t){p=t.XGTS_ItemType},function(t){T=t.XGTS_Constant},function(t){C=t.XGTS_GameManager},function(t){y=t.EventManager},function(t){D=t.BundleManager},function(t){_=t.GameManager},function(t){v=t.XGTS_AudioManager,G=t.XGTS_Audio}],execute:function(){var b;e._RF.push({},"b2b8d83f-832c-49d8-9768-c3f5ea00b99g","XGTS_Item",void 0);const{ccclass:L,property:N}=S;t("default",L("XGTS_Item")(b=class t extends n{constructor(...t){super(...t),this.trans=null,this.Background=null,this.BackgroundTrans=null,this.BackgroundWidget=null,this.Unsearch=null,this.UnsearchWidget=null,this.ItemDetail=null,this.Icon_Display=null,this.Icon=null,this.NameLabel=null,this.NameLabelTrans=null,this.DescLabel=null,this.SearchIcon=null,this.data=null,this.offset=i(),this.searchTimer=0,this.angle=0,this.canDrag=!0,this.isShopItem=!1,this.touchCallback=null,this.belongInventory=null}get Center(){return i(this.data.Size.width/2*T.itemSize-T.itemSize/2,-(this.data.Size.height/2*T.itemSize-T.itemSize/2))}onLoad(){this.trans=this.node.getComponent(s),this.Background=g.GetComponent("Background",this.node,a),this.BackgroundTrans=this.Background.getComponent(s),this.BackgroundWidget=this.Background.getComponent(o),this.Unsearch=g.GetNode("Unsearch",this.node),this.UnsearchWidget=this.Unsearch.getComponent(o),this.ItemDetail=g.GetComponent("ItemDetail",this.node,h),this.Icon_Display=g.GetComponent("Icon_Display",this.node,a),this.Icon=g.GetComponent("Icon",this.node,a),this.NameLabel=g.GetComponent("NameLabel",this.node,c),this.NameLabelTrans=this.NameLabel.getComponent(s),this.DescLabel=g.GetComponent("DescLabel",this.node,c),this.SearchIcon=g.GetNode("SearchIcon",this.node)}Init(e){this.trans=this.node.getComponent(s),this.Background=g.GetComponent("Background",this.node,a),this.BackgroundTrans=this.Background.getComponent(s),this.BackgroundWidget=this.Background.getComponent(o),this.Unsearch=g.GetNode("Unsearch",this.node),this.UnsearchWidget=this.Unsearch.getComponent(o),this.ItemDetail=g.GetComponent("ItemDetail",this.node,h),this.Icon_Display=g.GetComponent("Icon_Display",this.node,a),this.Icon=g.GetComponent("Icon",this.node,a),this.NameLabel=g.GetComponent("NameLabel",this.node,c),this.NameLabelTrans=this.NameLabel.getComponent(s),this.DescLabel=g.GetComponent("DescLabel",this.node,c),this.SearchIcon=g.GetNode("SearchIcon",this.node),this.data=e,this.NameLabel.string=e.Name,this.DescLabel.string="",e.Rotated?this.trans.setContentSize(T.itemSize*e.Size.height,T.itemSize*e.Size.width):this.trans.setContentSize(T.itemSize*e.Size.width,T.itemSize*e.Size.height),e.Rotated,this.trans.setAnchorPoint(.5,.5),this.BackgroundWidget.updateAlignment(),this.UnsearchWidget.updateAlignment(),this.NameLabelTrans.setContentSize(2*this.trans.contentSize.width-20,this.NameLabelTrans.contentSize.height),D.LoadSpriteFrame(_.GameData.DefaultBundle,`Res/Items/${e.ImageId}`).then((n=>{this.Icon_Display.spriteFrame=n,this.Icon.spriteFrame=n,this.Icon_Display.node.setPosition(r.ZERO),this.Icon.node.setPosition(r.ZERO),t.SetItemImageScale(this.Icon_Display,e.Size.width,e.Size.height),t.SetItemImageScale(this.Icon,e.Size.width,e.Size.height),e.Rotated?(this.Icon_Display.node.angle=-90,this.Icon.node.angle=-90):(this.Icon_Display.node.angle=0,this.Icon.node.angle=0)})),this.canDrag=e.Searched,this.NameLabel.node.active=e.Searched,this.SearchIcon.active=!1,this.Unsearch.active=!e.Searched,this.ItemDetail.node.active=e.Searched,e.Searched?(this.Background.color=C.GetColorHexByQuality(e.Quality),this.data.Type==p.Ammo&&(this.DescLabel.string=`${this.data.Count}`)):(this.angle=0,this.SearchIcon.setPosition(this.Center)),this.isShopItem=!1,this.touchCallback=null}RemoveItemFromAndResetLastInventory(){this.belongInventory&&(this.belongInventory.RemoveItemFromArray(this.data),this.belongInventory=null)}InitShopItem(t,e){this.onLoad(),this.Init(t),this.isShopItem=!0,this.touchCallback=e}Search(t=null){clearInterval(this.searchTimer),this.SearchIcon.active=!0,this.searchTimer=setInterval(this.SearchAni.bind(this),20),this.scheduleOnce((()=>{clearInterval(this.searchTimer),this.data.Searched=!0,this.Unsearch.active=!1,this.SearchIcon.active=!1,this.Background.color=C.GetColorHexByQuality(this.data.Quality),this.ItemDetail.node.active=!0,this.NameLabel.node.active=!0,this.ItemDetail.node.setScale(1.5,1.5,1.5),l.stopAllByTarget(this.ItemDetail.node),d(this.ItemDetail.node).to(.05,{scale:r.ONE}).call((()=>{this.canDrag=!0})).start(),this.data.Quality<3?(v.Instance.PlaySFX(G.蓝),Math.random()<.2&&(v.Instance.PlaySFX(G.难过),m.getScene().emit("修勾逃生_展示表情","难过"))):this.data.Quality<5?(v.Instance.PlaySFX(G.紫),Math.random()<.3&&(v.Instance.PlaySFX(G.一般),m.getScene().emit("修勾逃生_展示表情","一般"))):(v.Instance.PlaySFX(G.红),5==this.data.Quality&&Math.random()<.3&&(v.Instance.PlaySFX(G.开心),m.getScene().emit("修勾逃生_展示表情","开心")),6==this.data.Quality&&(v.Instance.PlaySFX(G.开心),m.getScene().emit("修勾逃生_展示表情","开心"))),t&&t()}),T.SearchTime[this.data.Quality])}SearchAni(){this.angle+=.2;const t=this.Center.x+10*Math.sin(this.angle),e=this.Center.y+10*Math.cos(this.angle);this.SearchIcon.setPosition(new r(t,e,0))}onTouchStart(t){if(!this.canDrag||this.isShopItem)return;let e=this.Icon.node.worldPosition.clone();this.Icon.node.setParent(u("Canvas")),this.Icon.node.setWorldPosition(e),y.Scene.emit(T.Event.ON_ITEM_DRAGSTART,this,t.touch.getUILocation())}onTouchMove(t){if(!this.canDrag||this.isShopItem)return;const e=t.touch.getUILocation(),n=i(this.data.Size.width/2*T.itemSize-T.itemSize/2,-(this.data.Size.height/2*T.itemSize-T.itemSize/2));this.Icon.node.setWorldPosition(i(e.x+n.x,e.y+n.y)),y.Scene.emit(T.Event.ON_ITEM_DRAGGING,this,t.touch.getUILocation())}onTouchEnd(t){if(this.isShopItem)return void(this.touchCallback&&this.touchCallback(this.data));if(!this.canDrag)return;this.Icon.node.setParent(this.Icon_Display.node.parent),this.Icon.node.setPosition(this.Icon_Display.node.position);const e=t.touch.getUILocation();y.Scene.emit(T.Event.ON_ITEM_DRAGEND,this,e)}onTouchCancel(t){if(!this.canDrag)return;this.Icon.node.setParent(this.Icon_Display.node.parent),this.Icon.node.setPosition(this.Icon_Display.node.position);const e=t.touch.getUILocation();y.Scene.emit(T.Event.ON_ITEM_DRAGEND,this,e)}onEnable(){this.node.on(I.EventType.TOUCH_START,this.onTouchStart,this),this.node.on(I.EventType.TOUCH_MOVE,this.onTouchMove,this),this.node.on(I.EventType.TOUCH_END,this.onTouchEnd,this),this.node.on(I.EventType.TOUCH_CANCEL,this.onTouchCancel,this)}onDisable(){clearInterval(this.searchTimer),this.node.off(I.EventType.TOUCH_START,this.onTouchStart,this),this.node.off(I.EventType.TOUCH_MOVE,this.onTouchMove,this),this.node.off(I.EventType.TOUCH_END,this.onTouchEnd,this),this.node.off(I.EventType.TOUCH_CANCEL,this.onTouchCancel,this)}static SetItemImageScale(t,e,n){let i=t.getComponent(s).contentSize.width,a=t.getComponent(s).contentSize.height,o=(e*T.itemSize-25)/i,h=(n*T.itemSize-25)/a,c=o>h?h:o;t.node.setScale(c,c,1)}})||b);e._RF.pop()}}}));

System.register("chunks:///_virtual/XGTS_ItemInfoPanel.ts",["cc","./NodeUtil.ts","./PanelBase.ts","./XGTS_Data.ts","./XGTS_UIManager.ts","./XGTS_Constant.ts","./BundleManager.ts","./GameManager.ts","./XGTS_GameManager.ts","./XGTS_DataManager.ts","./XGTS_AudioManager.ts","./ProjectEventManager.ts","./XGTS_PlayerInventory.ts"],(function(e){var t,n,a,s,l,o,i,c,u,r,h,I,d,P,G,f,m,g,S,T,_;return{setters:[function(e){t=e.cclegacy,n=e.Sprite,a=e.Label,s=e._decorator,l=e.instantiate,o=e.Vec3},function(e){i=e.default},function(e){c=e.PanelBase},function(e){u=e.XGTS_ItemData,r=e.XGTS_ItemType},function(e){h=e.XGTS_UIManager},function(e){I=e.XGTS_Constant},function(e){d=e.BundleManager},function(e){P=e.GameManager},function(e){G=e.XGTS_GameManager},function(e){f=e.XGTS_DataManager},function(e){m=e.XGTS_AudioManager,g=e.XGTS_Audio},function(e){S=e.ProjectEventManager,T=e.ProjectEvent},function(e){_=e.default}],execute:function(){var b;t._RF.push({},"880f3/H8jlPua0a/zJdnzXR","XGTS_ItemInfoPanel",void 0);const{ccclass:B,property:p}=s;e("default",B("XGTS_ItemInfoPanel")(b=class extends c{constructor(...e){super(...e),this.Panel=null,this.Icon=null,this.TitleLabel=null,this.MoneyLabel=null,this.DescLabel=null,this.Buttons=null,this.Button=null,this.Button_GaiZhuang=null,this.data=null,this.callback=null}onLoad(){this.Panel=i.GetNode("Panel",this.node),this.Icon=i.GetComponent("Icon",this.node,n),this.TitleLabel=i.GetComponent("TitleLabel",this.node,a),this.MoneyLabel=i.GetComponent("MoneyLabel",this.node,a),this.DescLabel=i.GetComponent("DescLabel",this.node,a),this.Button=i.GetNode("Button",this.node),this.Buttons=i.GetNode("Buttons",this.node),this.Button_GaiZhuang=i.GetNode("Button_GaiZhuang",this.node)}Reset(){this.DescLabel.string=""}Show(e,t=!1,n=null){if(super.Show(this.Panel),this.data=e,this.callback=n,this.Reset(),this.Button.active=!t,this.Buttons.active=t,this.Button_GaiZhuang.active=u.IsGun(e.Type),this.TitleLabel.string=`${e.Name}`,this.MoneyLabel.string=`${e.Price}`,e.Type==r.Weapon){let t=f.AmmoData.filter((t=>t.Type==e.WeaponData.AmmoType)),n="";for(let e=0;e<t.length;e++)n+=`\t\t\t${t[e].Name}\n`;this.DescLabel.string=`子弹类型：\n${n}`}d.LoadSpriteFrame(P.GameData.DefaultBundle,`Res/Items/${e.ImageId}`).then((e=>{this.Icon.spriteFrame=e,G.SetImagePreferScale(this.Icon,300,300)})),S.emit(T.页面转换,P.GameData.gameName)}OnButtonClick(e){switch(m.Instance.PlaySFX(g.ButtonClick),e.target.name){case"Mask":h.Instance.HidePanel(I.Panel.ItemInfoPanel);break;case"Button_Sell":this.callback&&this.callback("Sell"),h.Instance.HidePanel(I.Panel.ItemInfoPanel);break;case"Button_Takeoff":this.callback&&this.callback("Takeoff"),h.Instance.HidePanel(I.Panel.ItemInfoPanel);break;case"Button_GaiZhuang":d.LoadPrefab(P.GameData.DefaultBundle,"UI/PlayerInventory").then((e=>{h.Instance.ShowPanel(I.Panel.AccessoriesPanel,[this.data,t=>{let n=l(e);n.setParent(t),n.setPosition(o.ZERO);let a=n.getComponent(_);return a.InitPlayerInventory(),a}])}));break;case"CloseButton":h.Instance.HidePanel(I.Panel.ItemInfoPanel);break;case"Button":this.callback&&this.callback(this.data),h.Instance.HidePanel(I.Panel.ItemInfoPanel)}}})||b);t._RF.pop()}}}));

System.register("chunks:///_virtual/XGTS_ItemNameTitle.ts",["cc","./NodeUtil.ts","./XGTS_Constant.ts"],(function(t){var e,o,n,a,i,s,l,r;return{setters:[function(t){e=t.cclegacy,o=t.Component,n=t.Label,a=t.Sprite,i=t.color,s=t._decorator},function(t){l=t.default},function(t){r=t.XGTS_QualityColorHex}],execute:function(){var c;e._RF.push({},"838694RBbpKEb3m3GuSB9wn","XGTS_ItemNameTitle",void 0);const{ccclass:u,property:m}=s;t("default",u("XGTS_ItemNameTitle")(c=class extends o{constructor(...t){super(...t),this.Label=null,this.QualityBar=null}onLoad(){this.Label=this.node.getComponent(n),this.QualityBar=l.GetNode("QualityBar",this.node)}Init(){this.QualityBar.getComponent(a).color=i().fromHEX(r.Epic)}start(){}})||c);e._RF.pop()}}}));

System.register("chunks:///_virtual/XGTS_Joystick_Double.ts",["cc","./EventManager.ts","./XGTS_Constant.ts","./NodeUtil.ts"],(function(t){var e,s,i,o,n,h,_,c,a,T,E,y,u,d;return{setters:[function(t){e=t.cclegacy,s=t.Component,i=t.Vec2,o=t.Node,n=t.UITransform,h=t.Vec3,_=t.v2,c=t.input,a=t.Input,T=t.KeyCode,E=t._decorator},function(t){y=t.EventManager},function(t){u=t.XGTS_Constant},function(t){d=t.default}],execute:function(){var k;e._RF.push({},"35841V5gCRBWJgrk30EhjUW","XGTS_Joystick_Double",void 0);const{ccclass:l,property:r}=E;t("XGTS_Joystick_double",l("XGTS_Joystick_double")(k=class extends s{constructor(...t){super(...t),this._joystickBases=[],this._joystickDots=[],this._attack=null,this._attackDot=null,this._movementTouch=null,this._attackMovementTouch=null,this._movementTouches=[null,null],this._keys=[],this._dir=new i(0,0),this._dir1=new i(0,0),this._dir2=new i(0,0)}onLoad(){let t=d.GetNode("JoystickArea_1",this.node);t.on(o.EventType.TOUCH_START,this.OnTouchStart.bind(this,1),this),t.on(o.EventType.TOUCH_MOVE,this.OnTouchMove.bind(this,1),this),t.on(o.EventType.TOUCH_END,this.OnTouchEnd.bind(this,1),this),t.on(o.EventType.TOUCH_CANCEL,this.OnTouchEnd.bind(this,1),this);let e=d.GetNode("JoystickArea_2",this.node);e.on(o.EventType.TOUCH_START,this.OnTouchStart.bind(this,2),this),e.on(o.EventType.TOUCH_MOVE,this.OnTouchMove.bind(this,2),this),e.on(o.EventType.TOUCH_END,this.OnTouchEnd.bind(this,2),this),e.on(o.EventType.TOUCH_CANCEL,this.OnTouchEnd.bind(this,2),this),this._joystickBases=[d.GetNode("JoystickBase_1",this.node),d.GetNode("JoystickBase_2",this.node)],this._joystickDots=[this._joystickBases[0].getChildByName("JoystickDot"),this._joystickBases[1].getChildByName("JoystickDot")],this._attack=this.node.getChildByName("Attack"),this._attackDot=this._attack.getChildByName("AttackDot"),this._attack.on(o.EventType.TOUCH_START,this.OnAttackTouchStart,this),this._attack.on(o.EventType.TOUCH_MOVE,this.OnAttackTouchMove,this),this._attack.on(o.EventType.TOUCH_END,this.OnAttackTouchEnd,this),this._attack.on(o.EventType.TOUCH_CANCEL,this.OnAttackTouchEnd,this)}start(){}OnTouchStart(t,e){let s=e.getTouches();for(let e=0;e<s.length;++e){let i=s[e];i.getUILocationX(),i.getUILocationY();this._movementTouches[t-1]||(this._joystickDots[t-1].setPosition(0,0,0),this._movementTouches[t-1]=i)}}OnTouchMove(t,e){let s=e.getTouches();for(let e=0;e<s.length;++e){let i=s[e];if(this._movementTouches[t-1]&&i.getID()==this._movementTouches[t-1].getID()){let e=i.getUILocationX(),s=i.getUILocationY(),o=this._joystickBases[t-1].position,h=e-this.node.getComponent(n).width/2-o.x,_=s-this.node.getComponent(n).height/2-o.y,c=Math.sqrt(h*h+_*_);if(c<=0)return;let a=h/c,T=_/c,E=this._joystickBases[t-1].getComponent(n).width/2;c>E&&(c=E,h=a*E,_=T*E),this._joystickDots[t-1].setPosition(h,_,0),y.Scene.emit(u.Event.MOVEMENT+"_"+t,a,T,c/E)}}}OnTouchEnd(t,e){let s=e.getTouches();for(let e=0;e<s.length;++e){let i=s[e];this._movementTouches[t-1]&&i.getID()==this._movementTouches[t-1].getID()&&(y.Scene.emit(u.Event.MOVEMENT_STOP+"_"+t),this._movementTouches[t-1]=null,this._joystickDots[t-1].setPosition(h.ZERO))}}OnAttackTouchStart(t){let e=t.getTouches();y.Scene.emit(u.Event.FIRE_START);for(let t=0;t<e.length;++t){let s=e[t];s.getUILocationX(),s.getUILocationY();this._attackMovementTouch||(this._attackDot.setPosition(0,0,0),this._attackMovementTouch=s)}}OnAttackTouchMove(t){let e=t.getTouches();for(let t=0;t<e.length;++t){let s=e[t];if(this._attackMovementTouch&&s.getID()==this._attackMovementTouch.getID()){let t=s.getUILocationX(),e=s.getUILocationY(),i=this._attack.position,o=t-this.node.getComponent(n).width/2-i.x,h=e-this.node.getComponent(n).height/2-i.y,c=Math.sqrt(o*o+h*h);if(c<=0)return;let a=o/c,T=h/c,E=this._attack.getComponent(n).width/2;c>E&&(c=E,o=a*E,h=T*E),this._attackDot.setPosition(o,h,0),y.Scene.emit(u.Event.SET_ATTACK_DIR,_(a,T))}}}OnAttackTouchEnd(t){let e=t.getTouches();y.Scene.emit(u.Event.FIRE_STOP);for(let t=0;t<e.length;++t){let s=e[t];this._attackMovementTouch&&s.getID()==this._attackMovementTouch.getID()&&(this._attackMovementTouch=null,this._attackDot.setPosition(h.ZERO))}}onEnable(){c.on(a.EventType.KEY_DOWN,this.onKeyDown,this),c.on(a.EventType.KEY_UP,this.onKeyUp,this)}onDisable(){c.off(a.EventType.KEY_DOWN,this.onKeyDown,this),c.off(a.EventType.KEY_UP,this.onKeyUp,this)}onKeyDown(t){let e=t.keyCode;e!=T.KEY_A&&e!=T.KEY_S&&e!=T.KEY_D&&e!=T.KEY_W&&e!=T.ARROW_LEFT&&e!=T.ARROW_RIGHT&&e!=T.ARROW_UP&&e!=T.ARROW_DOWN||-1==this._keys.indexOf(e)&&(this._keys.push(e),this.updateDirection()),e.SPACE}onKeyUp(t){let e=t.keyCode;if(e==T.KEY_A||e==T.KEY_S||e==T.KEY_D||e==T.KEY_W||e==T.ARROW_LEFT||e==T.ARROW_RIGHT||e==T.ARROW_UP||e==T.ARROW_DOWN){let t=this._keys.indexOf(e);if(-1!=t){switch(this._keys.splice(t,1),e){case T.KEY_A:case T.KEY_D:this._dir1.x=0;break;case T.KEY_W:case T.KEY_S:this._dir1.y=0;break;case T.ARROW_LEFT:case T.ARROW_RIGHT:this._dir2.x=0;break;case T.ARROW_UP:case T.ARROW_DOWN:this._dir2.y=0}this.updateDirection()}}}updateDirection(){this._keys.some((t=>t==T.KEY_A))&&(this._dir1.x=-1),this._keys.some((t=>t==T.KEY_D))&&(this._dir1.x=1),this._keys.some((t=>t==T.KEY_W))&&(this._dir1.y=1),this._keys.some((t=>t==T.KEY_S))&&(this._dir1.y=-1),this._keys.some((t=>t==T.ARROW_LEFT))&&(this._dir2.x=-1),this._keys.some((t=>t==T.ARROW_RIGHT))&&(this._dir2.x=1),this._keys.some((t=>t==T.ARROW_UP))&&(this._dir2.y=1),this._keys.some((t=>t==T.ARROW_DOWN))&&(this._dir2.y=-1),y.Scene.emit(u.Event.MOVEMENT_1,this._dir1.x,this._dir1.y,1),y.Scene.emit(u.Event.MOVEMENT_2,this._dir2.x,this._dir2.y,1)}})||k);e._RF.pop()}}}));

System.register("chunks:///_virtual/XGTS_Joystick.ts",["cc","./EventManager.ts","./XGTS_Constant.ts"],(function(t){var e,o,i,s,n,h,c,a,_,T,E,u,k;return{setters:[function(t){e=t.cclegacy,o=t.Component,i=t.Vec2,s=t.Node,n=t.UITransform,h=t.Vec3,c=t.v2,a=t.input,_=t.Input,T=t.KeyCode,E=t._decorator},function(t){u=t.EventManager},function(t){k=t.XGTS_Constant}],execute:function(){var l;e._RF.push({},"a00d9JFDTRDArslrKqNw8TD","XGTS_Joystick",void 0);const{ccclass:y,property:r}=E;t("XGTS_Joystick",y("XGTS_Joystick")(l=class extends o{constructor(...t){super(...t),this._joystickBase=null,this._joystickDot=null,this._attack=null,this._attackDot=null,this._movementTouch=null,this._attackMovementTouch=null,this._keys=[],this._dir=new i(0,0)}onLoad(){let t=this.node.getChildByName("JoystickArea");t.on(s.EventType.TOUCH_START,this.OnTouchStart,this),t.on(s.EventType.TOUCH_MOVE,this.OnTouchMove,this),t.on(s.EventType.TOUCH_END,this.OnTouchEnd,this),t.on(s.EventType.TOUCH_CANCEL,this.OnTouchEnd,this),this._joystickBase=this.node.getChildByName("JoystickBase"),this._joystickDot=this._joystickBase.getChildByName("JoystickDot"),this._attack=this.node.getChildByName("Attack"),this._attackDot=this._attack.getChildByName("AttackDot"),this._attack.on(s.EventType.TOUCH_START,this.OnAttackTouchStart,this),this._attack.on(s.EventType.TOUCH_MOVE,this.OnAttackTouchMove,this),this._attack.on(s.EventType.TOUCH_END,this.OnAttackTouchEnd,this),this._attack.on(s.EventType.TOUCH_CANCEL,this.OnAttackTouchEnd,this)}start(){}OnTouchStart(t){let e=t.getTouches();for(let t=0;t<e.length;++t){let o=e[t];o.getUILocationX(),o.getUILocationY();this._movementTouch||(this._joystickDot.setPosition(0,0,0),this._movementTouch=o)}}OnTouchMove(t){let e=t.getTouches();for(let t=0;t<e.length;++t){let o=e[t];if(this._movementTouch&&o.getID()==this._movementTouch.getID()){let t=o.getUILocationX(),e=o.getUILocationY(),i=this._joystickBase.position,s=t-this.node.getComponent(n).width/2-i.x,h=e-this.node.getComponent(n).height/2-i.y,c=Math.sqrt(s*s+h*h);if(c<=0)return;let a=s/c,_=h/c,T=this._joystickBase.getComponent(n).width/2;c>T&&(c=T,s=a*T,h=_*T),this._joystickDot.setPosition(s,h,0),u.Scene.emit(k.Event.MOVEMENT,a,_,c/T)}}}OnTouchEnd(t){let e=t.getTouches();for(let t=0;t<e.length;++t){let o=e[t];this._movementTouch&&o.getID()==this._movementTouch.getID()&&(u.Scene.emit(k.Event.MOVEMENT_STOP),this._movementTouch=null,this._joystickDot.setPosition(h.ZERO))}}OnAttackTouchStart(t){let e=t.getTouches();u.Scene.emit(k.Event.FIRE_START);for(let t=0;t<e.length;++t){let o=e[t];o.getUILocationX(),o.getUILocationY();this._attackMovementTouch||(this._attackDot.setPosition(0,0,0),this._attackMovementTouch=o)}}OnAttackTouchMove(t){let e=t.getTouches();for(let t=0;t<e.length;++t){let o=e[t];if(this._attackMovementTouch&&o.getID()==this._attackMovementTouch.getID()){let t=o.getUILocationX(),e=o.getUILocationY(),i=this._attack.position,s=t-this.node.getComponent(n).width/2-i.x,h=e-this.node.getComponent(n).height/2-i.y,a=Math.sqrt(s*s+h*h);if(a<=0)return;let _=s/a,T=h/a,E=this._attack.getComponent(n).width/2;a>E&&(a=E,s=_*E,h=T*E),this._attackDot.setPosition(s,h,0),u.Scene.emit(k.Event.SET_ATTACK_DIR,c(_,T))}}}OnAttackTouchEnd(t){let e=t.getTouches();u.Scene.emit(k.Event.FIRE_STOP);for(let t=0;t<e.length;++t){let o=e[t];this._attackMovementTouch&&o.getID()==this._attackMovementTouch.getID()&&(this._attackMovementTouch=null,this._attackDot.setPosition(h.ZERO))}}onEnable(){a.on(_.EventType.KEY_DOWN,this.onKeyDown,this),a.on(_.EventType.KEY_UP,this.onKeyUp,this)}onDisable(){a.off(_.EventType.KEY_DOWN,this.onKeyDown,this),a.off(_.EventType.KEY_UP,this.onKeyUp,this)}onKeyDown(t){let e=t.keyCode;e!=T.KEY_A&&e!=T.KEY_S&&e!=T.KEY_D&&e!=T.KEY_W||-1==this._keys.indexOf(e)&&(this._keys.push(e),this.updateDirection()),e.SPACE}onKeyUp(t){let e=t.keyCode;if(e==T.KEY_A||e==T.KEY_S||e==T.KEY_D||e==T.KEY_W){let t=this._keys.indexOf(e);if(-1!=t){switch(this._keys.splice(t,1),e){case T.KEY_A:case T.KEY_D:this._dir.x=0;break;case T.KEY_W:case T.KEY_S:this._dir.y=0}this.updateDirection()}}}updateDirection(){this._keys.some((t=>t==T.KEY_A))&&(this._dir.x=-1),this._keys.some((t=>t==T.KEY_D))&&(this._dir.x=1),this._keys.some((t=>t==T.KEY_W))&&(this._dir.y=1),this._keys.some((t=>t==T.KEY_S))&&(this._dir.y=-1),u.Scene.emit(k.Event.MOVEMENT,this._dir.x,this._dir.y,1)}})||l);e._RF.pop()}}}));

System.register("chunks:///_virtual/XGTS_LootManager.ts",["cc","./XGTS_DataManager.ts"],(function(t){var e,o,n;return{setters:[function(t){e=t.cclegacy,o=t.misc},function(t){n=t.XGTS_DataManager}],execute:function(){e._RF.push({},"efe09Ela5pP36tc7FLulAKd","XGTS_LootManager",void 0);t("XGTS_LootManager",class{static GetContainerResult(t){const e=n.ContainerLootMap.get(t);if(!e)return console.warn(`No drop table found for container: ${t}`),[];const r=[];let a=o.clampf(Math.round(5*Math.random()),1,5);for(let t=0;t<a;t++){const t=this.GetRandomItem(e);if(t){let e=n.GetItemDataByType(t.Type,t.ID);e?(e.Searched=!1,r.push(e)):console.error("找不到数据",t)}}return r}static GetRandomItem(t){const e=t.reduce(((t,e)=>t+e.Probability),0);if(e<=0)return null;const o=Math.random()*e;let n=0;for(const e of t)if(n+=e.Probability,o<=n)return e;return null}static GetRandomItemInPrizePool(){let t=n.PrizePoolData;const e=t.reduce(((t,e)=>t+e.Probability),0);if(e<=0)return null;const o=Math.random()*e;let r=0;for(const e of t)if(r+=e.Probability,o<=r)return e;return null}}),e._RF.pop()}}}));

System.register("chunks:///_virtual/XGTS_LvManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./XGTS_Constant.ts","./XGTS_GameManager.ts","./PrefsManager.ts","./UIManager.ts","./XGTS_DataManager.ts","./BundleManager.ts","./GameManager.ts","./XGTS_CharacterController.ts","./XGTS_CameraController.ts","./XGTS_Data.ts","./XGTS_AudioManager.ts","./EventManager.ts","./XGTS_UIManager.ts","./Tools.ts","./XGTS_CharacterFengYi_Double.ts"],(function(e){var t,a,n,i,s,r,l,o,u,h,c,d,p,y,g,f,I,G,m,S,M,P,T,b,_,D,C,E,L,N,v,O,X,B;return{setters:[function(e){t=e.applyDecoratedDescriptor,a=e.initializerDefineProperty},function(e){n=e.cclegacy,i=e.Node,s=e.TiledMap,r=e.CCString,l=e.Vec2,o=e._decorator,u=e.Component,h=e.sys,c=e.RigidBody2D,d=e.ERigidBody2DType,p=e.BoxCollider2D,y=e.UITransform,g=e.v2,f=e.instantiate,I=e.Layout},function(e){G=e.XGTS_Constant},function(e){m=e.XGTS_GameManager},function(e){S=e.default},function(e){M=e.UIManager,P=e.Panel},function(e){T=e.XGTS_DataManager},function(e){b=e.BundleManager},function(e){_=e.GameManager},function(e){D=e.default},function(e){C=e.default},function(e){E=e.XGTS_MatchData},function(e){L=e.XGTS_AudioManager,N=e.XGTS_Audio},function(e){v=e.EventManager},function(e){O=e.XGTS_UIManager},function(e){X=e.Tools},function(e){B=e.default}],execute:function(){var w,z,A,R,U,x,H,W,F,q,K,k,Z,j,J,V,Y,$,Q,ee;n._RF.push({},"1a4fc/XAuhL6oZwzoJiW2k8","XGTS_LvManager",void 0);const{ccclass:te,property:ae}=o;e("XGTS_LvManager",(w=te("XGTS_LvManager"),z=ae(i),A=ae(i),R=ae(s),U=ae(i),x=ae(i),H=ae({type:[i]}),W=ae(r),F=ae(l),w(((ee=class e extends u{constructor(...e){super(...e),a(this,"Game",k,this),a(this,"UI",Z,this),a(this,"tiledMap",j,this),a(this,"playerPosition",J,this),a(this,"GuideTarget",V,this),a(this,"Guides",Y,this),this.guideIndex=-1,a(this,"MapName",$,this),a(this,"MapSize",Q,this),this.Layer_Supplies=null,this.Layer_Characters=null,this.Layer_Effects=null,this.matchData=null,this.playerPrefab=null,this.playerPrefabs=[],this.isRigistedEvent=!1,this.isToTutorial=!1}onLoad(){m.IsGameOver=!1,e.Instance=this,this.InitMap(),this.Layer_Supplies=this.Game.getChildByName("Supplies"),this.Layer_Characters=this.Game.getChildByName("Characters"),this.Layer_Effects=this.Game.getChildByName("Effects"),this.Layer_Supplies||console.error("Game 下面没有叫 Supplies 的节点"),this.Layer_Characters||console.error("Game 下面没有叫 Characters 的节点"),this.Layer_Effects||console.error("Game 下面没有叫 Effects 的节点"),this.matchData=new E(this.MapName,"",0,0,0,0),this.matchData.MapName=this.MapName,this.RigistEvent(),"特勤处"==this.MapName?(L.Instance.StopBGM(),L.Instance.PlayBGM(N.BG)):(L.Instance.StopBGM(),L.Instance.PlayBGM(N.游戏内BGM))}start(){"特勤处"==this.matchData.MapName?this.InitPlayer():m.IsDoubleMode?this.InitDoublePlayer():this.InitPlayer();const e=h.localStorage.getItem(G.Key.isHavePassTutorial);console.log(e),"训练场"===this.matchData.MapName||e&&null!=e&&"false"!==e?(console.log("不是第一次"),S.GetBool(G.Key.FirstPutInventory,!0)&&"特勤处"==this.matchData.MapName&&O.Instance.ShowPanel(G.Panel.TutorialPanel)):(console.log("第一次进入游戏"),h.localStorage.setItem(G.Key.isHavePassTutorial,!1),T.SetDefaultEquip(T.PlayerDatas[0]),T.SetDefaultEquip(T.PlayerDatas[1]),T.SetDefaultEquip(T.PlayerDatas[2]),m.isChangeScene=!0,this.isToTutorial=!0,M.ShowPanel(P.LoadingPanel,"XGTS_Tutorial"))}InitMap(){let e=this.tiledMap.getTileSize(),t=this.tiledMap.getLayer("Obstacle");for(let a=0;a<t.getLayerSize().width;a++)for(let n=0;n<t.getLayerSize().height;n++){let i=t.getTiledTileAt(a,n,!0);if(0!=i.grid){let t=i.node.addComponent(c);t.type=d.Static;let a=i.node.addComponent(p);t.group=G.Group.Obstacle,a.group=G.Group.Obstacle,i.node.getComponent(y).setContentSize(e.width,e.height),a.offset=g(e.width/2,e.height/2),a.size=e,a.apply()}}}destoryPlayer(){m.Instance.player&&m.Instance.player.destroy(),m.Instance.playerNode&&m.Instance.playerNode.destroy(),m.Instance.player=null,m.Instance.playerNode=null,C.Instance.target=null,C.Instance.player1=null,C.Instance.player2=null,m.Instance.playerNodes.forEach((e=>{e.destroy()})),m.Instance.players.forEach((e=>{e.destroy()})),m.Instance.playerNodes=[],m.Instance.players=[]}InitPlayer(){this.destoryPlayer();let t=t=>{let a=f(t);a.setParent(this.Layer_Characters),a.setWorldPosition(this.playerPosition.worldPosition),m.Instance.playerNode=a,m.Instance.player=a.getComponent(D),C.Instance.target=a,e.Instance.Guides&&e.Instance.Guides.length>0?this.AddGuideIndex():e.Instance.GuideTarget&&v.Scene.emit(G.Event.SHOW_TUTORIAL,e.Instance.GuideTarget)};this.playerPrefab?t(this.playerPrefab):b.LoadPrefab(_.GameData.DefaultBundle,"Player").then((e=>{this.isToTutorial||(t(e),this.playerPrefab=e)}))}InitDoublePlayer(){this.destoryPlayer();let t=t=>{let a=[];t.forEach((e=>{let t=f(e);a.push(t)}));let n=new i;n.setParent(this.Layer_Characters),n.setWorldPosition(this.playerPosition.worldPosition);let s=n.addComponent(I);s.type=I.Type.HORIZONTAL,s.resizeMode=I.ResizeMode.CONTAINER,a.forEach((e=>{e.setParent(n),"Player_1"==e.name&&e.setSiblingIndex(0)})),s.updateLayout(),s.enabled=!1,a.forEach((e=>{let t=e.worldPosition;e.setParent(this.Layer_Characters),e.setWorldPosition(t),m.Instance.playerNodes.push(e),m.Instance.players.push(e.getComponent(B))})),n.destroy(),C.Instance.setDoublePlayer(a[0],a[1]),e.Instance.Guides&&e.Instance.Guides.length>0?this.AddGuideIndex():e.Instance.GuideTarget&&v.Scene.emit(G.Event.SHOW_TUTORIAL,e.Instance.GuideTarget)};if(2==this.playerPrefabs.length)t(this.playerPrefabs);else{this.playerPrefabs=[],["Player_1","Player_2"].forEach((e=>{b.LoadPrefab(_.GameData.DefaultBundle,e).then((e=>{this.playerPrefabs.push(e),2==this.playerPrefabs.length&&t(this.playerPrefabs)}))}))}}AddGuideIndex(){this.guideIndex=X.Clamp(this.guideIndex+1,0,this.Guides.length-1),console.log(`显示第 ${this.guideIndex} 个引导`),v.Scene.emit(G.Event.SHOW_TUTORIAL,e.Instance.Guides[this.guideIndex])}OnChangeDoubleMode(){this.InitDoublePlayer()}OnChangeSingleMode(){this.InitPlayer()}update(e){m.IsGameOver||(this.matchData.Time+=e)}RigistEvent(){v.Scene.on(G.Event.CHANGE_DOUBLE_MODE,this.OnChangeDoubleMode,this),v.Scene.on(G.Event.CHANGE_SINGLE_MODE,this.OnChangeSingleMode,this)}UnRegistEvent(){v.Scene.off(G.Event.CHANGE_DOUBLE_MODE,this.OnChangeDoubleMode,this),v.Scene.off(G.Event.CHANGE_SINGLE_MODE,this.OnChangeSingleMode,this)}onDisable(){this.UnRegistEvent()}}).Instance=null,k=t((K=ee).prototype,"Game",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Z=t(K.prototype,"UI",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),j=t(K.prototype,"tiledMap",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),J=t(K.prototype,"playerPosition",[U],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),V=t(K.prototype,"GuideTarget",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Y=t(K.prototype,"Guides",[H],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),$=t(K.prototype,"MapName",[W],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),Q=t(K.prototype,"MapSize",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return g()}}),q=K))||q));n._RF.pop()}}}));

System.register("chunks:///_virtual/XGTS_Missile.ts",["cc","./XGTS_PoolManager.ts","./XGTS_Constant.ts","./XGTS_LvManager.ts","./XGTS_AudioManager.ts"],(function(t){var i,e,n,o,s,a,r,c,l,d,g,u,h,p;return{setters:[function(t){i=t.cclegacy,e=t.Component,n=t.RigidBody2D,o=t.Vec2,s=t.v3,a=t.v2,r=t.BoxCollider2D,c=t.Contact2DType,l=t._decorator},function(t){d=t.XGTS_PoolManager},function(t){g=t.XGTS_Constant},function(t){u=t.XGTS_LvManager},function(t){h=t.XGTS_AudioManager,p=t.XGTS_Audio}],execute:function(){var y;i._RF.push({},"a61a3ZjOlJJWZi0YLKFAtgl","XGTS_Missile",void 0);const{ccclass:_,property:G}=l;t("default",_("XGTS_Missile")(y=class extends e{constructor(...t){super(...t),this.rigidbody=null,this.target=null}onLoad(){this.rigidbody=this.node.getComponent(n)}Init(t){this.rigidbody.linearVelocity=o.ZERO,this.target=t;let i=s(this.node.right.clone().multiplyScalar(3e3));this.rigidbody.applyForceToCenter(a(i.x,i.y),!0),this.node.getComponent(r).on(c.BEGIN_CONTACT,this.onBeginContact,this)}onBeginContact(t,i,e){if(i.group==g.Group.Obstacle){const t=e.getWorldManifold();h.Instance.PlaySFX(p.MissileExplosion),d.Instance.Get(g.Prefab.MissileExplosion,u.Instance.Game).setWorldPosition(s(t.points[0].x,t.points[0].y)),this.scheduleOnce((()=>{d.Instance.Put(this.node)}))}}update(t){this.target&&this.target.node?(!this.target.isDie||o.distance(this.node.getWorldPosition(),this.target.node.getWorldPosition())>3500)&&(this.rigidbody.linearVelocity=o.ZERO,d.Instance.Put(this.node)):(this.rigidbody.linearVelocity=o.ZERO,d.Instance.Put(this.node))}})||y);i._RF.pop()}}}));

System.register("chunks:///_virtual/XGTS_OutputItem.ts",["cc","./NodeUtil.ts","./XGTS_PoolManager.ts","./XGTS_Constant.ts","./XGTS_CommonItem.ts"],(function(t){var e,s,n,i,o,l,a,c,u;return{setters:[function(t){e=t.cclegacy,s=t.Component,n=t.Label,i=t.Vec3,o=t._decorator},function(t){l=t.default},function(t){a=t.XGTS_PoolManager},function(t){c=t.XGTS_Constant},function(t){u=t.default}],execute:function(){var h;e._RF.push({},"f7807yA3kxDlbyzP1RSzlm9","XGTS_OutputItem",void 0);const{ccclass:m,property:r}=o;t("default",m("XGTS_OutputItem")(h=class extends s{constructor(...t){super(...t),this.Select=null,this.Item=null,this.Label=null,this.data=null,this.item=null,this.cb=null}onLoad(){this.Select=l.GetNode("Select",this.node),this.Item=l.GetNode("Item",this.node),this.Label=l.GetComponent("Label",this.node,n)}Init(t,e){if(this.data=t,this.cb=e,this.Label.string=t.Name,this.Select.active=!1,!this.item){let t=a.Instance.Get(c.Prefab.CommonItem,this.Item);this.item=t.getComponent(u),t.setPosition(i.ZERO)}this.item.InitDisplay(t)}Refresh(t){this.Select.active=t==this.data}OnButtonClick(){this.cb&&this.cb(this.data)}})||h);e._RF.pop()}}}));

System.register("chunks:///_virtual/XGTS_OutputPanel.ts",["cc","./NodeUtil.ts","./GameManager.ts","./ProjectEventManager.ts","./XGTS_Data.ts","./XGTS_GameManager.ts","./XGTS_DataManager.ts","./XGTS_PoolManager.ts","./XGTS_Constant.ts","./Tools.ts","./XGTS_UIManager.ts","./EventManager.ts","./BundleManager.ts","./PanelBase.ts","./XGTS_OutputItem.ts","./XGTS_CommonItem.ts","./UIManager.ts","./XGTS_AudioManager.ts"],(function(t){var e,a,n,o,s,i,l,u,r,m,h,I,c,d,f,p,M,D,y,b,g,G,T;return{setters:[function(t){e=t.cclegacy,a=t.Label,n=t.Sprite,o=t._decorator},function(t){s=t.default},function(t){i=t.GameManager},function(t){l=t.ProjectEventManager,u=t.ProjectEvent},function(t){r=t.XGTS_ItemType},function(t){m=t.XGTS_GameManager},function(t){h=t.XGTS_DataManager},function(t){I=t.XGTS_PoolManager},function(t){c=t.XGTS_Constant},function(t){d=t.Tools},function(t){f=t.XGTS_UIManager},function(t){p=t.EventManager},function(t){M=t.BundleManager},function(t){D=t.PanelBase},function(t){y=t.default},function(t){b=t.default},function(t){g=t.UIManager},function(t){G=t.XGTS_AudioManager,T=t.XGTS_Audio}],execute:function(){var C;e._RF.push({},"0f8ebkhr7lAK6fGJHIYgb4F","XGTS_OutputPanel",void 0);const{ccclass:N,property:S}=o;t("default",N("XGTS_OutputPanel")(C=class extends D{constructor(...t){super(...t),this.OutputItemContent=null,this.NeedMatContent=null,this.MoneyLabel=null,this.ItemNameLabel=null,this.OutputTimeLabel=null,this.TitleLabel=null,this.Icon=null,this.MatLabel=null,this.OutputButton=null,this.outputItems=[],this.matItems=[],this.data=null,this.playerNum=0,this.time=3610,this.countDownTimer=-1}onLoad(){this.MoneyLabel=s.GetComponent("MoneyLabel",this.node,a),this.ItemNameLabel=s.GetComponent("ItemNameLabel",this.node,a),this.TitleLabel=s.GetComponent("TitleLabel",this.node,a),this.OutputTimeLabel=s.GetComponent("OutputTimeLabel",this.node,a),this.Icon=s.GetComponent("Icon",this.node,n),this.NeedMatContent=s.GetNode("NeedMatContent",this.node),this.OutputItemContent=s.GetNode("OutputItemContent",this.node),this.MatLabel=s.GetNode("MatLabel",this.node),this.OutputButton=s.GetNode("OutputButton",this.node)}StartCountdown(){clearInterval(this.countDownTimer),this.countDownTimer=setInterval(this.Countdown.bind(this),1e3)}Countdown(){this.time--,this.time<=0&&(this.time=0,clearInterval(this.countDownTimer)),this.OutputTimeLabel.string=d.FormatTime(this.time)}Show(t,e){this.playerNum=e,l.emit(u.弹出窗口,i.GameData.gameName),this.outputItems.forEach((t=>I.Instance.Put(t.node))),this.outputItems=[],this.matItems.forEach((t=>I.Instance.Put(t.node))),this.matItems=[];let a=h.PlayerDatas[this.playerNum].GetWorkbenchLv(t),n=[];for(let e=1;e<=a;e++){let a=h.WorkbenchData.get(t).find((t=>t.Lv==e));for(let t=0;t<a.Making.length;t++){let e=h.GetItemDataByID(a.Making[t]);e&&n.push(e)}}for(let t=0;t<n.length;t++){let e=I.Instance.Get(c.Prefab.OutputItem,this.OutputItemContent).getComponent(y);e.Init(n[t],this.ItemCallback.bind(this)),this.outputItems.push(e)}this.TitleLabel.string=`${c.WorkbenchName[t]}`,this.MatLabel.active=!1,this.OutputButton.active=!1,this.ItemNameLabel.string="选择一项进行制造",this.Icon.spriteFrame=null,this.RefreshMoney(),l.emit(u.页面转换,i.GameData.gameName)}ItemCallback(t){this.data=t,this.RefreshInfo(t),this.outputItems.forEach((e=>e.Refresh(t)))}RefreshInfo(t){if(this.MatLabel.active=!0,this.OutputButton.active=!0,this.ItemNameLabel.string=`${t.Name}`,t.Type==r.Weapon){let e=h.WeaponData.find((e=>e.ID==t.ID));e?this.InitNeedMatItem(e.Required,e.Quantity):console.error(`WeaponData未找到武器数据：${t.Name}`)}if(t.Type==r.Helmet||t.Type==r.BodyArmor){let e=h.EquipData.find((e=>e.ID==t.ID));e?this.InitNeedMatItem(e.Required,e.Quantity):console.error(`EquipData未找到装备数据：${t.Name}`)}if(t.Type==r.Ammo){let e=h.AmmoData.find((e=>e.ID==t.ID));e?this.InitNeedMatItem(e.Required,e.Quantity):console.error(`AmmoData未找到子弹数据：${t.Name,t.ID}`)}if(t.Type==r.ArmorItem||t.Type==r.MedicalItem){let e=h.ConsumableData.find((e=>e.ID==t.ID));console.error(e.ID,e.Name,e.Required,e.Quantity),e?this.InitNeedMatItem(e.Required,e.Quantity):console.error(`ConsumableData未找到消耗品数据：${t.Name}`)}M.LoadSpriteFrame(i.GameData.DefaultBundle,`Res/Items/${t.ImageId}`).then((t=>{this.Icon.spriteFrame=t,m.SetImagePreferScale(this.Icon,800,500)}))}InitNeedMatItem(t,e){this.matItems.forEach((t=>I.Instance.Put(t.node))),this.matItems=[];let a=[];for(let n=0;n<t.length;n++){let o=d.Clone(h.GetItemDataByID(t[n]));o&&(o.Count=e[n],a.push(o))}for(let t=0;t<a.length;t++){let e=I.Instance.Get(c.Prefab.CommonItem,this.NeedMatContent).getComponent(b);e.InitDisplay(a[t]);let n=0;m.IsDoubleMode&&(n=1);let o=h.PlayerDatas[n].GetInventoryItemCount(a[t].ID),s=`<b><color=${o>=a[t].Count?"#00ff00":"#ff0000"}>${o}/${a[t].Count}</color></b>`;e.SetDescStr(s),this.matItems.push(e)}}RefreshMoney(){this.MoneyLabel.string=`${h.PlayerDatas[this.playerNum].Money}`}OnButtonClick(t){switch(G.Instance.PlaySFX(T.ButtonClick),t.target.name){case"OutputButton":let t=[];for(let e=0;e<this.matItems.length;e++){let a=0;if(m.IsDoubleMode&&(a=1),h.PlayerDatas[a].GetInventoryItemCount(this.matItems[e].data.ID)<this.matItems[e].data.Count)return void g.ShowTip("材料不足");{let a=0;m.IsDoubleMode&&(a=1);let n=h.PlayerDatas[a].InventoryItemData.filter((t=>t.ID==this.matItems[e].data.ID));for(let a=0;a<this.matItems[e].data.Count;a++)t.push(n[a])}}for(let e=0;e<t.length;e++){let a=0;m.IsDoubleMode&&(a=1),h.PlayerDatas[a].RemoveItemFromInventory(t[e])}f.Instance.ShowPanel(c.Panel.RewardPanel,[[this.data]]),this.RefreshInfo(this.data);break;case"MakeAnywayButton":let e=0;for(let t=0;t<this.matItems.length;t++)e+=this.matItems[t].data.Price*this.matItems[t].data.Count;h.PlayerDatas[this.playerNum].Money<e?g.ShowTip(`金钱不足，需要${e}`):(h.PlayerDatas[this.playerNum].Money-=e,f.Instance.ShowPanel(c.Panel.RewardPanel,[[this.data]]));break;case"ReturnButton":f.Instance.HidePanel(c.Panel.OutputPanel)}}onEnable(){p.on(c.Event.REFRESH_MONEY,this.RefreshMoney,this)}onDisable(){p.off(c.Event.REFRESH_MONEY,this.RefreshMoney,this)}})||C);e._RF.pop()}}}));

System.register("chunks:///_virtual/XGTS_PlayerData.ts",["cc","./PrefsManager.ts","./XGTS_Data.ts","./XGTS_InventoryGrid.ts","./EventManager.ts","./XGTS_Constant.ts","./XGTS_DataManager.ts","./Tools.ts"],(function(t){var a,e,i,h,n,o,s,r,c;return{setters:[function(t){a=t.cclegacy,e=t.misc},function(t){i=t.default},function(t){h=t.XGTS_ItemType},function(t){n=t.XGTS_InventoryGrid},function(t){o=t.EventManager},function(t){s=t.XGTS_Constant},function(t){r=t.XGTS_DataManager},function(t){c=t.Tools}],execute:function(){a._RF.push({},"8eb13TS3gdH77FlfYjDVhxm","XGTS_PlayerData",void 0);t("XGTS_PlayerData",class{constructor(t=1e6,a=[],e=null,i=null,h=null,o=null,s=null,r=null,c=[],D=null,m=null,l=null,p=[]){this.SafeBox={width:2,height:1,ItemData:[]},this.SingleGrids=[],this.ChestRigGrid=null,this.BackpackGrid=null,this.SafeBoxGrid=null,this.InventoryGridCtrl=null,this.money=t,this.InventoryItemData=a,this.Weapon_Primary=e,this.Weapon_Secondary=i,this.Weapon_Pistol=h,this.Weapon_Melee=o,this.Weapon_Helmet=s,this.Weapon_BodyArmor=r,this.PocketData=c,this.ChestRigData=D,this.BackpackData=m,this.safeBox=l,this.ShowcaseData=p,l&&(this.SafeBox=l),this.Money=t,this.InventoryGridCtrl=new n(1,1),this.SingleGrids=[];for(let t=0;t<5;t++)this.SingleGrids.push(new n(1,1));this.ChestRigData&&(this.ChestRigGrid=new n(this.ChestRigData.EquipData.CarryingSpace.width,this.ChestRigData.EquipData.CarryingSpace.height)),this.BackpackData&&(this.BackpackGrid=new n(this.BackpackData.EquipData.CarryingSpace.width,this.BackpackData.EquipData.CarryingSpace.height)),this.SafeBoxGrid=new n(this.SafeBox.width,this.SafeBox.height),this.Init(9,19)}get Money(){return this.money}set Money(t){t=Math.floor(t),this.money=t,o.Scene.emit(s.Event.REFRESH_MONEY)}Init(t,a){this.InventoryGridCtrl=new n(t,a);let e=this.InventoryItemData;for(let t=0;t<e.length;t++)n.PlaceItem(this.InventoryGridCtrl,e[t].Point.x,e[t].Point.y,e[t].Size.width,e[t].Size.height)}EquipChestRig(t){t.Type==h.ChestRig?(this.ChestRigData=t,this.ChestRigGrid=new n(this.ChestRigData.EquipData.CarryingSpace.width,this.ChestRigData.EquipData.CarryingSpace.height)):console.error("无法装备胸挂",t)}UnEquipChestRig(){}EquipBackpack(t){t.Type==h.Backpack?(this.BackpackData=t,this.BackpackGrid=new n(this.BackpackData.EquipData.CarryingSpace.width,this.BackpackData.EquipData.CarryingSpace.height)):console.error("无法装备背包",t)}UnEquipBackpack(){}SetSafeBox(t,a){r.PlayerData.SafeBox={width:t,height:a,ItemData:[]},this.SafeBoxGrid=new n(t,a)}AddItemToBackpack(t){this.BackpackData&&this.BackpackData.EquipData&&r.FillContainer(this.BackpackGrid,[t],this.BackpackData.EquipData.ItemData)}GetWorkbenchLv(t){return i.GetNumber(`WorkbenchLv_${t}`,0)}SetWorkbenchLv(t,a){a=e.clampf(a,1,3),i.SetNumber(`WorkbenchLv_${t}`,a)}AddItemToInventory(t){let a=this.InventoryGridCtrl.width*this.InventoryGridCtrl.height;for(let e=0;e<a;e++){let a=e%this.InventoryGridCtrl.width,i=Math.floor(e/this.InventoryGridCtrl.width);if(0==this.InventoryGridCtrl.grid[i][a]&&n.CanPlaceItem(this.InventoryGridCtrl,a,i,t.Size.width,t.Size.height))return n.PlaceItem(this.InventoryGridCtrl,a,i,t.Size.width,t.Size.height),t.Point.x=a,t.Point.y=i,console.log("仓库添加:",t),this.InventoryItemData.push(t),o.Scene.emit(s.Event.REFRESH_INVENTORY_ITEMS),r.SaveData(),!0}return!1}RemoveItemFromInventory(t){return-1!=this.InventoryItemData.indexOf(t)&&(this.InventoryItemData.splice(this.InventoryItemData.indexOf(t),1),r.SaveData(),n.RemoveItem(this.InventoryGridCtrl,t.Point.x,t.Point.y,t.Size.width,t.Size.height),console.log("仓库移除:",t),o.Scene.emit(s.Event.REFRESH_INVENTORY_ITEMS),!0)}GetInventoryItemCount(t){let a=0,e=this.InventoryItemData.filter((a=>a.ID==t));return e&&(a=e.length),a}AddItemToShowcase(t){this.ShowcaseData.push(t)}RemoveItemFromShowcase(t){-1!=this.ShowcaseData.indexOf(t)&&this.ShowcaseData.splice(this.ShowcaseData.indexOf(t),1)}RemoveItemFromBackpack(t){for(let a=0;a<this.PocketData.length;a++){const e=this.PocketData[a];-1!==e.findIndex((a=>a==t))&&(e.splice(e.indexOf(t),1),n.RemoveItem(this.SingleGrids[a],t.Point.x,t.Point.y,t.Size.width,t.Size.height))}this.ChestRigData&&-1!==this.ChestRigData.EquipData.ItemData.findIndex((a=>a==t))&&(this.ChestRigData.EquipData.ItemData.splice(this.ChestRigData.EquipData.ItemData.indexOf(t),1),n.RemoveItem(this.ChestRigGrid,t.Point.x,t.Point.y,t.Size.width,t.Size.height)),this.BackpackData&&-1!==this.BackpackData.EquipData.ItemData.findIndex((a=>a==t))&&(this.BackpackData.EquipData.ItemData.splice(this.BackpackData.EquipData.ItemData.indexOf(t),1),n.RemoveItem(this.ChestRigGrid,t.Point.x,t.Point.y,t.Size.width,t.Size.height)),this.SafeBox&&-1!==this.SafeBox.ItemData.findIndex((a=>a==t))&&(this.SafeBox.ItemData.splice(this.SafeBox.ItemData.indexOf(t),1),n.RemoveItem(this.SafeBoxGrid,t.Point.x,t.Point.y,t.Size.width,t.Size.height)),o.Scene.emit(s.Event.REFRESH_BACKPACK_ITEMS)}ClearBackpack(){this.Weapon_Primary=null,this.Weapon_Secondary=null,this.Weapon_Pistol=null,this.Weapon_Helmet=null,this.Weapon_BodyArmor=null,this.ChestRigData=null,this.BackpackData=null;for(let t=0;t<this.PocketData.length;t++){const a=this.PocketData[t];a.forEach((a=>{n.RemoveItem(this.SingleGrids[t],a.Point.x,a.Point.y,a.Size.width,a.Size.height)})),a.length=0}r.SaveData()}GetBackpackAllItemByType(t){let a=[];for(let e=0;e<this.PocketData.length;e++){const i=this.PocketData[e].filter((a=>a.Type==t));a.push(...i)}if(this.ChestRigData){const e=this.ChestRigData.EquipData.ItemData.filter((a=>a.Type==t));a.push(...e)}if(this.BackpackData){const e=this.BackpackData.EquipData.ItemData.filter((a=>a.Type==t));a.push(...e)}if(this.SafeBox){const e=this.SafeBox.ItemData.filter((a=>a.Type==t));a.push(...e)}return a}GetBackpackItem(t){let a=null;for(let e=0;e<this.PocketData.length;e++){if(a=this.PocketData[e].find((a=>a.Name==t)),a)return a}return this.ChestRigData&&(a=this.ChestRigData.EquipData.ItemData.find((a=>a.Name==t)),a)||this.BackpackData&&(a=this.BackpackData.EquipData.ItemData.find((a=>a.Name==t)),a)||this.SafeBox&&(a=this.SafeBox.ItemData.find((a=>a.Name==t))),a}GetAmmoByType(t,a){for(let e=0;e<this.PocketData.length;e++){const i=this.PocketData[e],n=i.find((a=>a.Type==h.Ammo&&a.AmmoData.Type==t));if(n)return a>=n.Count&&c.RemoveItemFromArray(i,n),n}if(this.ChestRigData){const e=this.ChestRigData.EquipData.ItemData.find((a=>a.Type==h.Ammo&&a.AmmoData.Type==t));if(e)return a>=e.Count&&(c.RemoveItemFromArray(this.ChestRigData.EquipData.ItemData,e),console.error("移除",this.ChestRigData.EquipData.ItemData,e)),e}if(this.BackpackData){const e=this.BackpackData.EquipData.ItemData.find((a=>a.Type==h.Ammo&&a.AmmoData.Type==t));if(e)return a>=e.Count&&c.RemoveItemFromArray(this.BackpackData.EquipData.ItemData,e),e}if(this.SafeBox){const e=this.SafeBox.ItemData.find((a=>a.Type==h.Ammo&&a.AmmoData.Type==t));if(e)return a>=e.Count&&c.RemoveItemFromArray(this.SafeBox.ItemData,e),e}return null}GetFirstAmmoType(){for(let t=0;t<this.PocketData.length;t++){const a=this.PocketData[t].find((t=>t.Type==h.Ammo));if(a)return a.AmmoData.Type}if(this.ChestRigData){const t=this.ChestRigData.EquipData.ItemData.find((t=>t.Type==h.Ammo));if(t)return t.AmmoData.Type}if(this.BackpackData){const t=this.BackpackData.EquipData.ItemData.find((t=>t.Type==h.Ammo));if(t)return t.AmmoData.Type}if(this.SafeBox){const t=this.SafeBox.ItemData.find((t=>t.Type==h.Ammo));if(t)return t.AmmoData.Type}return null}GetAmmoCountByType(t){let a=0;for(let e=0;e<this.PocketData.length;e++)for(let i=0;i<this.PocketData[e].length;i++){let n=this.PocketData[e][i];n.Type==h.Ammo&&n.AmmoData.Type==t&&(a+=n.Count)}if(this.ChestRigData)for(let e=0;e<this.ChestRigData.EquipData.ItemData.length;e++){let i=this.ChestRigData.EquipData.ItemData[e];i.Type==h.Ammo&&i.AmmoData.Type==t&&(a+=i.Count)}if(this.BackpackData)for(let e=0;e<this.BackpackData.EquipData.ItemData.length;e++){let i=this.BackpackData.EquipData.ItemData[e];i.Type==h.Ammo&&i.AmmoData.Type==t&&(a+=i.Count)}if(this.SafeBox)for(let e=0;e<this.SafeBox.ItemData.length;e++){let i=this.SafeBox.ItemData[e];i.Type==h.Ammo&&i.AmmoData.Type==t&&(a+=i.Count)}return a}GetInventoryItemByType(t){return this.InventoryItemData.filter((a=>a.Type==t))}GetTotalValue(){let t=0;if(this.Weapon_Primary&&(t+=this.Weapon_Primary.Price),this.Weapon_Secondary&&(t+=this.Weapon_Secondary.Price),this.Weapon_Pistol&&(t+=this.Weapon_Pistol.Price),this.Weapon_Helmet&&(t+=this.Weapon_Helmet.Price),this.Weapon_BodyArmor&&(t+=this.Weapon_BodyArmor.Price),this.PocketData)for(let a=0;a<this.PocketData.length;a++){const e=this.PocketData[a];e[0]&&(t+=e[0].Price)}if(this.ChestRigData){t+=this.ChestRigData.Price;for(let a=0;a<this.ChestRigData.EquipData.ItemData.length;a++){let a=this.ChestRigData.EquipData.ItemData;for(let e=0;e<a.length;e++)a[e]&&(t+=a[e].Price)}}if(this.BackpackData){t+=this.BackpackData.Price;for(let a=0;a<this.BackpackData.EquipData.ItemData.length;a++){let a=this.BackpackData.EquipData.ItemData;for(let e=0;e<a.length;e++)a[e]&&(t+=a[e].Price)}}if(this.SafeBox)for(let a=0;a<this.SafeBox.ItemData.length;a++){let a=this.SafeBox.ItemData;for(let e=0;e<a.length;e++)a[e]&&(t+=a[e].Price)}return Math.floor(t)}}),a._RF.pop()}}}));

System.register("chunks:///_virtual/XGTS_PlayerInventory.ts",["cc","./NodeUtil.ts","./XGTS_Inventory.ts","./XGTS_DataManager.ts","./EventManager.ts","./XGTS_Constant.ts","./XGTS_GameManager.ts"],(function(t){var n,e,r,o,a,s,l,i,c,S;return{setters:[function(t){n=t.cclegacy,e=t.UITransform,r=t.ScrollView,o=t._decorator},function(t){a=t.default},function(t){s=t.default},function(t){l=t.XGTS_DataManager},function(t){i=t.EventManager},function(t){c=t.XGTS_Constant},function(t){S=t.XGTS_GameManager}],execute:function(){var u;n._RF.push({},"d6771RosshFNJAsXmp3r4Ia","XGTS_PlayerInventory",void 0);const{ccclass:I,property:g}=o;t("default",I("XGTS_PlayerInventory")(u=class extends s{constructor(...t){super(...t),this.ScrollView=null}onLoad(){this.ItemContent=a.GetNode("ItemContent",this.node),this.ItemContentTrans=this.ItemContent.getComponent(e),this.ScrollView=a.GetComponent("ScrollView",this.node,r)}InitPlayerInventory(){let t=0;S.IsDoubleMode&&(t=1),super.Init(l.PlayerDatas[t].InventoryItemData,l.PlayerDatas[t].InventoryGridCtrl)}OnDragStart(t){this.ScrollView.enabled=!1,super.OnDragStart(t)}OnDragging(t,n){super.OnDragging(t,n)}OnDragEnd(t,n){let e=this.ScrollView.getScrollOffset();this.ScrollView.enabled=!0,super.OnDragEnd(t,n),this.ScrollView.scrollToOffset(e,0)}onEnable(){i.Scene.on(c.Event.REFRESH_INVENTORY_ITEMS,this.InitPlayerInventory,this)}onDisable(){i.Scene.off(c.Event.REFRESH_INVENTORY_ITEMS,this.InitPlayerInventory,this)}})||u);n._RF.pop()}}}));

System.register("chunks:///_virtual/XGTS_PoolManager.ts",["cc"],(function(t){var e,s,o;return{setters:[function(t){e=t.cclegacy,s=t.NodePool,o=t.instantiate}],execute:function(){e._RF.push({},"75ec8jqPlpLr618agsIU5y1","XGTS_PoolManager",void 0);class n{constructor(){this._pools=new Map,this._prefabs=new Map}static get Instance(){return this._instance||(this._instance=new n),this._instance}Preload(t,e){const n=t.name;if(this._prefabs.has(n)||this._prefabs.set(n,t),this._pools.has(n)||this._pools.set(n,new s),this._pools.get(n).size()<e)for(let s=0;s<e-this._pools.get(n).size();s++){var i;const e=o(t);e.active=!1,null==(i=this._pools.get(n))||i.put(e)}}Get(t,e,n){const i="string"==typeof t?t:t.name;let a=this._pools.get(i);if(!a){if(!this._prefabs.has(i))return console.error(`Pool ${i} not found!`),null;a=new s,this._pools.set(i,a)}let l=a.get();if(!l||!l.isValid){const t=this._prefabs.get(i);l=o(t)}return l&&(l.active=!0,e&&(l.parent=e),n&&l.setPosition(n),l.emit("object-activated")),l||null}Put(t){const e=t.name;var s;(t.removeFromParent(),t.emit("object-recycled"),this._pools.has(e))?null==(s=this._pools.get(e))||s.put(t):(console.warn(`没有这个对象池：${e}`),t.destroy())}CleanPool(t){const e=this._pools.get(t);e&&(e.clear(),this._pools.delete(t),this._prefabs.delete(t))}CleanAllPools(){this._pools.forEach(((t,e)=>{t.clear(),this._pools.delete(e),this._prefabs.delete(e)}))}}t("XGTS_PoolManager",n),n._instance=void 0,e._RF.pop()}}}));

System.register("chunks:///_virtual/XGTS_RewardPanel.ts",["cc","./NodeUtil.ts","./PanelBase.ts","./XGTS_UIManager.ts","./XGTS_Constant.ts","./XGTS_DataManager.ts","./XGTS_CommonItem.ts","./XGTS_PoolManager.ts","./Tools.ts","./UIManager.ts","./XGTS_AudioManager.ts","./XGTS_GameManager.ts"],(function(t){var e,n,a,o,s,i,l,c,r,u,h,d,P,S,G,T,_;return{setters:[function(t){e=t.cclegacy,n=t.Layout,a=t.ScrollView,o=t.Vec3,s=t._decorator},function(t){i=t.default},function(t){l=t.PanelBase},function(t){c=t.XGTS_UIManager},function(t){r=t.XGTS_Constant},function(t){u=t.XGTS_DataManager},function(t){h=t.default},function(t){d=t.XGTS_PoolManager},function(t){P=t.Tools},function(t){S=t.UIManager},function(t){G=t.XGTS_AudioManager,T=t.XGTS_Audio},function(t){_=t.XGTS_GameManager}],execute:function(){var f;e._RF.push({},"8e624QHbdZEq4VFCYH0aaHl","XGTS_RewardPanel",void 0);const{ccclass:C,property:g}=s;t("default",C("XGTS_RewardPanel")(f=class extends l{constructor(...t){super(...t),this.Panel=null,this.Content=null,this.ContentLayout=void 0,this.ScrollView=null,this.items=[],this.callback=null}onLoad(){this.Panel=i.GetNode("Panel",this.node),this.Content=i.GetNode("Content",this.node),this.ContentLayout=this.Content.getComponent(n),this.ScrollView=i.GetComponent("ScrollView",this.node,a)}Show(t,e){super.Show(this.Panel),this.items.forEach((t=>d.Instance.Put(t.node))),this.items=[];for(let e=0;e<t.length;e++)this.scheduleOnce((()=>{let n=d.Instance.Get(r.Prefab.CommonItem,this.Content).getComponent(h);n.InitDisplay(t[e]),this.items.push(n),this.ContentLayout.updateLayout(),this.Content.setPosition(o.ZERO);let a=0;_.IsDoubleMode&&(a=1),u.PlayerDatas[a].AddItemToInventory(P.Clone(t[e]))||(_.IsDoubleMode?(u.PlayerDatas[1].Money+=t[e].Price/2,u.PlayerDatas[2].Money+=t[e].Price/2):u.PlayerDatas[0].Money+=t[e].Price,S.ShowTip(`仓库已满，转化成金钱${t[e].Price}`))}),.1*e);this.callback=e}OnButtonClick(t){switch(G.Instance.PlaySFX(T.ButtonClick),t.target.name){case"Mask":c.Instance.HidePanel(r.Panel.RewardPanel)}}})||f);e._RF.pop()}}}));

System.register("chunks:///_virtual/XGTS_SafeBoxInventory.ts",["cc","./NodeUtil.ts","./XGTS_DataManager.ts","./XGTS_Constant.ts","./XGTS_Inventory.ts","./XGTS_UIManager.ts","./XGTS_InventoryGrid.ts","./XGTS_AudioManager.ts"],(function(t){var e,n,i,o,a,s,r,h,c,l,d,u;return{setters:[function(t){e=t.cclegacy,n=t.UITransform,i=t.Label,o=t._decorator},function(t){a=t.default},function(t){s=t.XGTS_DataManager},function(t){r=t.XGTS_Constant},function(t){h=t.default},function(t){c=t.XGTS_UIManager},function(t){l=t.XGTS_InventoryGrid},function(t){d=t.XGTS_AudioManager,u=t.XGTS_Audio}],execute:function(){var I;e._RF.push({},"ed9e9pCvWxCwLW1+XUyFoEd","XGTS_SafeBoxInventory",void 0);const{ccclass:_,property:S}=o;t("default",_("XGTS_SafeBoxInventory")(I=class extends h{constructor(...t){super(...t),this.Item=null,this.ItemLabel=null,this.Icon_0=null,this.Icon_1=null,this.Icon_2=null,this.Icon_3=null,this.ndTrans=null,this.inBox=!1,this.playerNum=0}onLoad(){this.Item=a.GetComponent("Item",this.node,n),this.ItemLabel=a.GetComponent("ItemLabel",this.node,i),this.ItemContent=a.GetNode("ItemContent",this.node),this.ItemContentTrans=this.ItemContent.getComponent(n),this.Icon_0=a.GetNode("Icon_0",this.node),this.Icon_1=a.GetNode("Icon_1",this.node),this.Icon_2=a.GetNode("Icon_2",this.node),this.Icon_3=a.GetNode("Icon_3",this.node),this.ndTrans=this.node.getComponent(n)}InitPlayerNum(t){this.playerNum=t}Refresh(){let t=s.PlayerDatas[this.playerNum].SafeBox;this.Icon_0.active=2==t.width&&1==t.height,this.Icon_1.active=2==t.width&&2==t.height,this.Icon_2.active=3==t.width&&2==t.height,this.Icon_3.active=3==t.width&&3==t.height;let e=t.width,n=t.height,i=s.PlayerDatas[this.playerNum].SafeBoxGrid;i.width!==e||i.height!==n?l.ResizeGrid(i,e,n):l.ClearGrid(i),this.ItemContentTrans.setContentSize(e*r.itemSize,n*r.itemSize),this.ndTrans.setContentSize(170+e*r.itemSize+20,150+n*r.itemSize),super.Init(t.ItemData,s.PlayerDatas[this.playerNum].SafeBoxGrid)}OnDragStart(t){super.OnDragStart(t)}OnDragging(t,e){super.OnDragging(t,e)}OnDragEnd(t,e){super.OnDragEnd(t,e)}OnButtonClick(t){switch(d.Instance.PlaySFX(u.ButtonClick),t.target.name){case"Item":c.Instance.ShowPanel(r.Panel.SelectSafeBoxPanel,[()=>{this.Refresh()},this.playerNum])}}})||I);e._RF.pop()}}}));

System.register("chunks:///_virtual/XGTS_SafeBoxPanel.ts",["cc","./PanelBase.ts","./NodeUtil.ts","./XGTS_UIManager.ts","./XGTS_Constant.ts","./Tools.ts","./XGTS_AudioManager.ts"],(function(e){var t,s,n,i,o,h,c,l,a,r,d,S,f;return{setters:[function(e){t=e.cclegacy,s=e.v3,n=e.UIOpacity,i=e.Label,o=e.math,h=e._decorator},function(e){c=e.PanelBase},function(e){l=e.default},function(e){a=e.XGTS_UIManager},function(e){r=e.XGTS_Constant},function(e){d=e.Tools},function(e){S=e.XGTS_AudioManager,f=e.XGTS_Audio}],execute:function(){var u;t._RF.push({},"007079T17NM5JB6zwLILY2d","XGTS_SafeBoxPanel",void 0);const{ccclass:x,property:p}=h,B=s(0,0,0);e("XGTS_SafeBoxPanel",x("XGTS_SafeBoxPanel")(u=class extends c{constructor(...e){super(...e),this.Panel=null,this.SafeBox=null,this.speed=300,this.crossIndex=0,this.passworld=["6","D","F","U","P"],this.isStucked=!1,this.stuck=.5,this.callback=null}onLoad(){this.Panel=l.GetNode("Panel",this.node),this.SafeBox=l.GetNode("SafeBox",this.node)}Show(e){S.Instance.PlayBGM(f.SafeBoxBG),this.callback=e,super.Show(this.Panel),this.crossIndex=0,this.isStucked=!1,this.stuck=.5,this.SetCurCol()}lateUpdate(e){for(let t=0;t<this.SafeBox.children.length;t++){let s=this.SafeBox.children[t];if(!(t<=this.crossIndex-1))if(this.isStucked&&t==this.crossIndex)this.stuck-=e,this.stuck<=0&&(this.isStucked=!1,this.stuck=.5);else for(let n=0;n<s.children.length;n++)B.set(s.children[n].position.x,s.children[n].position.y,0),B.y-=e*(this.speed+20*t),B.y<=-300&&(B.y=B.y+600),s.children[n].setPosition(B)}}SetCurCol(){for(let e=0;e<this.SafeBox.children.length;e++)this.SafeBox.children[e].getComponent(n).opacity=this.crossIndex==e?255:80}OnButtonClick(e){switch(S.Instance.PlaySFX(f.ButtonClick),e.target.name){case"Button":let e=0;const t=()=>{S.Instance.PlaySFX(f.SafeBoxF),this.scheduleOnce((()=>{let s=[];for(let e=0;e<this.SafeBox.children[this.crossIndex].children.length;e++)s.push(this.SafeBox.children[this.crossIndex].children[e].getComponent(i).color.clone()),this.SafeBox.children[this.crossIndex].children[e].getComponent(i).color=d.GetColorFromHex("#FF5050");this.scheduleOnce((()=>{for(let e=0;e<this.SafeBox.children[this.crossIndex].children.length;e++)this.SafeBox.children[this.crossIndex].children[e].getComponent(i).color=s[e];e++,e>=2||t()}),.1)}),.1)},h=()=>{S.Instance.StopBGM(),this.scheduleOnce((()=>{for(let e=0;e<this.SafeBox.children.length;e++)this.SafeBox.children[e].getComponent(n).opacity=80;this.scheduleOnce((()=>{for(let e=0;e<this.SafeBox.children.length;e++)this.SafeBox.children[e].getComponent(n).opacity=255;e++,e>=5?(a.Instance.HidePanel(r.Panel.SafeBoxPanel),this.callback&&this.callback()):h()}),.1)}),.1)};if(this.crossIndex==this.passworld.length)return;if(this.isStucked)return;let c=this.SafeBox.children[this.crossIndex],l=c.children.find((e=>Math.abs(e.position.y)<35));if(l)if(l.getComponent(i).string==this.passworld[this.crossIndex]){let e=l.position.y;for(let t=0;t<c.children.length;t++)c.children[t].setPosition(s(c.children[t].position.x,c.children[t].position.y-e,0));S.Instance.PlaySFX(f.SafeBoxT),this.crossIndex=o.clamp(this.crossIndex+1,0,this.passworld.length),this.SetCurCol(),this.crossIndex==this.passworld.length&&h()}else this.isStucked=!0,t();else this.isStucked=!0,t()}}})||u);t._RF.pop()}}}));

System.register("chunks:///_virtual/XGTS_SelectMapPanel.ts",["cc","./NodeUtil.ts","./PanelBase.ts","./XGTS_UIManager.ts","./XGTS_Constant.ts","./XGTS_GameManager.ts","./Tools.ts","./TweenUtil.ts","./UIManager.ts","./GameManager.ts","./ProjectEventManager.ts","./XGTS_AudioManager.ts","./XGTS_DataManager.ts","./EventManager.ts"],(function(t){var e,i,n,a,o,s,h,l,f,r,c,u,p,m,I,d,y,M,S,T,R,g,P,G;return{setters:[function(t){e=t.cclegacy,i=t.RichText,n=t.Sprite,a=t.Tween,o=t.tween,s=t.v3,h=t.Vec3,l=t._decorator},function(t){f=t.default},function(t){r=t.PanelBase},function(t){c=t.XGTS_UIManager},function(t){u=t.XGTS_Constant},function(t){p=t.XGTS_GameManager},function(t){m=t.Tools},function(t){I=t.EasingType},function(t){d=t.UIManager,y=t.Panel},function(t){M=t.GameManager},function(t){S=t.ProjectEventManager,T=t.ProjectEvent},function(t){R=t.XGTS_AudioManager,g=t.XGTS_Audio},function(t){P=t.XGTS_DataManager},function(t){G=t.EventManager}],execute:function(){var x;e._RF.push({},"1214afnMj5M4r9B6OvyO3jK","XGTS_SelectMapPanel",void 0);const{ccclass:w,property:B}=l;t("default",w("XGTS_SelectMapPanel")(x=class extends r{constructor(...t){super(...t),this.Panel=null,this.Map=null,this.Maps=null,this.lhdb=null,this.DifficultyRichText=null,this.EntryCostRichText=null,this.LevelRequirementRichText=null,this.TimeLimitRichText=null,this.RegularButton=null,this.RegularButtonRichText=null,this.SecretButton=null,this.SecretButtonRichText=null,this.mapInfo=null,this.difficulty=0,this.difficultyColorHex=["#00ff00","#ff0000"],this.difficultyStrs=["简单","困难"],this.playerNum=0}onLoad(){this.Panel=f.GetNode("Panel",this.node),this.Map=f.GetNode("Map",this.node),this.Maps=f.GetNode("Maps",this.node),this.lhdb=f.GetNode("零号大坝",this.node),this.DifficultyRichText=f.GetComponent("DifficultyRichText",this.node,i),this.EntryCostRichText=f.GetComponent("EntryCostRichText",this.node,i),this.LevelRequirementRichText=f.GetComponent("LevelRequirementRichText",this.node,i),this.TimeLimitRichText=f.GetComponent("TimeLimitRichText",this.node,i),this.RegularButton=f.GetComponent("RegularButton",this.node,n),this.RegularButtonRichText=f.GetComponent("RegularButtonRichText",this.node,i),this.SecretButton=f.GetComponent("SecretButton",this.node,n),this.SecretButtonRichText=f.GetComponent("SecretButtonRichText",this.node,i),this.Show()}Show(t){this.mapInfo=null,this.playerNum=t,this.ShowInfoPanel(!1),S.emit(T.页面转换,M.GameData.gameName)}ShowMap(t){a.stopAllByTarget(this.Map),o(this.Map).to(.3,{position:t.negative().multiplyScalar(2),scale:s(2,2,1)},{easing:I.sineIn}).start()}ResetMap(){a.stopAllByTarget(this.Map),o(this.Map).to(.3,{position:h.ZERO,scale:h.ONE},{easing:I.sineIn}).start()}ShowInfoPanel(t){this.Panel.active=t,t?(super.Show(this.Panel),this.RefreshPanel()):this.mapInfo=null}RefreshPanel(){null!=this.mapInfo&&(this.RegularButton.color=0==this.difficulty?m.GetColorFromHex("#5EA770"):m.GetColorFromHex("#293E51"),this.SecretButton.color=1==this.difficulty?m.GetColorFromHex("#5EA770"):m.GetColorFromHex("#293E51"),this.RegularButtonRichText.string=`<b><color=${0==this.difficulty?"#ffffff":"#a9a9aa"}>常规行动</color></b>`,this.SecretButtonRichText.string=`<b><color=${1==this.difficulty?"#ffffff":"#a9a9aa"}>机密行动</color></b>`,this.DifficultyRichText.string=`<b><color=${this.difficultyColorHex[this.difficulty]} >${this.difficultyStrs[this.difficulty]}</color></b>`,this.EntryCostRichText.string=`<b><color=#ffffff>${this.mapInfo.EntryCosts[this.difficulty]}</color></b>`,this.LevelRequirementRichText.string=`<b><color=#ffffff>${this.mapInfo.LevelRequirements[this.difficulty]}</color></b>`,this.TimeLimitRichText.string=`<b><color=#ffffff>${this.mapInfo.TimeLimit}</color></b>`,this.Maps.children.forEach((t=>{t.active=t.name==this.mapInfo.Name})))}destoryPlayer(){p.Instance.player&&p.Instance.player.destroy(),p.Instance.playerNode&&p.Instance.playerNode.destroy(),p.Instance.player=null,p.Instance.playerNode=null,G.Scene.emit(u.Event.RESET_CAMERA),p.Instance.playerNodes.forEach((t=>{t.destroy()})),p.Instance.players.forEach((t=>{t.destroy()})),p.Instance.playerNodes=[],p.Instance.players=[]}OnButtonClick(t){switch(R.Instance.PlaySFX(g.ButtonClick),t.target.name){case"Map":this.ShowInfoPanel(!1),this.ResetMap();break;case"零号大坝":if(this.mapInfo==u.MapInfo.零号大坝)return;this.ShowMap(t.target.position.clone()),this.mapInfo=u.MapInfo.零号大坝,this.difficulty=0,this.ShowInfoPanel(!0);break;case"长弓溪谷":if(this.mapInfo==u.MapInfo.长弓溪谷)return;this.ShowMap(t.target.position.clone()),this.mapInfo=u.MapInfo.长弓溪谷,this.difficulty=0,this.ShowInfoPanel(!0);break;case"烽火荣都":if(this.mapInfo==u.MapInfo.烽火荣都)return;this.ShowMap(t.target.position.clone()),this.mapInfo=u.MapInfo.烽火荣都,this.difficulty=0,this.ShowInfoPanel(!0);break;case"校长办公室":if(this.mapInfo==u.MapInfo.校长办公室)return;this.ShowMap(t.target.position.clone()),this.mapInfo=u.MapInfo.校长办公室,this.difficulty=0,this.ShowInfoPanel(!0);break;case"宿舍":if(this.mapInfo==u.MapInfo.宿舍)return;this.ShowMap(t.target.position.clone()),this.mapInfo=u.MapInfo.宿舍,this.difficulty=0,this.ShowInfoPanel(!0);break;case"体育场":if(this.mapInfo==u.MapInfo.体育场)return;this.ShowMap(t.target.position.clone()),this.mapInfo=u.MapInfo.体育场,this.difficulty=0,this.ShowInfoPanel(!0);break;case"电脑室":if(this.mapInfo==u.MapInfo.电脑室)return;this.ShowMap(t.target.position.clone()),this.mapInfo=u.MapInfo.电脑室,this.difficulty=0,this.ShowInfoPanel(!0);break;case"RegularButton":this.difficulty=0,this.RefreshPanel();break;case"SecretButton":this.difficulty=1,this.RefreshPanel();break;case"StartButton":P.PlayerDatas[this.playerNum].GetTotalValue()>=this.mapInfo.EntryCosts[this.difficulty]?(this.destoryPlayer(),p.isChangeScene=!0,d.ShowPanel(y.LoadingPanel,this.mapInfo.MapName)):d.ShowTip("战备价值不够");break;case"ReturnButton":c.Instance.HidePanel(u.Panel.SelectMapPanel)}}})||x);e._RF.pop()}}}));

System.register("chunks:///_virtual/XGTS_SelectMode.ts",["./rollupPluginModLoBabelHelpers.js","cc","./XGTS_GameManager.ts","./EventManager.ts","./XGTS_Constant.ts"],(function(e){var t,n,o,i,a,l,u,s,c;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.initializerDefineProperty},function(e){o=e.cclegacy,i=e.Node,a=e._decorator,l=e.Component},function(e){u=e.XGTS_GameManager},function(e){s=e.EventManager},function(e){c=e.XGTS_Constant}],execute:function(){var r,d,h,S,M,b,D;o._RF.push({},"a07b7XbSQRN3JGse2xhAnCH","XGTS_SelectMode",void 0);const{ccclass:G,property:m}=a;e("XGTS_SelectMode",(r=G("XGTS_SelectMode"),d=m(i),h=m(i),r((b=t((M=class extends l{constructor(...e){super(...e),n(this,"SingleGamePanel",b,this),n(this,"DoubleGamePanel",D,this),this.SingleModeButton=null,this.DoubleModeButton=null}onLoad(){this.SingleGamePanel.active=!u.IsDoubleMode,this.DoubleGamePanel.active=u.IsDoubleMode,this.SingleModeButton=this.node.getChildByName("SingleModeButton"),this.DoubleModeButton=this.node.getChildByName("DoubleModeButton"),this.updateSwitchUI()}updateSwitchUI(){this.SingleModeButton.children.forEach((e=>{"selected"==e.name&&(e.active=!u.IsDoubleMode)})),this.DoubleModeButton.children.forEach((e=>{"selected"==e.name&&(e.active=u.IsDoubleMode)}))}onBtnClick(e){switch(e.target.name){case"SingleModeButton":if(!u.IsDoubleMode)return;u.IsDoubleMode=!1,this.SingleGamePanel.active=!0,this.DoubleGamePanel.active=!1,this.updateSwitchUI(),s.Scene.emit(c.Event.CHANGE_SINGLE_MODE);break;case"DoubleModeButton":if(u.IsDoubleMode)return;u.IsDoubleMode=!0,this.SingleGamePanel.active=!1,this.DoubleGamePanel.active=!0,this.updateSwitchUI(),s.Scene.emit(c.Event.CHANGE_DOUBLE_MODE)}}}).prototype,"SingleGamePanel",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),D=t(M.prototype,"DoubleGamePanel",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),S=M))||S));o._RF.pop()}}}));

System.register("chunks:///_virtual/XGTS_SelectSafeBoxPanel.ts",["cc","./NodeUtil.ts","./PanelBase.ts","./XGTS_UIManager.ts","./XGTS_Constant.ts","./XGTS_DataManager.ts","./UIManager.ts","./Banner.ts","./XGTS_AudioManager.ts"],(function(e){var a,t,n,l,s,i,o,c,r,S,h,f;return{setters:[function(e){a=e.cclegacy,t=e.Label,n=e._decorator},function(e){l=e.default},function(e){s=e.PanelBase},function(e){i=e.XGTS_UIManager},function(e){o=e.XGTS_Constant},function(e){c=e.XGTS_DataManager},function(e){r=e.UIManager},function(e){S=e.default},function(e){h=e.XGTS_AudioManager,f=e.XGTS_Audio}],execute:function(){var m;a._RF.push({},"05a8e9cYYtIf4qNj/jF+i6/","XGTS_SelectSafeBoxPanel",void 0);const{ccclass:B,property:u}=n;e("default",B("XGTS_SelectSafeBoxPanel")(m=class extends s{constructor(...e){super(...e),this.Panel=null,this.Buttons=null,this.callback=null,this.playerNum=0}onLoad(){this.Panel=l.GetNode("Panel",this.node),this.Buttons=l.GetNode("Buttons",this.node)}Show(e,a){this.playerNum=a,super.Show(this.Panel),this.callback=e,this.Refresh()}Refresh(){for(let e=0;e<this.Buttons.children.length;e++){let a=this.Buttons.children[e],n="",l=!1;switch(a.name){case"SafeBox_0":l=!0,n="普通安全箱";break;case"SafeBox_1":l=c.GetSafeBoxUnlock(a.name),n=l?"进阶安全箱":`(${c.GetSafeBoxAdTimes(a.name)}/3)进阶安全箱`;break;case"SafeBox_2":l=c.GetSafeBoxUnlock(a.name),n=l?"高级安全箱":`(${c.GetSafeBoxAdTimes(a.name)}/6)高级安全箱`;break;case"SafeBox_3":l=c.GetSafeBoxUnlock(a.name),n=l?"顶级安全箱":`(${c.GetSafeBoxAdTimes(a.name)}/9)顶级安全箱`}a.getChildByName("ButtonLabel").getComponent(t).string=n,a.getChildByName("Lock").active=!l,a.getChildByName("Ad").active=!l}}OnButtonClick(e){switch(h.Instance.PlaySFX(f.ButtonClick),e.target.name){case"Mask":i.Instance.HidePanel(o.Panel.SelectSafeBoxPanel);break;case"SafeBox_0":if(c.PlayerDatas[this.playerNum].SafeBox.ItemData.length>0)return void r.ShowTip("安全箱内还有物品");c.PlayerDatas[this.playerNum].SafeBox={width:2,height:1,ItemData:c.PlayerDatas[this.playerNum].SafeBox.ItemData},this.callback&&this.callback(),i.Instance.HidePanel(o.Panel.SelectSafeBoxPanel),c.SaveData();break;case"SafeBox_1":if(c.GetSafeBoxUnlock(e.target.name)){if(c.PlayerDatas[this.playerNum].SafeBox.ItemData.length>0)return void r.ShowTip("安全箱内还有物品");c.PlayerDatas[this.playerNum].SafeBox={width:2,height:2,ItemData:c.PlayerDatas[this.playerNum].SafeBox.ItemData},this.callback&&this.callback(),i.Instance.HidePanel(o.Panel.SelectSafeBoxPanel),c.SaveData()}else S.Instance.ShowVideoAd((()=>{let a=c.GetSafeBoxAdTimes(e.target.name);c.SetSafeBoxAdTimes(e.target.name,a+1),this.Refresh()}));break;case"SafeBox_2":if(c.GetSafeBoxUnlock(e.target.name)){if(c.PlayerDatas[this.playerNum].SafeBox.ItemData.length>0)return void r.ShowTip("安全箱内还有物品");c.PlayerDatas[this.playerNum].SafeBox={width:3,height:2,ItemData:c.PlayerDatas[this.playerNum].SafeBox.ItemData},this.callback&&this.callback(),i.Instance.HidePanel(o.Panel.SelectSafeBoxPanel),c.SaveData()}else S.Instance.ShowVideoAd((()=>{let a=c.GetSafeBoxAdTimes(e.target.name);c.SetSafeBoxAdTimes(e.target.name,a+1),this.Refresh()}));break;case"SafeBox_3":if(c.GetSafeBoxUnlock(e.target.name)){if(c.PlayerDatas[this.playerNum].SafeBox.ItemData.length>0)return void r.ShowTip("安全箱内还有物品");c.PlayerDatas[this.playerNum].SafeBox={width:3,height:3,ItemData:c.PlayerDatas[this.playerNum].SafeBox.ItemData},this.callback&&this.callback(),i.Instance.HidePanel(o.Panel.SelectSafeBoxPanel),c.SaveData()}else S.Instance.ShowVideoAd((()=>{let a=c.GetSafeBoxAdTimes(e.target.name);c.SetSafeBoxAdTimes(e.target.name,a+1),this.Refresh()}))}}})||m);a._RF.pop()}}}));

System.register("chunks:///_virtual/XGTS_SellInventory.ts",["cc","./NodeUtil.ts","./XGTS_Inventory.ts","./XGTS_InventoryGrid.ts","./XGTS_DataManager.ts","./UIManager.ts","./XGTS_GameManager.ts"],(function(t){var e,n,a,o,r,s,i,l,h,y;return{setters:[function(t){e=t.cclegacy,n=t.Label,a=t.UITransform,o=t._decorator},function(t){r=t.default},function(t){s=t.default},function(t){i=t.XGTS_InventoryGrid},function(t){l=t.XGTS_DataManager},function(t){h=t.UIManager},function(t){y=t.XGTS_GameManager}],execute:function(){var c;e._RF.push({},"69f00KPVYhN1peRywmyTr9x","XGTS_SellInventory",void 0);const{ccclass:u,property:g}=o;t("default",u("XGTS_SellInventory")(c=class extends s{constructor(...t){super(...t),this.SellMoneyLabel=null}onLoad(){this.SellMoneyLabel=r.GetComponent("SellMoneyLabel",this.node,n),this.ItemContent=r.GetNode("ItemContent",this.node),this.ItemContentTrans=this.ItemContent.getComponent(a)}Init(){this.data=[],this.gridCtrl=new i(8,7),super.Init(this.data,this.gridCtrl)}RefreshMoney(){this.SellMoneyLabel.string=this.GetTotalMoneny().toLocaleString()}OnDragStart(t){super.OnDragStart(t)}OnDragging(t,e){super.OnDragging(t,e)}OnDragEnd(t,e){super.OnDragEnd(t,e),this.RefreshMoney()}GetTotalMoneny(){let t=0;for(let e=0;e<this.data.length;e++)t+=this.data[e].Price*this.data[e].Count;return t}Sell(t){y.IsDoubleMode?(l.PlayerDatas[1].Money+=this.GetTotalMoneny()/2,l.PlayerDatas[2].Money+=this.GetTotalMoneny()/2):l.PlayerDatas[0].Money+=this.GetTotalMoneny(),h.ShowTip(`出售成功，金钱 +${this.GetTotalMoneny().toLocaleString()}`),this.data=[],this.ClearItems(),this.RefreshMoney()}})||c);e._RF.pop()}}}));

System.register("chunks:///_virtual/XGTS_SellPanel.ts",["cc","./NodeUtil.ts","./GameManager.ts","./ProjectEventManager.ts","./XGTS_DataManager.ts","./XGTS_Constant.ts","./XGTS_UIManager.ts","./EventManager.ts","./XGTS_PlayerInventory.ts","./PanelBase.ts","./XGTS_SellInventory.ts","./XGTS_AudioManager.ts"],(function(n){var t,e,a,o,r,s,i,l,h,g,S,c,u,y,v,E;return{setters:[function(n){t=n.cclegacy,e=n.Label,a=n._decorator},function(n){o=n.default},function(n){r=n.GameManager},function(n){s=n.ProjectEventManager,i=n.ProjectEvent},function(n){l=n.XGTS_DataManager},function(n){h=n.XGTS_Constant},function(n){g=n.XGTS_UIManager},function(n){S=n.EventManager},function(n){c=n.default},function(n){u=n.PanelBase},function(n){y=n.default},function(n){v=n.XGTS_AudioManager,E=n.XGTS_Audio}],execute:function(){var I;t._RF.push({},"47e55frcpBMYZ0TGKvMIXl5","XGTS_SellPanel",void 0);const{ccclass:_,property:f}=a;n("default",_("XGTS_SellPanel")(I=class extends u{constructor(...n){super(...n),this.Inventory=null,this.SellInventory=null,this.MoneyLabel=null,this.playerNum=0}onLoad(){this.Inventory=o.GetComponent("Inventory",this.node,c),this.SellInventory=o.GetComponent("SellInventory",this.node,y),this.MoneyLabel=o.GetComponent("MoneyLabel",this.node,e)}Show(n){this.playerNum=n,s.emit(i.弹出窗口,r.GameData.gameName),this.Inventory.InitPlayerInventory(),this.SellInventory.Init(),this.RefreshMoney()}RefreshMoney(){this.MoneyLabel.string=l.PlayerDatas[this.playerNum].Money.toLocaleString()}OnButtonClick(n){switch(v.Instance.PlaySFX(E.ButtonClick),n.target.name){case"SellButton":this.SellInventory.Sell(this.playerNum);break;case"ReturnButton":g.Instance.HidePanel(h.Panel.SellPanel)}}OnDragStart(n,t){this.Inventory.OnDragStart(n),this.SellInventory.OnDragStart(n)}OnDragging(n,t){this.Inventory.OnDragging(n,t),this.SellInventory.OnDragging(n,t)}OnDragEnd(n,t){this.Inventory.OnDragEnd(n,t),this.SellInventory.OnDragEnd(n,t)}onEnable(){S.on(h.Event.REFRESH_MONEY,this.RefreshMoney,this),S.on(h.Event.ON_ITEM_DRAGSTART,this.OnDragStart,this),S.on(h.Event.ON_ITEM_DRAGGING,this.OnDragging,this),S.on(h.Event.ON_ITEM_DRAGEND,this.OnDragEnd,this)}onDisable(){S.off(h.Event.REFRESH_MONEY,this.RefreshMoney,this),S.off(h.Event.ON_ITEM_DRAGSTART,this.OnDragStart,this),S.off(h.Event.ON_ITEM_DRAGGING,this.OnDragging,this),S.off(h.Event.ON_ITEM_DRAGEND,this.OnDragEnd,this)}})||I);t._RF.pop()}}}));

System.register("chunks:///_virtual/XGTS_ShopPanel.ts",["cc","./NodeUtil.ts","./GameManager.ts","./ProjectEventManager.ts","./XGTS_Data.ts","./XGTS_Item.ts","./XGTS_GameManager.ts","./XGTS_DataManager.ts","./XGTS_InventoryGrid.ts","./XGTS_PoolManager.ts","./XGTS_Constant.ts","./Tools.ts","./XGTS_UIManager.ts","./EventManager.ts","./XGTS_PlayerInventory.ts","./PanelBase.ts","./UIManager.ts","./XGTS_AudioManager.ts"],(function(t){var e,n,o,i,s,a,h,r,l,S,c,I,m,g,p,y,T,u,f,v,d,b,M,G;return{setters:[function(t){e=t.cclegacy,n=t.Label,o=t.ScrollView,i=t.UITransform,s=t._decorator},function(t){a=t.default},function(t){h=t.GameManager},function(t){r=t.ProjectEventManager,l=t.ProjectEvent},function(t){S=t.XGTS_ItemType},function(t){c=t.default},function(t){I=t.XGTS_GameManager},function(t){m=t.XGTS_DataManager},function(t){g=t.XGTS_InventoryGrid},function(t){p=t.XGTS_PoolManager},function(t){y=t.XGTS_Constant},function(t){T=t.Tools},function(t){u=t.XGTS_UIManager},function(t){f=t.EventManager},function(t){v=t.default},function(t){d=t.PanelBase},function(t){b=t.UIManager},function(t){M=t.XGTS_AudioManager,G=t.XGTS_Audio}],execute:function(){var _;e._RF.push({},"ae8b0L1vzpGY5OVocvOfB4Y","XGTS_ShopPanel",void 0);const{ccclass:w,property:E}=s;t("default",w("XGTS_ShopPanel")(_=class extends d{constructor(...t){super(...t),this.Inventory=null,this.Buttons=null,this.ShopItemContent=null,this.ShopScrollView=null,this.ShopItemContentTrans=null,this.ShopInventoryTitleLabel=null,this.MoneyLabel=null,this.itemMap=new Map,this.playerNum=0}onLoad(){this.Inventory=a.GetComponent("Inventory",this.node,v),this.ShopInventoryTitleLabel=a.GetComponent("ShopInventoryTitleLabel",this.node,n),this.MoneyLabel=a.GetComponent("MoneyLabel",this.node,n),this.Buttons=a.GetNode("Buttons",this.node),this.ShopItemContent=a.GetNode("ShopItemContent",this.node),this.ShopScrollView=a.GetComponent("ShopScrollView",this.node,o),this.ShopItemContentTrans=this.ShopItemContent.getComponent(i)}start(){this.InitAllItem()}ShowItems(t){this.ShopScrollView.enabled=!1,this.ShopScrollView.enabled=!0,this.ShopScrollView.scrollToTop();for(let e=0;e<this.ShopItemContent.children.length;e++)this.ShopItemContent.children[e].active=`${t}`==this.ShopItemContent.children[e].name}InitAllItem(){for(let t=0;t<20;t++){let e=null;if(m.ItemDataMap.has(t)&&(e=m.ItemDataMap.get(t).filter((t=>!t.NotShow))),e&&e.length>0){let n=[];e.forEach((t=>n.push(T.Clone(t)))),this.itemMap.has(t)||this.itemMap.set(t,{gridCtrl:new g(8,100),items:[]}),I.FillContainerByData(n,this.itemMap.get(t).gridCtrl);for(let e=0;e<n.length;e++){const o=n[e];let i=p.Instance.Get(y.Prefab.Item,this.ShopItemContent.getChildByName(`${t}`));i.setParent(this.ShopItemContent.getChildByName(`${t}`)),o.Rotated?i.setPosition(o.Point.x*y.itemSize+o.Size.height*y.itemSize/2,-o.Point.y*y.itemSize-o.Size.width*y.itemSize/2):i.setPosition(o.Point.x*y.itemSize+o.Size.width*y.itemSize/2,-o.Point.y*y.itemSize-o.Size.height*y.itemSize/2);let s=i.getComponent(c);s.InitShopItem(o,this.ItemCallback.bind(this)),this.itemMap.get(t).items.push(s)}}}}ItemCallback(t){I.itemPlayerNum=this.playerNum,u.Instance.ShowPanel(y.Panel.ItemInfoPanel,[t,!1,this.AddToInventory.bind(this)])}AddToInventory(t){let e=0;if(I.IsDoubleMode&&(e=1),m.PlayerDatas[e].Money>=t.Price){m.PlayerDatas[e].Money-=t.Price;let n=m.CloneItemData(t);m.PlayerDatas[e].AddItemToInventory(n)?b.ShowTip("添加成功"):b.ShowTip("添加失败")}else b.ShowTip("金钱不足")}Show(t){this.playerNum=t,r.emit(l.弹出窗口,h.GameData.gameName),this.Inventory.InitPlayerInventory(),this.RefreshMoney(),this.RefreshButtons("头盔商店")}RefreshInventory(){}RefreshMoney(){this.MoneyLabel.string=`${m.PlayerDatas[this.playerNum].Money}`}RefreshButtons(t){switch(t){case"头盔商店":this.ShopInventoryTitleLabel.string="头盔商店",this.ShowItems(S.Helmet);break;case"防弹衣商店":this.ShopInventoryTitleLabel.string="防弹衣商店",this.ShowItems(S.BodyArmor);break;case"武器商店":this.ShopInventoryTitleLabel.string="武器商店",this.ShowItems(S.Weapon);break;case"弹药商店":this.ShopInventoryTitleLabel.string="弹药商店",this.ShowItems(S.Ammo);break;case"配件商店":this.ShopInventoryTitleLabel.string="配件商店",this.ShowItems(S.Accessory);break;case"胸挂商店":this.ShopInventoryTitleLabel.string="胸挂商店",this.ShowItems(S.ChestRig);break;case"背包商店":this.ShopInventoryTitleLabel.string="背包商店",this.ShowItems(S.Backpack);break;case"护甲道具商店":this.ShopInventoryTitleLabel.string="护甲道具商店",this.ShowItems(S.ArmorItem);break;case"医疗道具商店":this.ShopInventoryTitleLabel.string="医疗道具商店",this.ShowItems(S.MedicalItem);break;case"电子物品收集品":this.ShopInventoryTitleLabel.string="电子物品收集品",this.ShowItems(S.Electronic);break;case"医疗道具收集品":this.ShopInventoryTitleLabel.string="医疗道具收集品",this.ShowItems(S.Medical);break;case"工具材料收集品":this.ShopInventoryTitleLabel.string="工具材料收集品",this.ShowItems(S.ToolMaterial);break;case"家具材料收集品":this.ShopInventoryTitleLabel.string="家具材料收集品",this.ShowItems(S.FurnitureItem);break;case"工艺藏品收集品":this.ShopInventoryTitleLabel.string="工艺藏品收集品",this.ShowItems(S.CraftCollectible);break;case"资料情报收集品":this.ShopInventoryTitleLabel.string="资料情报收集品",this.ShowItems(S.IntelDocument);break;case"能源燃料收集品":this.ShopInventoryTitleLabel.string="能源燃料收集品",this.ShowItems(S.EnergyFuel)}this.Buttons.children.forEach((e=>{e.getChildByName("Selected").active=e.name==t}))}OnButtonClick(t){switch(M.Instance.PlaySFX(G.ButtonClick),t.target.name){case"头盔商店":case"防弹衣商店":case"武器商店":case"弹药商店":case"配件商店":case"胸挂商店":case"背包商店":case"护甲道具商店":case"医疗道具商店":case"电子物品收集品":case"医疗道具收集品":case"工具材料收集品":case"家具材料收集品":case"工艺藏品收集品":case"资料情报收集品":case"能源燃料收集品":this.RefreshButtons(t.target.name);break;case"ReturnButton":u.Instance.HidePanel(y.Panel.ShopPanel)}}OnDragStart(t,e){this.Inventory.OnDragStart(t)}OnDragging(t,e){this.Inventory.OnDragging(t,e)}OnDragEnd(t,e){let n=this.ShopScrollView.getScrollOffset();this.Inventory.OnDragEnd(t,e),this.ShopScrollView.scrollToOffset(n,0)}onEnable(){f.on(y.Event.REFRESH_MONEY,this.RefreshMoney,this),f.on(y.Event.ON_ITEM_DRAGSTART,this.OnDragStart,this),f.on(y.Event.ON_ITEM_DRAGGING,this.OnDragging,this),f.on(y.Event.ON_ITEM_DRAGEND,this.OnDragEnd,this)}onDisable(){f.off(y.Event.REFRESH_MONEY,this.RefreshMoney,this),f.off(y.Event.ON_ITEM_DRAGSTART,this.OnDragStart,this),f.off(y.Event.ON_ITEM_DRAGGING,this.OnDragging,this),f.off(y.Event.ON_ITEM_DRAGEND,this.OnDragEnd,this)}})||_);e._RF.pop()}}}));

System.register("chunks:///_virtual/XGTS_Showcase.ts",["cc","./NodeUtil.ts","./XGTS_Constant.ts","./BundleManager.ts","./GameManager.ts","./XGTS_GameManager.ts","./TweenUtil.ts","./XGTS_DataManager.ts","./EventManager.ts","./UIManager.ts"],(function(e){var t,a,n,o,s,i,r,l,c,h,u,d,m,I,p,T,S,g;return{setters:[function(e){t=e.cclegacy,a=e.Component,n=e.Label,o=e.Sprite,s=e.BoxCollider2D,i=e.Contact2DType,r=e.tween,l=e.Vec3,c=e._decorator},function(e){h=e.default},function(e){u=e.XGTS_Constant},function(e){d=e.BundleManager},function(e){m=e.GameManager},function(e){I=e.XGTS_GameManager},function(e){p=e.EasingType},function(e){T=e.XGTS_DataManager},function(e){S=e.EventManager},function(e){g=e.UIManager}],execute:function(){var f;t._RF.push({},"3c5bbwP2tZDdohjUr8RbHnE","XGTS_Showcase",void 0);const{ccclass:D,property:_}=c;e("default",D("XGTS_Showcase")(f=class extends a{constructor(...e){super(...e),this.Label=null,this.Icon=null,this.collider=null,this.taken=!1,this.data=null,this.putcallback=null}onLoad(){this.Label=h.GetComponent("Label",this.node,n),this.Icon=h.GetComponent("Icon",this.node,o),this.collider=this.node.getComponent(s),this.collider.on(i.BEGIN_CONTACT,this.onBeginContact,this),this.collider.on(i.END_CONTACT,this.onEndContact,this)}Init(e){this.data=e,this.Label.string=`${e.Name}`,this.Icon.spriteFrame=null,this.Refresh()}Refresh(){let e=0;I.IsDoubleMode&&(e=1);let t=T.PlayerDatas[e].ShowcaseData.find((e=>e.Name==this.data.Name));this.Icon.spriteFrame=null,t&&(d.LoadSpriteFrame(m.GameData.DefaultBundle,`Res/Items/${t.ImageId}`).then((e=>{this.Icon.spriteFrame=e,I.SetImagePreferScale(this.Icon,180,180)})),r(this.Icon.node).to(3,{position:new l(0,10,0)},{easing:p.sineOut}).to(3,{position:new l(0,-50,0)},{easing:p.sineIn}).union().repeatForever().start())}onBeginContact(e,t,a){if(t.group==u.Group.Player){let e="",a=0;I.IsDoubleMode&&(e="_"+t.node.name.split("_")[1],a=1),S.Scene.emit(u.Event.SHOW_INTERACT_BUTTON+e,!0,(()=>{let e=T.PlayerDatas[a].ShowcaseData.find((e=>e.ID==this.data.ID));e?(T.PlayerDatas[a].RemoveItemFromShowcase(e),T.PlayerDatas[a].AddItemToInventory(e)):(e=T.PlayerDatas[a].InventoryItemData.find((e=>e.Name==this.data.Name)),e?(T.PlayerDatas[a].RemoveItemFromInventory(e),T.PlayerDatas[a].AddItemToShowcase(e),this.putcallback&&this.putcallback()):g.ShowTip(`仓库里没有找到${this.data.Name}`)),this.Refresh()}))}}onEndContact(e,t,a){if(t.group==u.Group.Player){let e="";I.IsDoubleMode&&(e="_"+t.node.name.split("_")[1]),S.Scene.emit(u.Event.SHOW_INTERACT_BUTTON+e,!1)}}})||f);t._RF.pop()}}}));

System.register("chunks:///_virtual/XGTS_Showcases.ts",["cc","./XGTS_Showcase.ts","./XGTS_DataManager.ts"],(function(t){var e,s,a,n,c;return{setters:[function(t){e=t.cclegacy,s=t._decorator,a=t.Component},function(t){n=t.default},function(t){c=t.XGTS_DataManager}],execute:function(){var o,r;e._RF.push({},"afdb2TyLpJMiqUI5pkrone1","XGTS_Showcases",void 0);const{ccclass:h,property:i}=s;t("default",h("XGTS_Showcases")(((r=class t extends a{constructor(...t){super(...t),this.showcases=[]}onLoad(){t.Instance=this}start(){this.showcases=[];for(let t=0;t<this.node.children.length;t++){let e=this.node.children[t].getComponent(n);e.Init(c.ShowcaseData[t]),this.showcases.push(e)}}GetTarget(t,e=null){let s=this.showcases.find((e=>e.data.Name==t));return s?s.putcallback=e:console.error(`大红展览里面没有 name:  ${t} 的物品`),s}}).Instance=null,o=r))||o);e._RF.pop()}}}));

System.register("chunks:///_virtual/XGTS_SingleInventory.ts",["cc","./XGTS_Inventory.ts"],(function(n){var t,e,r,s;return{setters:[function(n){t=n.cclegacy,e=n.UITransform,r=n._decorator},function(n){s=n.default}],execute:function(){var o;t._RF.push({},"6b8b2pAURdAPZGnegXa0edM","XGTS_SingleInventory",void 0);const{ccclass:a,property:i}=r;n("default",a("XGTS_SingleInventory")(o=class extends s{constructor(...n){super(...n),this.inBox=!1}onLoad(){this.ItemContent=this.node,this.ItemContentTrans=this.ItemContent.getComponent(e)}InitSingle(n,t){super.Init(n,t)}OnDragStart(n){super.OnDragStart(n)}OnDragging(n,t){super.OnDragging(n,t)}OnDragEnd(n,t){super.OnDragEnd(n,t)}})||o);t._RF.pop()}}}));

System.register("chunks:///_virtual/XGTS_SkinItem.ts",["cc","./NodeUtil.ts","./BundleManager.ts","./XGTS_GameManager.ts","./GameManager.ts","./XGTS_DataManager.ts","./XGTS_AudioManager.ts"],(function(e){var t,n,a,i,c,s,o,l,u,r,h,S;return{setters:[function(e){t=e.cclegacy,n=e.Component,a=e.Label,i=e.Sprite,c=e._decorator},function(e){s=e.default},function(e){o=e.BundleManager},function(e){l=e.XGTS_GameManager},function(e){u=e.GameManager},function(e){r=e.XGTS_DataManager},function(e){h=e.XGTS_AudioManager,S=e.XGTS_Audio}],execute:function(){var d;t._RF.push({},"3715bevF+tNgLgXyfZHjB+9","XGTS_SkinItem",void 0);const{ccclass:m,property:k}=c;e("default",m("XGTS_SkinItem")(d=class extends n{constructor(...e){super(...e),this.Icon=null,this.NameLabel=null,this.LockIcon=null,this.Selected=null,this.skinName=null,this.callback=null}onLoad(){this.NameLabel=s.GetComponent("NameLabel",this.node,a),this.Icon=s.GetComponent("Icon",this.node,i),this.LockIcon=s.GetNode("LockIcon",this.node),this.Selected=s.GetNode("Selected",this.node)}Init(e,t){this.skinName=e,this.callback=t,this.Selected.active=!1,this.NameLabel.string=`${e}`,o.LoadSpriteFrame(u.GameData.DefaultBundle,`Res/Items/${e}`).then((e=>{this.Icon.spriteFrame=e,l.SetImagePreferScale(this.Icon,370,150)})),this.LockIcon.active=!r.GetGunSkinUnlock(e)}SetSelect(e){this.Selected.active=e==this.skinName}OnButtonClick(){h.Instance.PlaySFX(S.ButtonClick),r.GetGunSkinUnlock(this.skinName)&&this.callback&&this.callback(this.skinName)}})||d);t._RF.pop()}}}));

System.register("chunks:///_virtual/XGTS_SkinShopPanel.ts",["cc","./NodeUtil.ts","./GameManager.ts","./ProjectEventManager.ts","./XGTS_Data.ts","./XGTS_DataManager.ts","./XGTS_Constant.ts","./XGTS_UIManager.ts","./EventManager.ts","./PanelBase.ts","./UIManager.ts","./XGTS_LootManager.ts","./XGTS_SkinItem.ts","./XGTS_PoolManager.ts","./Tools.ts","./Banner.ts","./XGTS_AudioManager.ts","./XGTS_GameManager.ts"],(function(e){var n,t,a,i,s,o,l,r,S,u,h,c,k,d,P,G,M,f,y,m,p,E,I,g;return{setters:[function(e){n=e.cclegacy,t=e.Label,a=e._decorator},function(e){i=e.default},function(e){s=e.GameManager},function(e){o=e.ProjectEventManager,l=e.ProjectEvent},function(e){r=e.XGTS_ItemData,S=e.XGTS_ItemType},function(e){u=e.XGTS_DataManager},function(e){h=e.XGTS_Constant,c=e.XGTS_Quality},function(e){k=e.XGTS_UIManager},function(e){d=e.EventManager},function(e){P=e.PanelBase},function(e){G=e.UIManager},function(e){M=e.XGTS_LootManager},function(e){f=e.default},function(e){y=e.XGTS_PoolManager},function(e){m=e.Tools},function(e){p=e.default},function(e){E=e.XGTS_AudioManager,I=e.XGTS_Audio},function(e){g=e.XGTS_GameManager}],execute:function(){var _;n._RF.push({},"aa0b8WFNgtNpK7kgnyA/hoO","XGTS_SkinShopPanel",void 0);const{ccclass:T,property:D}=a;e("default",T("XGTS_SkinShopPanel")(_=class extends P{constructor(...e){super(...e),this.Buttons=null,this.MoneyLabel=null,this.ManDeErPanel=null,this.SkinPanel=null,this.SkinContent=null,this.EquipSkinButton=null,this.EquipSkinButtonLabel=null,this.skinItems=[],this.selectedSkin="",this.playerNum=0}onLoad(){this.MoneyLabel=i.GetComponent("MoneyLabel",this.node,t),this.Buttons=i.GetNode("Buttons",this.node),this.ManDeErPanel=i.GetNode("ManDeErPanel",this.node),this.SkinPanel=i.GetNode("SkinPanel",this.node),this.SkinContent=i.GetNode("SkinContent",this.node),this.EquipSkinButton=i.GetNode("EquipSkinButton",this.node),this.EquipSkinButtonLabel=i.GetComponent("EquipSkinButtonLabel",this.node,t)}Show(e){void 0!==e&&(this.playerNum=e),o.emit(l.弹出窗口,s.GameData.gameName),this.RefreshMoney(),this.RefreshPanels("ManDeEr")}RefreshMoney(){this.MoneyLabel.string=`${u.PlayerDatas[this.playerNum].Money}`}RefreshPanels(e){this.ManDeErPanel.active="ManDeEr"==e,this.ShowSkinPanel("Skin"==e),this.Buttons.children.forEach((n=>{n.getChildByName("Selected").active=n.name==e}))}ShowSkinPanel(e){if(this.SkinPanel.active=e,this.skinItems.forEach((e=>y.Instance.Put(e.node))),this.skinItems=[],this.selectedSkin="",e){this.EquipSkinButton.active=!1;for(let e=0;e<u.SkinData.length;e++){let n=y.Instance.Get(h.Prefab.SkinItem,this.SkinContent).getComponent(f);n.Init(u.SkinData[e].Name,this.SkinItemCallback.bind(this)),this.skinItems.push(n)}}}SkinItemCallback(e){this.selectedSkin=e,this.skinItems.forEach((n=>n.SetSelect(e))),this.EquipSkinButton.active=!0,this.RefreshEquipSkinButtonLabel()}RefreshEquipSkinButtonLabel(){let e=u.GetGunUseSkin(this.selectedSkin.split("_")[0]);this.EquipSkinButtonLabel.string=e?"卸下":"装备"}OnButtonClick(e){switch(E.Instance.PlaySFX(I.ButtonClick),e.target.name){case"ManDeEr":case"Skin":case"AnQuanXiang":this.RefreshPanels(e.target.name);break;case"LotteryButton":p.Instance.ShowVideoAd((()=>{let e,n=M.GetRandomItemInPrizePool();if(n){let t=0;g.IsDoubleMode&&(t=1),1==n.AwardType&&(e=m.Clone(u.GetItemDataByID(n.ID)),e&&(u.PlayerDatas[t].AddItemToInventory(e)||(g.IsDoubleMode?(u.PlayerDatas[1].Money+=e.Price/2,u.PlayerDatas[2].Money+=e.Price/2):u.PlayerDatas[0].Money+=e.Price,G.ShowTip(`仓库已满，自动出售 +${e.Price}`),k.Instance.ShowPanel(h.Panel.RewardPanel,[[e]])))),2==n.AwardType&&(e=new r(n.ID,S.None,n.Name,1e5,c.Mythic,"1_1",0,n.Name,"",!0),u.GetGunSkinUnlock(n.Name)?(g.IsDoubleMode?(u.PlayerDatas[1].Money+=5e4,u.PlayerDatas[2].Money+=5e4):u.PlayerDatas[0].Money+=1e5,G.ShowTip("已拥有该皮肤，+100000")):u.SetGunSkinUnlock(n.Name)),e&&k.Instance.ShowPanel(h.Panel.RewardPanel,[[e]])}}));break;case"EquipSkinButton":let n=this.selectedSkin.split("_")[0];u.GetGunUseSkin(n)?u.SetGunUseSkin(n,""):(console.error("SetGunUseSkin",n),u.SetGunUseSkin(n,this.selectedSkin)),this.RefreshEquipSkinButtonLabel();break;case"ReturnButton":k.Instance.HidePanel(h.Panel.SkinShopPanel)}}onEnable(){d.on(h.Event.REFRESH_MONEY,this.RefreshMoney,this)}onDisable(){d.off(h.Event.REFRESH_MONEY,this.RefreshMoney,this)}})||_);n._RF.pop()}}}));

System.register("chunks:///_virtual/XGTS_SortingChildren.ts",["cc"],(function(t){var n,r,e;return{setters:[function(t){n=t.cclegacy,r=t.Component,e=t._decorator}],execute:function(){var o;n._RF.push({},"3df23AFgSRB1Lc17uhIIIrb","XGTS_SortingChildren",void 0);const{ccclass:i,property:c}=e;t("XGTS_SortingChildren",i("XGTS_SortingChildren")(o=class extends r{update(t){this.node.children.sort(((t,n)=>n.position.y-t.position.y))}})||o);n._RF.pop()}}}));

System.register("chunks:///_virtual/XGTS_Supplies.ts",["./rollupPluginModLoBabelHelpers.js","cc","./NodeUtil.ts","./XGTS_Data.ts","./XGTS_Constant.ts","./EventManager.ts","./XGTS_DataManager.ts","./Tools.ts","./XGTS_LootManager.ts","./BundleManager.ts","./GameManager.ts","./XGTS_ContainerInventory.ts","./XGTS_UIManager.ts","./XGTS_LvManager.ts","./XGTS_GameManager.ts"],(function(e){var t,n,a,i,o,s,r,l,c,u,h,p,d,f,I,S,C,m,T,_,G,g,D,y,B;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.initializerDefineProperty},function(e){a=e.cclegacy,i=e.Enum,o=e._decorator,s=e.Component,r=e.Sprite,l=e.BoxCollider2D,c=e.Contact2DType,u=e.instantiate,h=e.v3,p=e.Vec3},function(e){d=e.default},function(e){f=e.XGTS_ContainerType},function(e){I=e.XGTS_Constant},function(e){S=e.EventManager},function(e){C=e.XGTS_DataManager},function(e){m=e.Tools},function(e){T=e.XGTS_LootManager},function(e){_=e.BundleManager},function(e){G=e.GameManager},function(e){g=e.default},function(e){D=e.XGTS_UIManager},function(e){y=e.XGTS_LvManager},function(e){B=e.XGTS_GameManager}],execute:function(){var N,M,x,P,X,b;a._RF.push({},"d09ce4xo2xKiaolxHoDKmGu","XGTS_Supplies",void 0);const{ccclass:v,property:O}=o;e("default",(N=v("XGTS_Supplies"),M=O({type:i(f)}),N((X=t((P=class extends s{constructor(...e){super(...e),n(this,"type",X,this),n(this,"generateBox",b,this),this.Icon=null,this.collider=null,this.data=null,this.isOpened=!1}onLoad(){this.Icon=d.GetComponent("Icon",this.node,r),this.collider=this.node.getComponent(l)}start(){this.generateBox&&this.Init(this.type)}Init(e){if(this.Icon.spriteFrame=null,this.type=e,this.data=m.Clone(C.ContainerData.find((t=>t.Type==e))),e==f.SafeBox&&"训练场"==y.Instance.matchData.MapName){let e=[];for(let t=0;t<I.FirstOpenSafeBox.length;t++){let n=C.GetItemDataByName(I.FirstOpenSafeBox[t]);n.Searched=!1,n&&e.push(n)}this.data.ItemData=e}else if(e==f.WeaponCase&&"训练场"==y.Instance.matchData.MapName){let e=[];for(let t=0;t<I.FirstOpenWeaponBox.length;t++){let n=C.GetItemDataByName(I.FirstOpenWeaponBox[t]);n.Searched=!1,n&&e.push(n)}this.data.ItemData=e}else this.data.ItemData=T.GetContainerResult(e);this.Refresh()}InitCharacterCase(e){this.Icon.spriteFrame=null,this.type=f.CharactorCase,e?(this.data=m.Clone(C.ContainerData.find((e=>e.Type==f.SafeBox))),this.data.Name="赛喵德",this.data.ItemData=T.GetContainerResult(f.SafeBox)):(this.data=m.Clone(C.ContainerData.find((e=>e.Type==f.BirdNest))),this.data.Name="小兵",this.data.ItemData=T.GetContainerResult(f.BirdNest)),this.Refresh()}Refresh(){_.LoadSpriteFrame(G.GameData.DefaultBundle,`Res/Supplies/${this.type}_${this.isOpened?1:0}`).then((e=>{this.Icon.spriteFrame=e}))}onBeginContact(e,t,n){if(t.group==I.Group.Player){let e="",n=0;if(B.IsDoubleMode&&(e="_"+t.node.name.split("_")[1],n=Number(e.split("_")[1])),B.Instance.suppliesNodes.set(n,this.node.uuid),B.IsDoubleMode){let e=1==n?2:1;if(B.Instance.suppliesNodes.get(e)==this.node.uuid)return}S.Scene.emit(I.Event.SHOW_INTERACT_BUTTON+e,!0,(()=>{const e=()=>{this.type!=f.SafeBox&&this.type!=f.WeaponCase||"训练场"!=y.Instance.matchData.MapName||y.Instance.AddGuideIndex(),_.LoadPrefab(G.GameData.DefaultBundle,"UI/ContainerInventory").then((e=>{this.isOpened=!0,this.Refresh();const t=t=>{let n=u(e);n.setParent(t),B.IsDoubleMode&&(this.type==f.AviationCrate?n.setScale(h(.7,.7,1)):n.setScale(h(.8,.8,1))),n.setPosition(p.ZERO);let a=n.getComponent(g);return a.InitContainer(this.data),a};B.IsDoubleMode?1==n?D.Instance.ShowPanel(I.Panel.InventoryPanel_Left,[t,n]):D.Instance.ShowPanel(I.Panel.InventoryPanel_Right,[t,n]):D.Instance.ShowPanel(I.Panel.InventoryPanel,[t])}))};this.type!=f.SafeBox||this.isOpened?e():D.Instance.ShowPanel(I.Panel.SafeBoxPanel,[()=>{e()}])}))}}onEndContact(e,t,n){if(t.group==I.Group.Player){let e="",n=0;B.IsDoubleMode&&(e="_"+t.node.name.split("_")[1],n=Number(e.split("_")[1])),B.Instance.suppliesNodes.set(n,null),S.Scene.emit(I.Event.SHOW_INTERACT_BUTTON+e,!1)}}onEnable(){this.collider.on(c.BEGIN_CONTACT,this.onBeginContact,this),this.collider.on(c.END_CONTACT,this.onEndContact,this)}onDisable(){this.collider.off(c.BEGIN_CONTACT,this.onBeginContact,this),this.collider.off(c.END_CONTACT,this.onEndContact,this)}}).prototype,"type",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return f.BirdNest}}),b=t(P.prototype,"generateBox",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),x=P))||x));a._RF.pop()}}}));

System.register("chunks:///_virtual/XGTS_TutorialPanel.ts",["cc","./NodeUtil.ts","./PanelBase.ts","./XGTS_UIManager.ts","./XGTS_Constant.ts","./GameManager.ts","./XGTS_AudioManager.ts","./ProjectEventManager.ts","./BundleManager.ts","./XGTS_PlayerInventory.ts"],(function(t){var e,n,s,a,i,o,l,h,u,c,r,P,d,g,B,f,G;return{setters:[function(t){e=t.cclegacy,n=t.Label,s=t.misc,a=t._decorator,i=t.instantiate,o=t.Vec3},function(t){l=t.default},function(t){h=t.PanelBase},function(t){u=t.XGTS_UIManager},function(t){c=t.XGTS_Constant},function(t){r=t.GameManager},function(t){P=t.XGTS_AudioManager,d=t.XGTS_Audio},function(t){g=t.ProjectEventManager,B=t.ProjectEvent},function(t){f=t.BundleManager},function(t){G=t.default}],execute:function(){var x;e._RF.push({},"7a964ruRkhG7bYLzMg+rgW8","XGTS_TutorialPanel",void 0);const{ccclass:v,property:C}=a;t("default",v("XGTS_TutorialPanel")(x=class extends h{constructor(...t){super(...t),this.Panel=null,this.Pages=null,this.NextPageButton=null,this.LastPageButton=null,this.ClosePageButton=null,this.DescLabel=null,this.descs=["把战局内带出的物品放入到仓库里。","搜索出的大红可以放到展览室。","点击装备的枪械，装备芯片。","点击改装。","把芯片拖放到芯片配件栏里。"],this.index=0,this.showCloseButton=!1}onLoad(){this.Panel=l.GetNode("Panel",this.node),this.Pages=l.GetNode("Pages",this.node),this.NextPageButton=l.GetNode("NextPageButton",this.node),this.LastPageButton=l.GetNode("LastPageButton",this.node),this.ClosePageButton=l.GetNode("ClosePageButton",this.node),this.DescLabel=l.GetComponent("DescLabel",this.node,n)}Show(){super.Show(this.Panel),this.ClosePageButton.active=!1,this.index=0,this.showCloseButton=!1,this.RefreshPanel(),g.emit(B.页面转换,r.GameData.gameName)}RefreshPanel(){this.LastPageButton.active=this.index>0,this.NextPageButton.active=this.index<this.descs.length-1;for(let t=0;t<this.Pages.children.length;t++)this.Pages.children[t].active=this.index==t;this.DescLabel.string=this.descs[this.index]}OnButtonClick(t){switch(P.Instance.PlaySFX(d.ButtonClick),t.target.name){case"ClosePageButton":u.Instance.HidePanel(c.Panel.TutorialPanel),f.LoadPrefab(r.GameData.DefaultBundle,"UI/PlayerInventory").then((t=>{u.Instance.ShowPanel(c.Panel.InventoryPanel,[e=>{let n=i(t);n.setParent(e),n.setPosition(o.ZERO);let s=n.getComponent(G);return s.InitPlayerInventory(),s}])}));break;case"LastPageButton":this.index=s.clampf(this.index-1,0,this.descs.length-1),this.RefreshPanel();break;case"NextPageButton":this.index=s.clampf(this.index+1,0,this.descs.length-1),this.showCloseButton||this.index!=this.descs.length-1||(this.showCloseButton=!0,this.ClosePageButton.active=!0),this.RefreshPanel()}}})||x);e._RF.pop()}}}));

System.register("chunks:///_virtual/XGTS_UIManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./BundleManager.ts","./GameManager.ts"],(function(e){var t,a,i,n,o,l,s,p,r,h,c;return{setters:[function(e){t=e.applyDecoratedDescriptor,a=e.initializerDefineProperty},function(e){i=e.cclegacy,n=e.JsonAsset,o=e._decorator,l=e.Component,s=e.isValid,p=e.find,r=e.instantiate},function(e){h=e.BundleManager},function(e){c=e.GameManager}],execute:function(){var u,f,_,P,g,S;i._RF.push({},"f2fbfduHZJGhYkdxG/o5nOC","XGTS_UIManager",void 0);const{ccclass:w,property:D}=o;e("XGTS_UIManager",(u=w("XGTS_UIManager"),f=D(n),u(((S=class e extends l{constructor(...e){super(...e),a(this,"SceneDate",g,this),this._panelDict={},this._loadingPanelDict={},this._arrPopupDialog=[]}static get Instance(){return this._instance||(this._instance=new e),this._instance}isPanelShowing(e){if(!this._panelDict.hasOwnProperty(e))return!1;let t=this._panelDict[e];return s(t)&&t.active&&t.parent}ShowPanel(e,t,a){if(this._loadingPanelDict[e])return;let i=e.lastIndexOf("/"),n="XGTS_"+e.slice(i+1);if(t||(t=[]),this._panelDict.hasOwnProperty(e)){let i=this._panelDict[e];if(s(i)){i.parent=p("Canvas"),i.active=!0;let e=i.getComponent(n),o=i.getComponent(n.charAt(0).toUpperCase()+n.slice(1));if(e&&e.Show)e.Show.apply(e,t),a&&a(e);else{if(!o||!o.Show)throw`查找不到脚本文件${n}`;o.Show.apply(o,t),a&&a(o)}return}}this._loadingPanelDict[e]=!0,h.LoadUI(c.GameData.DefaultBundle,e,((i,o)=>{let l=!1;this._loadingPanelDict[e]||(l=!0),this._loadingPanelDict[e]=!1,this._panelDict[e]=o;let s=o.getComponent(n),p=o.getComponent(n.charAt(0).toUpperCase()+n.slice(1));if(s&&s.Show)s.Show.apply(s,t),a&&a(s);else{if(!p||!p.Show)throw`查找不到脚本文件${n} 或者脚本中没有 Show() 方法...`;p.Show.apply(p,t),a&&a(p)}l&&this.HidePanel(e)}))}ShowBundlePanel(e,t,a,i){if(this._loadingPanelDict[`${e}/${t}`])return;let n=t.lastIndexOf("/"),o=t.slice(n+1);if(a||(a=[]),this._panelDict.hasOwnProperty(`${e}/${t}`)){let n=this._panelDict[`${e}/${t}`];if(s(n)){n.parent=p("Canvas"),n.active=!0;let e=n.getComponent(o),t=n.getComponent(o.charAt(0).toUpperCase()+o.slice(1));if(e&&e.Show)e.Show.apply(e,a),i&&i(e);else{if(!t||!t.Show)throw`查找不到脚本文件${o}`;t.Show.apply(t,a),i&&i(t)}return}}this._loadingPanelDict[`${e}/${t}`]=!0,h.LoadPrefab(e,t).then((n=>{let l=r(n);l.setPosition(0,0,0),p("Canvas").addChild(l);let s=!1;this._loadingPanelDict[`${e}/${t}`]||(s=!0),this._loadingPanelDict[`${e}/${t}`]=!1,this._panelDict[`${e}/${t}`]=l;let h=l.getComponent(o),c=l.getComponent(o.charAt(0).toUpperCase()+o.slice(1));if(h&&h.Show)h.Show.apply(h,a),i&&i(h);else{if(!c||!c.Show)throw`查找不到脚本文件${o} 或者脚本中没有 Show() 方法...`;c.Show.apply(c,a),i&&i(c)}s&&this.HidePanel(`${e}/${t}`)}))}HidePanel(e,t){if(this._panelDict.hasOwnProperty(e)){let a=this._panelDict[e];if(a&&s(a)){let e=a.getComponent("animationUI");e?e.close((()=>{a.parent=null,t&&"function"==typeof t&&t()})):(a.parent=null,t&&"function"==typeof t&&t())}else t&&"function"==typeof t&&t()}this._loadingPanelDict[e]=!1}RefreshPanel(e,t){let a=e.lastIndexOf("/"),i=e.slice(a+1);if(t||(t=[]),this._panelDict.hasOwnProperty(e)){let a=this._panelDict[e];if(s(a)){a.parent=p("Canvas"),a.active=!0;let e=a.getComponent(i),n=a.getComponent(i.charAt(0).toUpperCase()+i.slice(1));if(e&&e.Refresh)e.Refresh.apply(e,t);else{if(!n||!n.Refresh)throw`查找不到脚本文件${i}`;n.Refresh.apply(n,t)}return}}}pushToPopupSeq(e,t,a){let i={panelPath:e,scriptName:t,param:a,isShow:!1};this._arrPopupDialog.push(i),this._checkPopupSeq()}insertToPopupSeq(e,t,a){let i={panelPath:t,param:a,isShow:!1};this._arrPopupDialog.splice(e,0,i)}shiftFromPopupSeq(e){this.HidePanel(e,(()=>{this._arrPopupDialog[0]&&this._arrPopupDialog[0].panelPath===e&&(this._arrPopupDialog.shift(),this._checkPopupSeq())}))}_checkPopupSeq(){if(this._arrPopupDialog.length>0){let e=this._arrPopupDialog[0];e.isShow||(this.ShowPanel(e.panelPath,e.param),this._arrPopupDialog[0].isShow=!0)}}static ShowBroadcast(e,t,a,i=.75,n=2){}})._instance=void 0,g=t((P=S).prototype,"SceneDate",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_=P))||_));i._RF.pop()}}}));

System.register("chunks:///_virtual/XGTS_UpgradePanel.ts",["cc","./NodeUtil.ts","./PanelBase.ts","./XGTS_UIManager.ts","./XGTS_Constant.ts","./XGTS_DataManager.ts","./XGTS_PoolManager.ts","./XGTS_CommonItem.ts","./EventManager.ts","./Tools.ts","./UIManager.ts","./XGTS_AudioManager.ts","./ProjectEventManager.ts","./GameManager.ts","./XGTS_GameManager.ts"],(function(e){var t,a,n,s,o,i,l,r,h,d,c,u,m,M,b,g,L,p,f,y;return{setters:[function(e){t=e.cclegacy,a=e.Label,n=e.misc,s=e._decorator},function(e){o=e.default},function(e){i=e.PanelBase},function(e){l=e.XGTS_UIManager},function(e){r=e.XGTS_Constant},function(e){h=e.XGTS_DataManager},function(e){d=e.XGTS_PoolManager},function(e){c=e.default},function(e){u=e.EventManager},function(e){m=e.Tools},function(e){M=e.UIManager},function(e){b=e.XGTS_AudioManager,g=e.XGTS_Audio},function(e){L=e.ProjectEventManager,p=e.ProjectEvent},function(e){f=e.GameManager},function(e){y=e.XGTS_GameManager}],execute:function(){var G;t._RF.push({},"b3f93AFJ5RHKabG/x3YtMLN","XGTS_UpgradePanel",void 0);const{ccclass:I,property:v}=s;e("default",I("XGTS_UpgradePanel")(G=class extends i{constructor(...e){super(...e),this.Panel=null,this.TitleLabel=null,this.MoneyLabel=null,this.WorkbenchTitleLabel=null,this.UpgradeUnlockContent=null,this.LvLabel=null,this.LvAfterLabel=null,this.MaxLvLabel=null,this.UpgradeUnlockLabel=null,this.ScrollView=null,this.NeedMatContent=null,this.CostMoneyLabel=null,this.CostTimeLabel=null,this.Arrow=null,this.needMatItems=[],this.unlockItems=[],this.type=null,this.data=null,this.playerNum=0}onLoad(){this.Panel=o.GetNode("Panel",this.node),this.TitleLabel=o.GetComponent("TitleLabel",this.node,a),this.MoneyLabel=o.GetComponent("MoneyLabel",this.node,a),this.WorkbenchTitleLabel=o.GetComponent("WorkbenchTitleLabel",this.node,a),this.UpgradeUnlockContent=o.GetNode("UpgradeUnlockContent",this.node),this.LvLabel=o.GetComponent("LvLabel",this.node,a),this.LvAfterLabel=o.GetComponent("LvAfterLabel",this.node,a),this.MaxLvLabel=o.GetNode("MaxLvLabel",this.node),this.UpgradeUnlockLabel=o.GetNode("UpgradeUnlockLabel",this.node),this.ScrollView=o.GetNode("ScrollView",this.node),this.Arrow=o.GetNode("Arrow",this.node),this.NeedMatContent=o.GetNode("NeedMatContent",this.node),this.CostMoneyLabel=o.GetComponent("CostMoneyLabel",this.node,a),this.CostTimeLabel=o.GetComponent("CostTimeLabel",this.node,a)}Show(e,t){this.playerNum=t,super.Show(this.Panel),this.type=e,h.WorkbenchData.get(e)||console.error(`XGTS_DataManager.WorkbenchData.get(${e}) is null`),this.Refresh(),L.emit(p.页面转换,f.GameData.gameName)}Refresh(){let e=h.PlayerDatas[this.playerNum].GetWorkbenchLv(this.type),t=n.clampf(e+1,1,3);if(this.data=h.WorkbenchData.get(this.type).find((e=>e.Lv==t)),this.MaxLvLabel.active=3==e,this.Panel.active=e<3,this.Panel.active){this.CostMoneyLabel.string=`${this.data.Cost.toLocaleString()}`,this.CostTimeLabel.string=`${m.FormatTime(this.data.CostTime)}`,this.GetAndInitResults(this.data.Requirements,this.data.QuantityDemanded,this.needMatItems,this.NeedMatContent);for(let e=0;e<this.needMatItems.length;e++){let t=0;y.IsDoubleMode&&(t=1);let a=h.PlayerDatas[t].GetInventoryItemCount(this.needMatItems[e].data.ID),n=`<b><color=${a>=this.needMatItems[e].data.Count?"#00ff00":"#ff0000"}>${a}/${this.needMatItems[e].data.Count}</color></b>`;this.needMatItems[e].SetDescStr(n)}}this.Arrow.active=e<3,this.LvAfterLabel.node.active=e<3,this.UpgradeUnlockLabel.active=e<3,this.ScrollView.active=e<3,this.LvLabel.string=`Lv.${e}`,e<3&&(this.TitleLabel.string=`${r.WorkbenchName[this.type]}`,this.WorkbenchTitleLabel.string=`${r.WorkbenchName[this.type]}`,this.LvAfterLabel.string=`Lv.${t}`,this.GetAndInitResults(this.data.Making,null,this.unlockItems,this.UpgradeUnlockContent)),this.RefreshMoney()}Upgrade(){let e=h.PlayerDatas[this.playerNum].GetWorkbenchLv(this.type);e++,h.PlayerDatas[this.playerNum].SetWorkbenchLv(this.type,e),this.Refresh()}GetAndInitResults(e,t,a,n){let s=[];for(let a=0;a<e.length;a++){let n=null;for(const[o,i]of h.ItemDataMap)if(n=i.find((t=>t.ID==e[a])),n){let e=m.Clone(n);t&&(e.Count=t[a]),s.push(e);break}n||console.error(`Item表中没有该材料 ID：${e[a]}`)}a.forEach((e=>d.Instance.Put(e.node))),a.length=0;for(let e=0;e<s.length;e++){let t=d.Instance.Get(r.Prefab.CommonItem,n).getComponent(c);t.InitDisplay(s[e]),a.push(t)}}RefreshMoney(){this.MoneyLabel.string=h.PlayerDatas[this.playerNum].Money.toLocaleString()}OnButtonClick(e){switch(b.Instance.PlaySFX(g.ButtonClick),e.target.name){case"Mask":case"ReturnButton":l.Instance.HidePanel(r.Panel.UpgradePanel);break;case"UpgradeAnywayButton":let e=0;for(let t=0;t<this.needMatItems.length;t++)e+=this.needMatItems[t].data.Price*this.needMatItems[t].data.Count;e+=this.data.Cost,h.PlayerDatas[this.playerNum].Money<e?M.ShowTip(`金钱不足，需要${e}`):(h.PlayerDatas[this.playerNum].Money-=e,this.Upgrade());break;case"UpgradeButton":let t=[];for(let e=0;e<this.needMatItems.length;e++){let a=0;y.IsDoubleMode&&(a=1);let n=h.PlayerDatas[a].InventoryItemData.filter((t=>t.ID==this.needMatItems[e].data.ID));if(!(n&&n.length>0))return void M.ShowTip("材料不足");t.push(n[0])}if(h.PlayerDatas[this.playerNum].Money<this.data.Cost)M.ShowTip(`金钱不足，需要${this.data.Cost}`);else{h.PlayerDatas[this.playerNum].Money-=this.data.Cost;for(let e=0;e<t.length;e++){let a=0;y.IsDoubleMode&&(a=1),h.PlayerDatas[a].RemoveItemFromInventory(t[e])}this.Upgrade()}}}onEnable(){u.on(r.Event.REFRESH_MONEY,this.RefreshMoney,this)}onDisable(){u.off(r.Event.REFRESH_MONEY,this.RefreshMoney,this)}})||G);t._RF.pop()}}}));

System.register("chunks:///_virtual/XGTS_WeaponContent.ts",["cc","./NodeUtil.ts","./Tools.ts","./XGTS_GridCell.ts","./XGTS_Data.ts","./XGTS_DataManager.ts","./BundleManager.ts","./GameManager.ts","./XGTS_GameManager.ts","./EventManager.ts","./XGTS_Constant.ts","./XGTS_AudioManager.ts"],(function(e){var a,t,n,s,o,r,i,l,p,m,y,u,h,c,D,_,P,d,T,S;return{setters:[function(e){a=e.cclegacy,t=e.Component,n=e.UITransform,s=e.Sprite,o=e.Label,r=e.size,i=e._decorator},function(e){l=e.default},function(e){p=e.Tools},function(e){m=e.GridCellState},function(e){y=e.XGTS_ItemType,u=e.XGTS_WeaponData},function(e){h=e.XGTS_DataManager},function(e){c=e.BundleManager},function(e){D=e.GameManager},function(e){_=e.XGTS_GameManager},function(e){P=e.EventManager},function(e){d=e.XGTS_Constant},function(e){T=e.XGTS_AudioManager,S=e.XGTS_Audio}],execute:function(){var W;a._RF.push({},"59995ojpjVGzKIUsefOeCAq","XGTS_WeaponContent",void 0);const{ccclass:N,property:b}=i;let C=e("XGTS_WeaponContentType",function(e){return e[e.Primary=0]="Primary",e[e.Secondary=1]="Secondary",e[e.Pistol=2]="Pistol",e[e.Melee=3]="Melee",e[e.Helmet=4]="Helmet",e[e.BodyArmor=5]="BodyArmor",e}({}));e("XGTS_WeaponContent",N("XGTS_WeaponContent")(W=class extends t{constructor(...e){super(...e),this.ndTrans=null,this.PutTip=null,this.Icon=null,this.Name_Lb=null,this.Desc_Lb=null,this.inBox=!1,this.type=null,this.playerNum=0}onLoad(){this.ndTrans=this.node.getComponent(n),this.PutTip=l.GetComponent("PutTip",this.node,s),this.Icon=l.GetComponent("Icon",this.node,s),this.Name_Lb=l.GetComponent("Name_Lb",this.node,o),this.Desc_Lb=l.GetComponent("Desc_Lb",this.node,o)}InitPlayerNum(e){this.playerNum=e}Init(e){this.type=e,this.RefreshWeaponContent()}CanEquip(e,a){if(this.ndTrans.getBoundingBoxToWorld().contains(a)){this.inBox=!0;let a=!1;if(e.Type==y.Weapon||e.Type==y.Helmet||e.Type==y.BodyArmor)switch(this.type){case C.Primary:e.WeaponData&&(a=u.IsMain(e.WeaponData.Type)&&null==h.PlayerDatas[this.playerNum].Weapon_Primary);break;case C.Secondary:e.WeaponData&&(a=u.IsMain(e.WeaponData.Type)&&null==h.PlayerDatas[this.playerNum].Weapon_Secondary);break;case C.Pistol:e.WeaponData&&(a=u.IsPistol(e.WeaponData.Type)&&null==h.PlayerDatas[this.playerNum].Weapon_Pistol);break;case C.Helmet:a=e.Type==y.Helmet&&null==h.PlayerDatas[this.playerNum].Weapon_Helmet;break;case C.BodyArmor:a=e.Type==y.BodyArmor&&null==h.PlayerDatas[this.playerNum].Weapon_BodyArmor}return this.SetPutTipState(a?m.CanPut:m.CanntPut),a}return this.inBox&&(this.ClearPutTipState(),this.inBox=!1),!1}OnDragStart(e){}OnDragging(e,a){this.CanEquip(e.data,a)}OnDragEnd(e,a){if(this.CanEquip(e.data,a)){this.ClearPutTipState();let a=e.data;switch(T.Instance.PlaySFX(S.Equip),this.type){case C.Primary:h.PlayerDatas[this.playerNum].Weapon_Primary=a;break;case C.Secondary:h.PlayerDatas[this.playerNum].Weapon_Secondary=a;break;case C.Pistol:h.PlayerDatas[this.playerNum].Weapon_Pistol=a;break;case C.Helmet:h.PlayerDatas[this.playerNum].Weapon_Helmet=a;break;case C.BodyArmor:h.PlayerDatas[this.playerNum].Weapon_BodyArmor=a}this.RefreshWeaponContent(),this.RefreshContentLabel(),e.RemoveItemFromAndResetLastInventory()}}RefreshWeaponContent(){let e=null,a=r();switch(this.Icon.spriteFrame=null,this.type){case C.Primary:e=h.PlayerDatas[this.playerNum].Weapon_Primary,a=r(450,150),this.Name_Lb.string=e?e.Name:"主武器";break;case C.Secondary:e=h.PlayerDatas[this.playerNum].Weapon_Secondary,a=r(450,150),this.Name_Lb.string=e?e.Name:"副武器";break;case C.Pistol:e=h.PlayerDatas[this.playerNum].Weapon_Pistol,a=r(150,150),this.Name_Lb.string=e?e.Name:"手枪";break;case C.Helmet:e=h.PlayerDatas[this.playerNum].Weapon_Helmet,a=r(300,150),this.Name_Lb.string=e?e.Name:"头盔";break;case C.BodyArmor:e=h.PlayerDatas[this.playerNum].Weapon_BodyArmor,a=r(300,150),this.Name_Lb.string=e?e.Name:"防弹衣"}if(e){let t=e.ImageId;p.IsEmptyStr(h.GetGunUseSkin(e.Name))||(t=`${h.GetGunUseSkin(e.Name)}`),c.LoadSpriteFrame(D.GameData.DefaultBundle,`Res/Items/${t}`).then((e=>{this.Icon.spriteFrame=e,_.SetImagePreferScale(this.Icon,a.width,a.height,15)}))}this.RefreshContentLabel()}RefreshContentLabel(){let e=null;switch(this.type){case C.Primary:if(e=h.PlayerDatas[this.playerNum].Weapon_Primary,e){let a=0;e.WeaponData.Ammo&&(a=e.WeaponData.Ammo.Count),this.Desc_Lb.string=`${a}/${h.PlayerDatas[this.playerNum].GetAmmoCountByType(e.WeaponData.AmmoType)}`}break;case C.Secondary:if(e=h.PlayerDatas[this.playerNum].Weapon_Secondary,e){let a=0;e.WeaponData.Ammo&&(a=e.WeaponData.Ammo.Count),this.Desc_Lb.string=`${a}/${h.PlayerDatas[this.playerNum].GetAmmoCountByType(e.WeaponData.AmmoType)}`}break;case C.Pistol:if(e=h.PlayerDatas[this.playerNum].Weapon_Pistol,e){let a=0;e.WeaponData.Ammo&&(a=e.WeaponData.Ammo.Count),this.Desc_Lb.string=`${a}/${h.PlayerDatas[this.playerNum].GetAmmoCountByType(e.WeaponData.AmmoType)}`}break;case C.Helmet:e=h.PlayerDatas[this.playerNum].Weapon_Helmet,e&&(this.Desc_Lb.string=`${e.EquipData.Durability}/${e.EquipData.MaxDurability}`);break;case C.BodyArmor:e=h.PlayerDatas[this.playerNum].Weapon_BodyArmor,e&&(this.Desc_Lb.string=`${e.EquipData.Durability}/${e.EquipData.MaxDurability}`)}}SetPutTipState(e){this.PutTip.color=p.GetColorFromHex(e)}ClearPutTipState(){this.PutTip.color=p.GetColorFromHex(m.None)}onEnable(){}onDisable(){P.Scene.off(d.Event.REFRESH_WEAON_CONTENT,this.RefreshContentLabel,this)}})||W);a._RF.pop()}}}));

System.register("chunks:///_virtual/XGTS_WorkbenchPanel.ts",["cc","./NodeUtil.ts","./PanelBase.ts","./XGTS_AudioManager.ts","./ProjectEventManager.ts","./GameManager.ts"],(function(t){var n,e,s,i,l,o,a,u,h,c;return{setters:[function(t){n=t.cclegacy,e=t.Label,s=t._decorator},function(t){i=t.default},function(t){l=t.PanelBase},function(t){o=t.XGTS_AudioManager,a=t.XGTS_Audio},function(t){u=t.ProjectEventManager,h=t.ProjectEvent},function(t){c=t.GameManager}],execute:function(){var _;n._RF.push({},"9062afd3-1be4-4c7e-b88c-6a890113fd1g","XGTS_WorkbenchPanel",void 0);const{ccclass:b,property:r}=s;t("default",b("XGTS_WorkbenchPanel")(_=class extends l{constructor(...t){super(...t),this.DescLabel=null,this.Button_0=null,this.Button_1=null,this.Button_2=null,this.Button_0_Label=null,this.Button_1_Label=null,this.Button_2_Label=null,this.cb_0=null,this.cb_1=null,this.cb_2=null,this.nowText="",this.timer=0,this.index=0}onLoad(){this.Button_0=i.GetNode("Button_0",this.node),this.Button_0_Label=i.GetComponent("Button_0_Label",this.node,e),this.Button_1=i.GetNode("Button_1",this.node),this.Button_1_Label=i.GetComponent("Button_1_Label",this.node,e),this.Button_2=i.GetNode("Button_2",this.node),this.Button_2_Label=i.GetComponent("Button_2_Label",this.node,e),this.DescLabel=i.GetComponent("DescLabel",this.node,e)}Show(t,n=null,e=null,s=null){this.cb_0=null,this.cb_1=null,this.cb_2=null,this.Button_0.active=null!=n,this.Button_1.active=null!=e,this.Button_2.active=null!=s,this.nowText=t,this.DescLabel.string="",null!=n&&(this.cb_0=n.cb,this.Button_0_Label.string=n.text),null!=e&&(this.cb_1=e.cb,this.Button_1_Label.string=e.text),null!=s&&(this.cb_2=s.cb,this.Button_2_Label.string=s.text),u.emit(h.页面转换,c.GameData.gameName)}update(t){this.nowText&&this.nowText.length>0&&(this.timer+=t,this.timer>=.08&&(this.DescLabel.string.length<this.nowText.length?this.DescLabel.string=this.nowText.slice(0,this.DescLabel.string.length+1):this.nowText=null,this.timer=0))}OnButtonClick(t){switch(o.Instance.PlaySFX(a.ButtonClick),t.target.name){case"Button_0":this.cb_0&&this.cb_0();break;case"Button_1":this.cb_1&&this.cb_1();break;case"Button_2":this.cb_2&&this.cb_2()}}onEnable(){}onDisable(){}})||_);n._RF.pop()}}}));

(function(r) {
  r('virtual:///prerequisite-imports/50_XGTS', 'chunks:///_virtual/50_XGTS'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});